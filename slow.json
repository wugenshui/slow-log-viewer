
{"classes":[{"attribute":"fingerprint","checksum":"56EC688F6BE31548BB7493CFFEEE36C2","distillate":"INSERT logs","example":{"Query_time":"295.431246","query":"insert into logs (module, operation_desc, operation_time, operation_type, remote_ip, result, user_id, username) values ('ç»å½è®¤è¯æ¨¡å', 'ç¨æ·ç»å½', '2025-01-03 23:01:14.444', 'LOGIN', '172.17.0.1', 1, null, 'yh_hms')","ts":"2025-01-03T15:06:09"},"fingerprint":"insert into logs (module, operation_desc, operation_time, operation_type, remote_ip, result, user_id, username) values(?+)","histograms":{"Query_time":[0,0,0,0,0,0,0,10]},"metrics":{"Lock_time":{"avg":"0.000005","max":"0.000009","median":"0.000005","min":"0.000004","pct":"0.009434","pct_95":"0.000005","stddev":"0.000001","sum":"0.000049"},"Query_length":{"avg":"225","max":"226","median":"223","min":"225","pct":"0","pct_95":"223","stddev":"0","sum":"2259"},"Query_time":{"avg":"264.733888","max":"295.431246","median":"271.232065","min":"233.475092","pct":"0.009434","pct_95":"284.793668","stddev":"23.829056","sum":"2647.338881"},"Rows_examined":{"avg":"0","max":"0","median":"0","min":"0","pct":"0","pct_95":"0","stddev":"0","sum":"0"},"Rows_sent":{"avg":"0","max":"0","median":"0","min":"0","pct":"0","pct_95":"0","stddev":"0","sum":"0"},"db":{"value":"wsnh_prod"},"host":{"value":"192.168.5.243"},"user":{"value":"wsnh"}},"query_count":10,"tables":[{"create":"SHOW CREATE TABLE `wsnh_prod`.`logs`\\G","status":"SHOW TABLE STATUS FROM `wsnh_prod` LIKE 'logs'\\G"}],"ts_max":"2025-01-03T15:06:09","ts_min":"2025-01-03T15:06:09"},{"attribute":"fingerprint","checksum":"9A27F5C0D83DF9D43BF59A179F24F099","distillate":"SELECT t_pig_pick t_retailer_info","example":{"Query_time":"85.328271","query":"select\n        tmp.tattoo_code,\n        tmp.retailer_id,\n        tmp.market_id,\n        tmp.contact_name,\n        tmp.contact_phone,\n        tmp.retailer_name,\n        tmp.location,\n        count(tmp.pick_time_format) pick_day_count\n        from\n        (\n        select\n        tpp.tattoo_code,\n        tpp.retailer_id ,\n        DATE_FORMAT(CONVERT_TZ(tpp.pick_time, '+00:00', '+08:00'), '%Y-%m-%d') pick_time_format,\n        tri.market_id,\n        tri.contact_name,\n        tri.contact_phone,\n        tri.retailer_name,\n        tri.location\n        from\n        t_pig_pick tpp\n        left join (\n        select\n        retailer_id ,\n        retailer_name,\n        market_id,\n        contact_name,\n        contact_phone,\n        location\n        from\n        t_retailer_info\n        where\n        is_delete = 0) tri on\n        tpp.retailer_id = tri.retailer_id\n         WHERE tpp.is_delete = 0\n            AND tpp.retailer_id != -1\n            \n                AND tpp.pick_time >= '2024-01-02 16:00:00'\n            \n            \n                AND tpp.pick_time <= '2024-12-31 15:59:59.999' \n        group by\n        tpp.tattoo_code,\n        tpp.retailer_id ,\n        pick_time_format\n                 \n        ) as tmp\n        group by\n        tattoo_code,\n        retailer_id\n        order by pick_day_count desc\n LIMIT 50","ts":"2025-01-03T00:05:41"},"fingerprint":"select tmp.tattoo_code, tmp.retailer_id, tmp.market_id, tmp.contact_name, tmp.contact_phone, tmp.retailer_name, tmp.location, count(tmp.pick_time_format) pick_day_count from ( select tpp.tattoo_code, tpp.retailer_id , date_format(convert_tz(tpp.pick_time, ?, ?), ?) pick_time_format, tri.market_id, tri.contact_name, tri.contact_phone, tri.retailer_name, tri.location from t_pig_pick tpp left join ( select retailer_id , retailer_name, market_id, contact_name, contact_phone, location from t_retailer_info where is_delete = ?) tri on tpp.retailer_id = tri.retailer_id where tpp.is_delete = ? and tpp.retailer_id != ? and tpp.pick_time >= ? and tpp.pick_time <= ? group by tpp.tattoo_code, tpp.retailer_id , pick_time_format ) as tmp group by tattoo_code, retailer_id order by pick_day_count desc limit ?","histograms":{"Query_time":[0,0,0,0,0,0,0,12]},"metrics":{"Lock_time":{"avg":"0.000004","max":"0.000006","median":"0.000003","min":"0.000002","pct":"0.011321","pct_95":"0.000005","stddev":"0.000001","sum":"0.000044"},"Query_length":{"avg":"1328","max":"1328","median":"1328","min":"1328","pct":"0","pct_95":"1328","stddev":"0","sum":"15936"},"Query_time":{"avg":"49.199239","max":"85.328271","median":"40.453711","min":"27.588598","pct":"0.011321","pct_95":"80.095580","stddev":"20.690686","sum":"590.390872"},"Rows_examined":{"avg":"647858","max":"650305","median":"634511","min":"646664","pct":"0","pct_95":"634511","stddev":"0","sum":"7774299"},"Rows_sent":{"avg":"50","max":"50","median":"50","min":"50","pct":"0","pct_95":"50","stddev":"0","sum":"600"},"db":{"value":"wsnh_prod"},"host":{"value":"192.168.5.243"},"user":{"value":"wsnh"}},"query_count":12,"tables":[{"create":"SHOW CREATE TABLE `wsnh_prod`.`t_pig_pick`\\G","status":"SHOW TABLE STATUS FROM `wsnh_prod` LIKE 't_pig_pick'\\G"},{"create":"SHOW CREATE TABLE `wsnh_prod`.`t_retailer_info`\\G","status":"SHOW TABLE STATUS FROM `wsnh_prod` LIKE 't_retailer_info'\\G"}],"ts_max":"2025-01-03T01:35:29","ts_min":"2025-01-03T00:03:29"},{"attribute":"fingerprint","checksum":"F94DA1CB92886DDF8AD17C9C7F9A3AA5","distillate":"SELECT t_pig_pick t_retailer_info","example":{"Query_time":"87.724085","query":"SELECT count(0) FROM (SELECT tmp.tattoo_code, tmp.retailer_id, tmp.market_id, tmp.contact_name, tmp.contact_phone, tmp.retailer_name, tmp.location, count(tmp.pick_time_format) pick_day_count FROM (SELECT tpp.tattoo_code, tpp.retailer_id, DATE_FORMAT(CONVERT_TZ(tpp.pick_time, '+00:00', '+08:00'), '%Y-%m-%d') pick_time_format, tri.market_id, tri.contact_name, tri.contact_phone, tri.retailer_name, tri.location FROM t_pig_pick tpp LEFT JOIN (SELECT retailer_id, retailer_name, market_id, contact_name, contact_phone, location FROM t_retailer_info WHERE is_delete = 0) tri ON tpp.retailer_id = tri.retailer_id WHERE tpp.is_delete = 0 AND tpp.retailer_id != -1 AND tpp.pick_time >= '2024-01-02 16:00:00' AND tpp.pick_time <= '2024-12-31 15:59:59.999' GROUP BY tpp.tattoo_code, tpp.retailer_id, pick_time_format) AS tmp GROUP BY tattoo_code, retailer_id) table_count","ts":"2025-01-03T00:04:38"},"fingerprint":"select count(?) from (select tmp.tattoo_code, tmp.retailer_id, tmp.market_id, tmp.contact_name, tmp.contact_phone, tmp.retailer_name, tmp.location, count(tmp.pick_time_format) pick_day_count from (select tpp.tattoo_code, tpp.retailer_id, date_format(convert_tz(tpp.pick_time, ?, ?), ?) pick_time_format, tri.market_id, tri.contact_name, tri.contact_phone, tri.retailer_name, tri.location from t_pig_pick tpp left join (select retailer_id, retailer_name, market_id, contact_name, contact_phone, location from t_retailer_info where is_delete = ?) tri on tpp.retailer_id = tri.retailer_id where tpp.is_delete = ? and tpp.retailer_id != ? and tpp.pick_time >= ? and tpp.pick_time <= ? group by tpp.tattoo_code, tpp.retailer_id, pick_time_format) as tmp group by tattoo_code, retailer_id) table_count","histograms":{"Query_time":[0,0,0,0,0,0,0,12]},"metrics":{"Lock_time":{"avg":"0.000007","max":"0.000012","median":"0.000007","min":"0.000005","pct":"0.011321","pct_95":"0.000010","stddev":"0.000002","sum":"0.000087"},"Query_length":{"avg":"863","max":"863","median":"863","min":"863","pct":"0","pct_95":"863","stddev":"0","sum":"10356"},"Query_time":{"avg":"46.754544","max":"87.724085","median":"42.476396","min":"26.302069","pct":"0.011321","pct_95":"76.281505","stddev":"20.079337","sum":"561.054525"},"Rows_examined":{"avg":"3772","max":"3777","median":"3600","min":"3770","pct":"0","pct_95":"3600","stddev":"0","sum":"45266"},"Rows_sent":{"avg":"1","max":"1","median":"1","min":"1","pct":"0","pct_95":"1","stddev":"0","sum":"12"},"db":{"value":"wsnh_prod"},"host":{"value":"192.168.5.243"},"user":{"value":"wsnh"}},"query_count":12,"tables":[{"create":"SHOW CREATE TABLE `wsnh_prod`.`t_pig_pick`\\G","status":"SHOW TABLE STATUS FROM `wsnh_prod` LIKE 't_pig_pick'\\G"},{"create":"SHOW CREATE TABLE `wsnh_prod`.`t_retailer_info`\\G","status":"SHOW TABLE STATUS FROM `wsnh_prod` LIKE 't_retailer_info'\\G"}],"ts_max":"2025-01-03T01:34:58","ts_min":"2025-01-03T00:02:47"},{"attribute":"fingerprint","checksum":"15D230AE92E71ADDA6A5327FF1FC64D5","distillate":"SELECT UNION t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place","example":{"Query_time":"5.743649","query":"SELECT SUM(plan_count) AS plan_count,\n            SUM(lay_count) AS lay_count,\n            SUM(hang_count) AS hang_count,\n            SUM(morning_count) AS morning_count,\n            SUM(head_count) AS head_count,\n            SUM(whole_count) AS whole_count,\n            SUM(service_fee) AS service_fee,\n            SUM(pig_fee) AS pig_fee,\n            SUM(service_fee + pig_fee) AS total_fee,\n            Count(DISTINCT pick_date) AS total_days\n        FROM ( \n         \n\n        SELECT CONCAT(rg.recognize_ids, '|', IFNULL(mn.recognize_ids, '')) AS recognize_ids,\n            CONCAT(rg.trade_ids, '|', IFNULL(mn.trade_ids, '')) AS trade_ids,\n            rg.stall_id,\n            rg.stall_code,\n            rg.stall_name,\n            rg.pick_date,\n            CONCAT(rg.status, '|', IFNULL(mn.status, '')) AS status,\n            CONCAT(rg.pick_ids, '|', IFNULL(mn.pick_ids, '')) AS pick_ids,\n            rg.retailer_id,\n            rg.tattoo_code,\n            IF(mn.stall_id IS NULL OR rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count)\n                + IF(mn.stall_id IS NULL OR rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count)\n            AS plan_count,\n            IF(mn.stall_id IS NULL OR rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) AS lay_count,\n            IF(mn.stall_id IS NULL OR rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) AS hang_count,\n            IF(mn.stall_id IS NULL, rg.morning_count, mn.morning_count) AS morning_count,\n            rg.head_count,\n            rg.whole_count,\n            rg.service_fee,\n            rg.pick_time,\n            rg.claim_slaughter_time,\n            rg.owner_ids,\n            rg.owner_code,\n            rg.owner_name,\n            rg.owner_phone,\n            rg.company_name,\n            rg.retailer_name,\n            rg.retailer_location,\n            rg.location,\n            rg.contact_phone,\n            rg.market_id,\n            rg.pig_fee,\n            rg.service_fee + rg.pig_fee AS total_fee,\n            rg.order_no,\n            rg.pay_way,\n            rg.integral,\n            rg.distributor_id,\n            rg.distributor_name,\n            rg.distributor_phone,\n            mp.market_code,\n            mp.market_name,\n            rg.default_plan_time\n        FROM ( \n        SELECT GROUP_CONCAT(DISTINCT pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(DISTINCT pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(DISTINCT pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(DISTINCT pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            pp.order_no,\n            pp.pay_way,\n            GROUP_CONCAT(DISTINCT pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.plan_count), 0) AS plan_count,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL(SUM(pp.morning_count), 0) AS morning_count,\n            IFNULL(SUM(pp.head_count), 0) AS head_count,\n            IFNULL(SUM(pp.whole_count), 0) AS whole_count,\n            IFNULL(SUM(pp.service_fee), 0) AS service_fee,\n            MAX(pp.create_time) AS pick_time,\n            MAX(pp.claim_slaughter_time) AS claim_slaughter_time,\n            GROUP_CONCAT(DISTINCT st.owner_id SEPARATOR ',') AS owner_ids,\n            GROUP_CONCAT(DISTINCT st.owner_code SEPARATOR ',') AS owner_code,\n            GROUP_CONCAT(DISTINCT st.owner_name SEPARATOR ',') AS owner_name,\n            GROUP_CONCAT(DISTINCT st.owner_phone SEPARATOR ',') AS owner_phone,\n            GROUP_CONCAT(DISTINCT st.company_name SEPARATOR ',') AS company_name,\n            GROUP_CONCAT(DISTINCT ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            MAX(ri.location) AS location,\n            GROUP_CONCAT(DISTINCT ri.contact_phone SEPARATOR ',') AS contact_phone,\n            ri.market_id,\n            IFNULL(SUM(pp.pig_fee), 0) AS pig_fee,\n            rit.integral,\n            di.distributor_id,\n            di.distributor_name,\n            di.distributor_phone,\n            MAX(ri.default_plan_time) AS default_plan_time\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_slaughter_trade st ON pr.trade_id = st.trade_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_retailer_integral rit ON pp.retailer_id = rit.retailer_id\n            LEFT JOIN t_distributor_info di ON ri.distributor_id = di.distributor_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n         WHERE pr.status = 'submitted'\n            \n        \n            and pr.pick_date >= '2025-01-01 16:00:00'\n        \n        \n            and pr.pick_date <= '2025-01-02 15:59:59.999'\n        \n        \n        \n        \n        \n        \n        \n        \n            AND pr.stall_id = 15\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.is_delete = 0\n        AND pp.is_delete = 0\n    \n            AND isnull(pp.relate_pick_id) = 1 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone\n     ) rg\n            LEFT JOIN ( \n        SELECT GROUP_CONCAT(DISTINCT pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(DISTINCT pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(DISTINCT pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(DISTINCT pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            pp.order_no,\n            pp.pay_way,\n            GROUP_CONCAT(DISTINCT pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.plan_count), 0) AS plan_count,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL(SUM(pp.morning_count), 0) AS morning_count,\n            IFNULL(SUM(pp.head_count), 0) AS head_count,\n            IFNULL(SUM(pp.whole_count), 0) AS whole_count,\n            IFNULL(SUM(pp.service_fee), 0) AS service_fee,\n            MAX(pp.create_time) AS pick_time,\n            MAX(pp.claim_slaughter_time) AS claim_slaughter_time,\n            GROUP_CONCAT(DISTINCT st.owner_id SEPARATOR ',') AS owner_ids,\n            GROUP_CONCAT(DISTINCT st.owner_code SEPARATOR ',') AS owner_code,\n            GROUP_CONCAT(DISTINCT st.owner_name SEPARATOR ',') AS owner_name,\n            GROUP_CONCAT(DISTINCT st.owner_phone SEPARATOR ',') AS owner_phone,\n            GROUP_CONCAT(DISTINCT st.company_name SEPARATOR ',') AS company_name,\n            GROUP_CONCAT(DISTINCT ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            MAX(ri.location) AS location,\n            GROUP_CONCAT(DISTINCT ri.contact_phone SEPARATOR ',') AS contact_phone,\n            ri.market_id,\n            IFNULL(SUM(pp.pig_fee), 0) AS pig_fee,\n            rit.integral,\n            di.distributor_id,\n            di.distributor_name,\n            di.distributor_phone,\n            MAX(ri.default_plan_time) AS default_plan_time\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_slaughter_trade st ON pr.trade_id = st.trade_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_retailer_integral rit ON pp.retailer_id = rit.retailer_id\n            LEFT JOIN t_distributor_info di ON ri.distributor_id = di.distributor_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n         WHERE pr.status = 'morningpick'\n            \n        \n            and pr.pick_date >= '2025-01-01 16:00:00'\n        \n        \n            and pr.pick_date <= '2025-01-02 15:59:59.999'\n        \n        \n        \n        \n        \n        \n        \n        \n            AND pr.stall_id = 15\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.is_delete = 0\n        AND pp.is_delete = 0\n    \n            AND isnull(pp.relate_pick_id) = 1 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone\n     ) mn\n                ON rg.stall_id = mn.stall_id AND rg.pick_date = mn.pick_date AND rg.retailer_id = mn.retailer_id\n            LEFT JOIN t_market_place mp ON rg.market_id = mp.market_id\n        UNION (\n            SELECT CONCAT(IFNULL(rg2.recognize_ids, ''), '|', mn2.recognize_ids) AS recognize_ids,\n                CONCAT(IFNULL(rg2.trade_ids, ''), '|', mn2.trade_ids) AS trade_ids,\n                mn2.stall_id,\n                mn2.stall_code,\n                mn2.stall_name,\n                mn2.pick_date,\n                CONCAT(IFNULL(rg2.status, ''), '|', mn2.status) AS status,\n                CONCAT(IFNULL(rg2.pick_ids, ''), '|', mn2.pick_ids) AS pick_ids,\n                mn2.retailer_id,\n                mn2.tattoo_code,\n                mn2.plan_count,\n                mn2.lay_count,\n                mn2.hang_count,\n                mn2.morning_count,\n                mn2.head_count,\n                mn2.whole_count,\n                mn2.service_fee,\n                mn2.pick_time,\n                mn2.claim_slaughter_time,\n                mn2.owner_ids,\n                mn2.owner_code,\n                mn2.owner_name,\n                mn2.owner_phone,\n                mn2.","ts":"2025-01-03T01:03:31"},"fingerprint":"select sum(plan_count) as plan_count, sum(lay_count) as lay_count, sum(hang_count) as hang_count, sum(morning_count) as morning_count, sum(head_count) as head_count, sum(whole_count) as whole_count, sum(service_fee) as service_fee, sum(pig_fee) as pig_fee, sum(service_fee ? pig_fee) as total_fee, count(distinct pick_date) as total_days from ( select concat(rg.recognize_ids, ?, ifnull(mn.recognize_ids, ?)) as recognize_ids, concat(rg.trade_ids, ?, ifnull(mn.trade_ids, ?)) as trade_ids, rg.stall_id, rg.stall_code, rg.stall_name, rg.pick_date, concat(rg.status, ?, ifnull(mn.status, ?)) as status, concat(rg.pick_ids, ?, ifnull(mn.pick_ids, ?)) as pick_ids, rg.retailer_id, rg.tattoo_code, if(mn.stall_id is ? or rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) ? if(mn.stall_id is ? or rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) as plan_count, if(mn.stall_id is ? or rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) as lay_count, if(mn.stall_id is ? or rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) as hang_count, if(mn.stall_id is ?, rg.morning_count, mn.morning_count) as morning_count, rg.head_count, rg.whole_count, rg.service_fee, rg.pick_time, rg.claim_slaughter_time, rg.owner_ids, rg.owner_code, rg.owner_name, rg.owner_phone, rg.company_name, rg.retailer_name, rg.retailer_location, rg.location, rg.contact_phone, rg.market_id, rg.pig_fee, rg.service_fee ? rg.pig_fee as total_fee, rg.order_no, rg.pay_way, rg.integral, rg.distributor_id, rg.distributor_name, rg.distributor_phone, mp.market_code, mp.market_name, rg.default_plan_time from ( select group_concat(distinct pr.recognize_id separator ?) as recognize_ids, group_concat(distinct pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(distinct pr.stall_code separator ?) as stall_code, group_concat(distinct pr.stall_name separator ?) as stall_name, pr.pick_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, group_concat(distinct pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.plan_count), ?) as plan_count, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(sum(pp.morning_count), ?) as morning_count, ifnull(sum(pp.head_count), ?) as head_count, ifnull(sum(pp.whole_count), ?) as whole_count, ifnull(sum(pp.service_fee), ?) as service_fee, max(pp.create_time) as pick_time, max(pp.claim_slaughter_time) as claim_slaughter_time, group_concat(distinct st.owner_id separator ?) as owner_ids, group_concat(distinct st.owner_code separator ?) as owner_code, group_concat(distinct st.owner_name separator ?) as owner_name, group_concat(distinct st.owner_phone separator ?) as owner_phone, group_concat(distinct st.company_name separator ?) as company_name, group_concat(distinct ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, max(ri.location) as location, group_concat(distinct ri.contact_phone separator ?) as contact_phone, ri.market_id, ifnull(sum(pp.pig_fee), ?) as pig_fee, rit.integral, di.distributor_id, di.distributor_name, di.distributor_phone, max(ri.default_plan_time) as default_plan_time from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id left join t_slaughter_trade st on pr.trade_id = st.trade_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_retailer_integral rit on pp.retailer_id = rit.retailer_id left join t_distributor_info di on ri.distributor_id = di.distributor_id left join t_market_place mp on ri.market_id = mp.market_id where pr.status = ? and pr.pick_date >= ? and pr.pick_date <= ? and pr.stall_id = ? and pr.is_delete = ? and pp.is_delete = ? and isnull(pp.relate_pick_id) = ? group by pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone ) rg left join ( select group_concat(distinct pr.recognize_id separator ?) as recognize_ids, group_concat(distinct pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(distinct pr.stall_code separator ?) as stall_code, group_concat(distinct pr.stall_name separator ?) as stall_name, pr.pick_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, group_concat(distinct pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.plan_count), ?) as plan_count, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(sum(pp.morning_count), ?) as morning_count, ifnull(sum(pp.head_count), ?) as head_count, ifnull(sum(pp.whole_count), ?) as whole_count, ifnull(sum(pp.service_fee), ?) as service_fee, max(pp.create_time) as pick_time, max(pp.claim_slaughter_time) as claim_slaughter_time, group_concat(distinct st.owner_id separator ?) as owner_ids, group_concat(distinct st.owner_c","histograms":{"Query_time":[0,0,0,0,0,0,119,0]},"metrics":{"Lock_time":{"avg":"0.000041","max":"0.000238","median":"0.000032","min":"0.000016","pct":"0.112264","pct_95":"0.000085","stddev":"0.000028","sum":"0.004919"},"Query_length":{"avg":"25526","max":"25528","median":"25348","min":"25522","pct":"0","pct_95":"25348","stddev":"0","sum":"3037688"},"Query_time":{"avg":"4.474625","max":"5.743649","median":"4.727475","min":"3.077575","pct":"0.112264","pct_95":"5.212041","stddev":"0.715043","sum":"532.480340"},"Rows_examined":{"avg":"41","max":"117","median":"34","min":"0","pct":"0","pct_95":"102","stddev":"31","sum":"4971"},"Rows_sent":{"avg":"1","max":"1","median":"1","min":"1","pct":"0","pct_95":"1","stddev":"0","sum":"119"},"db":{"value":"pz_wsnh_prod"},"host":{"value":"192.168.5.243"},"user":{"value":"pz_wsnh"}},"query_count":119,"tables":[{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pick_recognize`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pick_recognize'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pig_pick`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pig_pick'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_slaughter_trade`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_slaughter_trade'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_integral`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_integral'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_distributor_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_distributor_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_market_place`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_market_place'\\G"}],"ts_max":"2025-01-03T06:07:13","ts_min":"2025-01-03T01:02:57"},{"attribute":"fingerprint","checksum":"3EA56BEF12DDA00098D827C92CAAB353","distillate":"SELECT UNION t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place","example":{"Query_time":"13.116998","query":"SELECT pick_date,\n            SUM(plan_count) AS plan_count,\n            SUM(lay_count) AS lay_count,\n            SUM(hang_count) AS hang_count,\n            SUM(morning_count) AS morning_count,\n            SUM(head_count) AS head_count,\n            SUM(whole_count) AS whole_count,\n            SUM(service_fee) AS service_fee\n        FROM ( \n         \n\n        SELECT CONCAT(rg.recognize_ids, '|') AS recognize_ids,\n            CONCAT(rg.trade_ids, '|') AS trade_ids,\n            rg.stall_id,\n            rg.stall_code,\n            rg.stall_name,\n            rg.pick_date,\n            CONCAT(rg.status, '|') AS status,\n            CONCAT(rg.pick_ids, '|') AS pick_ids,\n            rg.retailer_id,\n            rg.tattoo_code,\n            rg.lay_count + rg.hang_count AS plan_count,\n            rg.lay_count,\n            rg.hang_count,\n            rg.morning_count,\n            rg.head_count,\n            rg.whole_count,\n            rg.service_fee,\n            rg.pick_time,\n            rg.claim_slaughter_time,\n            rg.owner_ids,\n            rg.owner_code,\n            rg.owner_name,\n            rg.owner_phone,\n            rg.company_name,\n            rg.retailer_name,\n            rg.retailer_location,\n            rg.location,\n            rg.contact_phone,\n            rg.market_id,\n            rg.pig_fee,\n            rg.service_fee + rg.pig_fee AS total_fee,\n            rg.scanPayAmount AS scan_pay_amount,\n            rg.cashPayAmount AS cash_pay_amount,\n            rg.creditPayAmount AS credit_pay_amount,\n            rg.pigWeight AS pig_weight,\n            rg.order_no,\n            rg.pay_way,\n            rg.pay_status,\n            rg.integral,\n            rg.distributor_id,\n            rg.distributor_name,\n            rg.distributor_phone,\n            mp.market_code,\n            mp.market_name,\n            rg.default_plan_time,\n            rg.company\n        FROM ( \n        SELECT GROUP_CONCAT(DISTINCT pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(DISTINCT pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(DISTINCT pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(DISTINCT pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            pp.order_no,\n            pp.pay_way,\n            pp.pay_status,\n            GROUP_CONCAT(DISTINCT pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.plan_count), 0) AS plan_count,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL(SUM(pp.morning_count), 0) AS morning_count,\n            IFNULL(SUM(pp.head_count), 0) AS head_count,\n            IFNULL(SUM(pp.whole_count), 0) AS whole_count,\n            IFNULL(SUM(pp.service_fee), 0) AS service_fee,\n            IFNULL(SUM(pp.scan_pay_amount), 0) AS scanPayAmount,\n            IFNULL(SUM(pp.cash_pay_amount), 0) AS cashPayAmount,\n            IFNULL(SUM(pp.credit_pay_amount), 0) AS creditPayAmount,\n            IFNULL(SUM(pp.pig_weight), 0) AS pigWeight,\n            MAX(pp.create_time) AS pick_time,\n            MAX(pp.claim_slaughter_time) AS claim_slaughter_time,\n            GROUP_CONCAT(DISTINCT st.owner_id SEPARATOR ',') AS owner_ids,\n            GROUP_CONCAT(DISTINCT st.owner_code SEPARATOR ',') AS owner_code,\n            GROUP_CONCAT(DISTINCT st.owner_name SEPARATOR ',') AS owner_name,\n            GROUP_CONCAT(DISTINCT st.owner_phone SEPARATOR ',') AS owner_phone,\n            GROUP_CONCAT(DISTINCT st.company_name SEPARATOR ',') AS company_name,\n            GROUP_CONCAT(DISTINCT ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            MAX(ri.location) AS location,\n            GROUP_CONCAT(DISTINCT ri.contact_phone SEPARATOR ',') AS contact_phone,\n            ri.market_id,\n            IFNULL(SUM(pp.pig_fee), 0) AS pig_fee,\n            rit.integral,\n            di.distributor_id,\n            di.distributor_name,\n            di.distributor_phone,\n            MAX(ri.default_plan_time) AS default_plan_time,\n            ri.company\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id AND pp.pick_type in (1,2,3)\n            LEFT JOIN t_slaughter_trade st ON pr.trade_id = st.trade_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_retailer_integral rit ON pp.retailer_id = rit.retailer_id\n            LEFT JOIN t_distributor_info di ON ri.distributor_id = di.distributor_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n         WHERE pr.status = 'submitted'\n            AND pp.is_scan_pick = 0\n            \n        \n            and pr.pick_date >= '2024-12-03 16:00:00'\n        \n        \n            and pr.pick_date <= '2025-01-02 15:59:59.999'\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.is_delete = 0\n        AND pp.is_delete = 0\n    \n            AND isnull(pp.relate_pick_id) = 1 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way,pp.pay_status, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone, ri.company\n     ) rg\n            LEFT JOIN t_market_place mp ON rg.market_id = mp.market_id\n        UNION (\n            SELECT CONCAT('|', IFNULL(mn.recognize_ids, '')) AS recognize_ids,\n            CONCAT('|', IFNULL(mn.trade_ids, '')) AS trade_ids,\n            mn.stall_id,\n            mn.stall_code,\n            mn.stall_name,\n            mn.pick_date,\n            CONCAT('|', IFNULL(mn.status, '')) AS status,\n            CONCAT('|', IFNULL(mn.pick_ids, '')) AS pick_ids,\n            mn.retailer_id,\n            mn.tattoo_code,\n            mn.lay_count +  mn.hang_count AS plan_count,\n            mn.lay_count,\n            mn.hang_count,\n            mn.morning_count,\n            mn.head_count,\n            mn.whole_count,\n            mn.service_fee,\n            mn.pick_time,\n            mn.claim_slaughter_time,\n            mn.owner_ids,\n            mn.owner_code,\n            mn.owner_name,\n            mn.owner_phone,\n            mn.company_name,\n            mn.retailer_name,\n            mn.retailer_location,\n            mn.location,\n            mn.contact_phone,\n            mn.market_id,\n            mn.pig_fee,\n            mn.service_fee + mn.pig_fee AS total_fee,\n            mn.scanPayAmount AS scan_pay_amount,\n            mn.cashPayAmount AS cash_pay_amount,\n            mn.creditPayAmount AS credit_pay_amount,\n            mn.pigWeight AS pig_weight,\n            mn.order_no,\n            mn.pay_way,\n            mn.pay_status,\n            mn.integral,\n            mn.distributor_id,\n            mn.distributor_name,\n            mn.distributor_phone,\n            mp.market_code,\n            mp.market_name,\n            mn.default_plan_time,\n            mn.company\n            FROM ( \n        SELECT GROUP_CONCAT(DISTINCT pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(DISTINCT pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(DISTINCT pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(DISTINCT pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            pp.order_no,\n            pp.pay_way,\n            pp.pay_status,\n            GROUP_CONCAT(DISTINCT pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.plan_count), 0) AS plan_count,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL(SUM(pp.morning_count), 0) AS morning_count,\n            IFNULL(SUM(pp.head_count), 0) AS head_count,\n            IFNULL(SUM(pp.whole_count), 0) AS whole_count,\n            IFNULL(SUM(pp.service_fee), 0) AS service_fee,\n            IFNULL(SUM(pp.scan_pay_amount), 0) AS scanPayAmount,\n            IFNULL(SUM(pp.cash_pay_amount), 0) AS cashPayAmount,\n            IFNULL(SUM(pp.credit_pay_amount), 0) AS creditPayAmount,\n            IFNULL(SUM(pp.pig_weight), 0) AS pigWeight,\n            MAX(pp.create_time) AS pick_time,\n            MAX(pp.claim_slaughter_time) AS claim_slaughter_time,\n            GROUP_CONCAT(DISTINCT st.owner_id SEPARATOR ',') AS owner_ids,\n            GROUP_CONCAT(DISTINCT st.owner_code SEPARATOR ',') AS owner_code,\n            GROUP_CONCAT(DISTINCT st.owner_name SEPARATOR ',') AS owner_name,\n            GROUP_CONCAT(DISTINCT st.owner_phone SEPARATOR ',') AS owner_phone,\n            GROUP_CONCAT(DISTINCT st.company_name SEPARATOR ',') AS company_name,\n            GROUP_CONCAT(DISTINCT ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            MAX(ri.location) AS location,\n            GROUP_CONCAT(DISTINCT ri.contact_phone SEPARATOR ',') AS contact_phone,\n            ri.market_id,\n            IFNULL(SUM(pp.pig_fee), 0) AS pig_fee,\n            rit.integral,\n            di.distributor_id,\n            di.distributor_name,\n            di.distributor_phone,\n            MAX(ri.default_plan_time) AS default_plan_time,\n            ri.company\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id AND pp.pick_type in (1,2,3)\n            LEFT JOIN t_slaughter_trade st ON pr.trade_id = st.trade_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_retailer_integral rit ON pp.retailer_id = rit.retailer_id\n            LEFT JOIN t_distributor_info di","ts":"2025-01-03T12:50:56"},"fingerprint":"select pick_date, sum(plan_count) as plan_count, sum(lay_count) as lay_count, sum(hang_count) as hang_count, sum(morning_count) as morning_count, sum(head_count) as head_count, sum(whole_count) as whole_count, sum(service_fee) as service_fee from ( select concat(rg.recognize_ids, ?) as recognize_ids, concat(rg.trade_ids, ?) as trade_ids, rg.stall_id, rg.stall_code, rg.stall_name, rg.pick_date, concat(rg.status, ?) as status, concat(rg.pick_ids, ?) as pick_ids, rg.retailer_id, rg.tattoo_code, rg.lay_count ? rg.hang_count as plan_count, rg.lay_count, rg.hang_count, rg.morning_count, rg.head_count, rg.whole_count, rg.service_fee, rg.pick_time, rg.claim_slaughter_time, rg.owner_ids, rg.owner_code, rg.owner_name, rg.owner_phone, rg.company_name, rg.retailer_name, rg.retailer_location, rg.location, rg.contact_phone, rg.market_id, rg.pig_fee, rg.service_fee ? rg.pig_fee as total_fee, rg.scanpayamount as scan_pay_amount, rg.cashpayamount as cash_pay_amount, rg.creditpayamount as credit_pay_amount, rg.pigweight as pig_weight, rg.order_no, rg.pay_way, rg.pay_status, rg.integral, rg.distributor_id, rg.distributor_name, rg.distributor_phone, mp.market_code, mp.market_name, rg.default_plan_time, rg.company from ( select group_concat(distinct pr.recognize_id separator ?) as recognize_ids, group_concat(distinct pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(distinct pr.stall_code separator ?) as stall_code, group_concat(distinct pr.stall_name separator ?) as stall_name, pr.pick_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, pp.pay_status, group_concat(distinct pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.plan_count), ?) as plan_count, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(sum(pp.morning_count), ?) as morning_count, ifnull(sum(pp.head_count), ?) as head_count, ifnull(sum(pp.whole_count), ?) as whole_count, ifnull(sum(pp.service_fee), ?) as service_fee, ifnull(sum(pp.scan_pay_amount), ?) as scanpayamount, ifnull(sum(pp.cash_pay_amount), ?) as cashpayamount, ifnull(sum(pp.credit_pay_amount), ?) as creditpayamount, ifnull(sum(pp.pig_weight), ?) as pigweight, max(pp.create_time) as pick_time, max(pp.claim_slaughter_time) as claim_slaughter_time, group_concat(distinct st.owner_id separator ?) as owner_ids, group_concat(distinct st.owner_code separator ?) as owner_code, group_concat(distinct st.owner_name separator ?) as owner_name, group_concat(distinct st.owner_phone separator ?) as owner_phone, group_concat(distinct st.company_name separator ?) as company_name, group_concat(distinct ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, max(ri.location) as location, group_concat(distinct ri.contact_phone separator ?) as contact_phone, ri.market_id, ifnull(sum(pp.pig_fee), ?) as pig_fee, rit.integral, di.distributor_id, di.distributor_name, di.distributor_phone, max(ri.default_plan_time) as default_plan_time, ri.company from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id and pp.pick_type in(?+) left join t_slaughter_trade st on pr.trade_id = st.trade_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_retailer_integral rit on pp.retailer_id = rit.retailer_id left join t_distributor_info di on ri.distributor_id = di.distributor_id left join t_market_place mp on ri.market_id = mp.market_id where pr.status = ? and pp.is_scan_pick = ? and pr.pick_date >= ? and pr.pick_date <= ? and pr.is_delete = ? and pp.is_delete = ? and isnull(pp.relate_pick_id) = ? group by pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way,pp.pay_status, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone, ri.company ) rg left join t_market_place mp on rg.market_id = mp.market_id union ( select concat(?, ifnull(mn.recognize_ids, ?)) as recognize_ids, concat(?, ifnull(mn.trade_ids, ?)) as trade_ids, mn.stall_id, mn.stall_code, mn.stall_name, mn.pick_date, concat(?, ifnull(mn.status, ?)) as status, concat(?, ifnull(mn.pick_ids, ?)) as pick_ids, mn.retailer_id, mn.tattoo_code, mn.lay_count ? mn.hang_count as plan_count, mn.lay_count, mn.hang_count, mn.morning_count, mn.head_count, mn.whole_count, mn.service_fee, mn.pick_time, mn.claim_slaughter_time, mn.owner_ids, mn.owner_code, mn.owner_name, mn.owner_phone, mn.company_name, mn.retailer_name, mn.retailer_location, mn.location, mn.contact_phone, mn.market_id, mn.pig_fee, mn.service_fee ? mn.pig_fee as total_fee, mn.scanpayamount as scan_pay_amount, mn.cashpayamount as cash_pay_amount, mn.creditpayamount as credit_pay_amount, mn.pigweight as pig_weight, mn.order_no, mn.pay_way, mn.pay_status, mn.integral, mn.distributor_id, mn.distributor_name, mn.distributor_phone, mp.market_code, mp.market_name, mn.default_plan_time, mn.company from ( select group_concat(distinct pr.recogni","histograms":{"Query_time":[0,0,0,0,0,0,52,5]},"metrics":{"Lock_time":{"avg":"0.000035","max":"0.000064","median":"0.000032","min":"0.000022","pct":"0.053774","pct_95":"0.000045","stddev":"0.000007","sum":"0.001983"},"Query_length":{"avg":"35075","max":"35075","median":"35075","min":"35075","pct":"0","pct_95":"35075","stddev":"0","sum":"1999275"},"Query_time":{"avg":"7.965879","max":"13.116998","median":"7.333865","min":"6.846067","pct":"0.053774","pct_95":"10.319484","stddev":"1.056030","sum":"454.055087"},"Rows_examined":{"avg":"63642","max":"63642","median":"63642","min":"63642","pct":"0","pct_95":"63642","stddev":"0","sum":"3627594"},"Rows_sent":{"avg":"30","max":"30","median":"30","min":"30","pct":"0","pct_95":"30","stddev":"0","sum":"1710"},"db":{"value":"wsnh_prod"},"host":{"value":"192.168.5.243"},"user":{"value":"wsnh"}},"query_count":57,"tables":[{"create":"SHOW CREATE TABLE `wsnh_prod`.`t_pick_recognize`\\G","status":"SHOW TABLE STATUS FROM `wsnh_prod` LIKE 't_pick_recognize'\\G"},{"create":"SHOW CREATE TABLE `wsnh_prod`.`t_pig_pick`\\G","status":"SHOW TABLE STATUS FROM `wsnh_prod` LIKE 't_pig_pick'\\G"},{"create":"SHOW CREATE TABLE `wsnh_prod`.`t_slaughter_trade`\\G","status":"SHOW TABLE STATUS FROM `wsnh_prod` LIKE 't_slaughter_trade'\\G"},{"create":"SHOW CREATE TABLE `wsnh_prod`.`t_retailer_info`\\G","status":"SHOW TABLE STATUS FROM `wsnh_prod` LIKE 't_retailer_info'\\G"},{"create":"SHOW CREATE TABLE `wsnh_prod`.`t_retailer_integral`\\G","status":"SHOW TABLE STATUS FROM `wsnh_prod` LIKE 't_retailer_integral'\\G"},{"create":"SHOW CREATE TABLE `wsnh_prod`.`t_distributor_info`\\G","status":"SHOW TABLE STATUS FROM `wsnh_prod` LIKE 't_distributor_info'\\G"},{"create":"SHOW CREATE TABLE `wsnh_prod`.`t_market_place`\\G","status":"SHOW TABLE STATUS FROM `wsnh_prod` LIKE 't_market_place'\\G"}],"ts_max":"2025-01-03T13:09:04","ts_min":"2025-01-02T19:00:01"},{"attribute":"fingerprint","checksum":"E3C753C2F267B2D767A347A2812914DF","distillate":"SELECT t_bill_info","example":{"Query_time":"138.845193","as_select":"SELECT \/*!40001 SQL_NO_CACHE *\/ * FROM `t_bill_info`","query":"SELECT \/*!40001 SQL_NO_CACHE *\/ * FROM `t_bill_info`","ts":"2025-01-03T15:02:30"},"fingerprint":"mysqldump","histograms":{"Query_time":[0,0,0,0,0,0,7,9]},"metrics":{"Lock_time":{"avg":"0.000000","max":"0.000000","median":"0.000000","min":"0.000000","pct":"0.015094","pct_95":"0.000000","stddev":"0.000000","sum":"0.000000"},"Query_length":{"avg":"55","max":"65","median":"51","min":"51","pct":"0","pct_95":"59","stddev":"3","sum":"881"},"Query_time":{"avg":"26.056726","max":"138.845193","median":"16.008907","min":"2.535048","pct":"0.015094","pct_95":"65.894832","stddev":"33.643688","sum":"416.907620"},"Rows_examined":{"avg":"1162077","max":"4619136","median":"984335","min":"43723","pct":"0","pct_95":"2046363","stddev":"1097704","sum":"18593241"},"Rows_sent":{"avg":"1162077","max":"4619136","median":"984335","min":"43723","pct":"0","pct_95":"2046363","stddev":"1097704","sum":"18593241"},"db":{"value":"wsnh_prod"},"host":{"value":"localhost"},"user":{"value":"root"}},"query_count":16,"tables":[{"create":"SHOW CREATE TABLE `wsnh_prod`.`t_bill_info`\\G","status":"SHOW TABLE STATUS FROM `wsnh_prod` LIKE 't_bill_info'\\G"}],"ts_max":"2025-01-03T15:07:17","ts_min":"2025-01-03T15:02:30"},{"attribute":"fingerprint","checksum":"EE1E0D89900E916B25B7BD018D610C37","distillate":"SELECT UNION t_pick_recognize t_pig_pick t_retailer_info t_market_place t_bill_print t_pick_recognize t_pig_pick t_retailer_info t_market_place t_bill_print t_pick_recognize t_pig_pick t_retailer_info t_market_place t_bill_print","example":{"Query_time":"16.220180","query":"SELECT GROUP_CONCAT(pick_ids SEPARATOR ',') AS pick_ids,\n            SUM(purchase_count) AS purchase_count,\n            SUM(dead_pig_count) AS dead_pig_count,\n            SUM(IF(print_count > purchase_count, purchase_count, print_count)) AS print_count,\n            MAX(print_time) AS print_time\n        FROM ( \n        SELECT GROUP_CONCAT(gb.recognize_ids SEPARATOR '+') AS recognize_ids,\n            GROUP_CONCAT(gb.trade_ids SEPARATOR '+') AS trade_ids,\n            GROUP_CONCAT(gb.stall_id SEPARATOR ',') AS stall_ids,\n            GROUP_CONCAT(gb.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(gb.stall_name SEPARATOR ',') AS stall_name,\n            gb.bill_date,\n            GROUP_CONCAT(gb.pick_ids SEPARATOR ',') AS pick_ids,\n            gb.retailer_id,\n            GROUP_CONCAT(gb.tattoo_code SEPARATOR ',') AS tattoo_code,\n            SUM(gb.purchase_count) AS purchase_count,\n            SUM(gb.dead_pig_count) AS dead_pig_count,\n            GROUP_CONCAT(gb.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(gb.retailer_location) AS retailer_location,\n            GROUP_CONCAT(gb.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(gb.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(gb.print_status SEPARATOR ',') AS print_status,\n            SUM(gb.print_count) AS print_count,\n            MAX(gb.print_time) AS print_time,\n            MAX(gb.retailer_mark) AS retailer_mark\n        FROM (\n            (\n                 \n        SELECT CONCAT(rg.recognize_ids, '|', IFNULL(mn.recognize_ids, '')) AS recognize_ids,\n            CONCAT(rg.trade_ids, '|', IFNULL(mn.trade_ids, '')) AS trade_ids,\n            rg.stall_id,\n            rg.stall_code,\n            rg.stall_name,\n            rg.bill_date,\n            rg.status,\n            rg.pick_ids,\n            rg.retailer_id,\n            rg.tattoo_code,\n            IF(rg.lay_count + rg.hang_count - IF(mn.stall_id IS NULL, 0, mn.lay_count + mn.hang_count) >= 0,\n                rg.lay_count + rg.hang_count - IF(mn.stall_id IS NULL, 0, mn.lay_count + mn.hang_count), 0) AS purchase_count,\n            rg.lay_count,\n            rg.hang_count,\n            rg.dead_pig_count,\n            \n            rg.retailer_name,\n            rg.retailer_location,\n            rg.contact_phone,\n            rg.market_name,\n            rg.print_status,\n            IF(rg.print_count - IF(mn.stall_id IS NULL, 0, mn.print_count) >= 0,\n                rg.print_count - IF(mn.stall_id IS NULL, 0, mn.print_count), 0) AS print_count,\n            rg.print_time,\n            rg.retailer_mark\n        FROM (\n             \n        SELECT GROUP_CONCAT(pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date AS bill_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            GROUP_CONCAT(pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL((\n                    \n                    0\n            ), 0) AS dead_pig_count,\n            GROUP_CONCAT(ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            GROUP_CONCAT(ri.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(mp.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(bp.print_status SEPARATOR ',') AS print_status,\n            SUM(IF(bp.print_status = '1', IFNULL(pp.lay_count, 0) + IFNULL(pp.hang_count, 0), 0)) AS print_count,\n            MAX(bp.print_time) AS print_time,\n            MAX(ri.retailer_mark) AS retailer_mark\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n            LEFT JOIN t_bill_print bp ON pp.pick_id = bp.pick_id AND bp.is_delete = 0\n         WHERE  pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            AND pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n            AND pr.stall_id = 8\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.status = 'submitted' AND pr.is_delete = 0\n        AND pp.retailer_id > 0 AND pp.is_delete = 0 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id\n     \n        ) rg LEFT JOIN (\n             \n        SELECT GROUP_CONCAT(pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date AS bill_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            GROUP_CONCAT(pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL((\n                    \n                    0\n            ), 0) AS dead_pig_count,\n            GROUP_CONCAT(ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            GROUP_CONCAT(ri.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(mp.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(bp.print_status SEPARATOR ',') AS print_status,\n            SUM(IF(bp.print_status = '1', IFNULL(pp.lay_count, 0) + IFNULL(pp.hang_count, 0), 0)) AS print_count,\n            MAX(bp.print_time) AS print_time,\n            MAX(ri.retailer_mark) AS retailer_mark\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n            LEFT JOIN t_bill_print bp ON pp.pick_id = bp.pick_id AND bp.is_delete = 0\n         WHERE  pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            AND pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n            AND pr.stall_id = 8\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.status = 'morningpick' AND pr.is_delete = 0\n        AND pp.retailer_id > 0 AND pp.is_delete = 0 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id\n     \n        ) mn ON rg.bill_date = mn.bill_date AND rg.stall_id = mn.stall_id AND rg.retailer_id = mn.retailer_id\n        HAVING purchase_count != 0 OR print_count != 0\n     \n            ) UNION (\n                 \n        SELECT CONCAT('|', mn2.recognize_ids) AS recognize_ids,\n            CONCAT('|', mn2.trade_ids) AS trade_ids,\n            mn2.stall_id,\n            mn2.stall_code,\n            mn2.stall_name,\n            mn2.bill_date,\n            mn2.status,\n            mn2.pick_ids,\n            mn2.retailer_id,\n            mn2.tattoo_code,\n            mn2.lay_count + mn2.hang_count AS purchase_count,\n            mn2.lay_count,\n            mn2.hang_count,\n            mn2.dead_pig_count,\n            \n            mn2.retailer_name,\n            mn2.retailer_location,\n            mn2.contact_phone,\n            mn2.market_name,\n            mn2.print_status,\n            mn2.print_count,\n            mn2.print_time,\n            mn2.retailer_mark\n        FROM (\n             \n        SELECT GROUP_CONCAT(pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date AS bill_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            GROUP_CONCAT(pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL((\n                    \n                    0\n            ), 0) AS dead_pig_count,\n            GROUP_CONCAT(ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            GROUP_CONCAT(ri.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(mp.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(bp.print_status SEPARATOR ',') AS print_status,\n            SUM(IF(bp.print_status = '1', IFNULL(pp.lay_count, 0) + IFNULL(pp.hang_count, 0), 0)) AS print_count,\n            MAX(bp.print_time) AS print_time,\n            MAX(ri.retailer_mark) AS retailer_mark\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n            LEFT JOIN t_bill_print bp ON pp.pick_id = bp.pick_id AND bp.is_delete = 0\n         WHERE  pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            AND pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n            AND pr.stall_id = 8\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.status = 'morningpick' AND pr.is_delete = 0\n        AND pp.retailer_id > 0 AND pp.is_delete = 0 \n        GROUP BY pr.pick_date, pr.","ts":"2025-01-03T04:47:21"},"fingerprint":"select group_concat(pick_ids separator ?) as pick_ids, sum(purchase_count) as purchase_count, sum(dead_pig_count) as dead_pig_count, sum(if(print_count > purchase_count, purchase_count, print_count)) as print_count, max(print_time) as print_time from ( select group_concat(gb.recognize_ids separator ?) as recognize_ids, group_concat(gb.trade_ids separator ?) as trade_ids, group_concat(gb.stall_id separator ?) as stall_ids, group_concat(gb.stall_code separator ?) as stall_code, group_concat(gb.stall_name separator ?) as stall_name, gb.bill_date, group_concat(gb.pick_ids separator ?) as pick_ids, gb.retailer_id, group_concat(gb.tattoo_code separator ?) as tattoo_code, sum(gb.purchase_count) as purchase_count, sum(gb.dead_pig_count) as dead_pig_count, group_concat(gb.retailer_name separator ?) as retailer_name, max(gb.retailer_location) as retailer_location, group_concat(gb.contact_phone separator ?) as contact_phone, group_concat(gb.market_name separator ?) as market_name, group_concat(gb.print_status separator ?) as print_status, sum(gb.print_count) as print_count, max(gb.print_time) as print_time, max(gb.retailer_mark) as retailer_mark from ( ( select concat(rg.recognize_ids, ?, ifnull(mn.recognize_ids, ?)) as recognize_ids, concat(rg.trade_ids, ?, ifnull(mn.trade_ids, ?)) as trade_ids, rg.stall_id, rg.stall_code, rg.stall_name, rg.bill_date, rg.status, rg.pick_ids, rg.retailer_id, rg.tattoo_code, if(rg.lay_count ? rg.hang_count ? if(mn.stall_id is ?, ?, mn.lay_count ? mn.hang_count) >= ?, rg.lay_count ? rg.hang_count ? if(mn.stall_id is ?, ?, mn.lay_count ? mn.hang_count), ?) as purchase_count, rg.lay_count, rg.hang_count, rg.dead_pig_count, rg.retailer_name, rg.retailer_location, rg.contact_phone, rg.market_name, rg.print_status, if(rg.print_count ? if(mn.stall_id is ?, ?, mn.print_count) >= ?, rg.print_count ? if(mn.stall_id is ?, ?, mn.print_count), ?) as print_count, rg.print_time, rg.retailer_mark from ( select group_concat(pr.recognize_id separator ?) as recognize_ids, group_concat(pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(pr.stall_code separator ?) as stall_code, group_concat(pr.stall_name separator ?) as stall_name, pr.pick_date as bill_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, group_concat(pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(( ? ), ?) as dead_pig_count, group_concat(ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, group_concat(ri.contact_phone separator ?) as contact_phone, group_concat(mp.market_name separator ?) as market_name, group_concat(bp.print_status separator ?) as print_status, sum(if(bp.print_status = ?, ifnull(pp.lay_count, ?) ? ifnull(pp.hang_count, ?), ?)) as print_count, max(bp.print_time) as print_time, max(ri.retailer_mark) as retailer_mark from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_market_place mp on ri.market_id = mp.market_id left join t_bill_print bp on pp.pick_id = bp.pick_id and bp.is_delete = ? where pr.pick_date >= ? and pr.pick_date <= ? and pr.stall_id = ? and pr.status = ? and pr.is_delete = ? and pp.retailer_id > ? and pp.is_delete = ? group by pr.pick_date, pr.stall_id, pp.retailer_id ) rg left join ( select group_concat(pr.recognize_id separator ?) as recognize_ids, group_concat(pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(pr.stall_code separator ?) as stall_code, group_concat(pr.stall_name separator ?) as stall_name, pr.pick_date as bill_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, group_concat(pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(( ? ), ?) as dead_pig_count, group_concat(ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, group_concat(ri.contact_phone separator ?) as contact_phone, group_concat(mp.market_name separator ?) as market_name, group_concat(bp.print_status separator ?) as print_status, sum(if(bp.print_status = ?, ifnull(pp.lay_count, ?) ? ifnull(pp.hang_count, ?), ?)) as print_count, max(bp.print_time) as print_time, max(ri.retailer_mark) as retailer_mark from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_market_place mp on ri.market_id = mp.market_id left join t_bill_print bp on pp.pick_id = bp.pick_id and bp.is_delete = ? where pr.pick_date >= ? and pr.pick_date <= ? and pr.stall_id = ? and pr.status = ? and pr.is_delete = ? and pp.retailer_id > ? and pp.is_delete = ? group by pr.pick_date, pr.stall_id, pp.retailer_id ) mn on rg.bill_date =","histograms":{"Query_time":[0,0,0,0,0,0,2,30]},"metrics":{"Lock_time":{"avg":"0.000018","max":"0.000079","median":"0.000014","min":"0.000007","pct":"0.030189","pct_95":"0.000032","stddev":"0.000013","sum":"0.000560"},"Query_length":{"avg":"10135","max":"10136","median":"10031","min":"10133","pct":"0","pct_95":"10031","stddev":"0","sum":"324337"},"Query_time":{"avg":"12.629965","max":"16.220180","median":"13.170567","min":"2.447862","pct":"0.030189","pct_95":"14.520551","stddev":"2.918013","sum":"404.158880"},"Rows_examined":{"avg":"52","max":"117","median":"49","min":"5","pct":"0","pct_95":"107","stddev":"26","sum":"1677"},"Rows_sent":{"avg":"1","max":"1","median":"1","min":"1","pct":"0","pct_95":"1","stddev":"0","sum":"32"},"db":{"value":"pz_wsnh_prod"},"host":{"value":"192.168.5.243"},"user":{"value":"pz_wsnh"}},"query_count":32,"tables":[{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pick_recognize`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pick_recognize'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pig_pick`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pig_pick'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_market_place`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_market_place'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_bill_print`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_bill_print'\\G"}],"ts_max":"2025-01-03T04:47:34","ts_min":"2025-01-03T02:14:28"},{"attribute":"fingerprint","checksum":"12A215D85416EF9325D3AB675956BD25","distillate":"SELECT UNION t_pick_recognize t_pig_pick t_retailer_info t_market_place t_bill_print t_pick_recognize t_pig_pick t_retailer_info t_market_place t_bill_print t_pick_recognize t_pig_pick t_retailer_info t_market_place t_bill_print","example":{"Query_time":"13.806294","query":"SELECT GROUP_CONCAT(gb.recognize_ids SEPARATOR '+') AS recognize_ids,\n            GROUP_CONCAT(gb.trade_ids SEPARATOR '+') AS trade_ids,\n            GROUP_CONCAT(gb.stall_id SEPARATOR ',') AS stall_ids,\n            GROUP_CONCAT(gb.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(gb.stall_name SEPARATOR ',') AS stall_name,\n            gb.bill_date,\n            GROUP_CONCAT(gb.pick_ids SEPARATOR ',') AS pick_ids,\n            gb.retailer_id,\n            GROUP_CONCAT(gb.tattoo_code SEPARATOR ',') AS tattoo_code,\n            SUM(gb.purchase_count) AS purchase_count,\n            SUM(gb.dead_pig_count) AS dead_pig_count,\n            GROUP_CONCAT(gb.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(gb.retailer_location) AS retailer_location,\n            GROUP_CONCAT(gb.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(gb.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(gb.print_status SEPARATOR ',') AS print_status,\n            SUM(gb.print_count) AS print_count,\n            MAX(gb.print_time) AS print_time,\n            MAX(gb.retailer_mark) AS retailer_mark\n        FROM (\n            (\n                 \n        SELECT CONCAT(rg.recognize_ids, '|', IFNULL(mn.recognize_ids, '')) AS recognize_ids,\n            CONCAT(rg.trade_ids, '|', IFNULL(mn.trade_ids, '')) AS trade_ids,\n            rg.stall_id,\n            rg.stall_code,\n            rg.stall_name,\n            rg.bill_date,\n            rg.status,\n            rg.pick_ids,\n            rg.retailer_id,\n            rg.tattoo_code,\n            IF(rg.lay_count + rg.hang_count - IF(mn.stall_id IS NULL, 0, mn.lay_count + mn.hang_count) >= 0,\n                rg.lay_count + rg.hang_count - IF(mn.stall_id IS NULL, 0, mn.lay_count + mn.hang_count), 0) AS purchase_count,\n            rg.lay_count,\n            rg.hang_count,\n            rg.dead_pig_count,\n            \n            rg.retailer_name,\n            rg.retailer_location,\n            rg.contact_phone,\n            rg.market_name,\n            rg.print_status,\n            IF(rg.print_count - IF(mn.stall_id IS NULL, 0, mn.print_count) >= 0,\n                rg.print_count - IF(mn.stall_id IS NULL, 0, mn.print_count), 0) AS print_count,\n            rg.print_time,\n            rg.retailer_mark\n        FROM (\n             \n        SELECT GROUP_CONCAT(pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date AS bill_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            GROUP_CONCAT(pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL((\n                    \n                    0\n            ), 0) AS dead_pig_count,\n            GROUP_CONCAT(ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            GROUP_CONCAT(ri.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(mp.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(bp.print_status SEPARATOR ',') AS print_status,\n            SUM(IF(bp.print_status = '1', IFNULL(pp.lay_count, 0) + IFNULL(pp.hang_count, 0), 0)) AS print_count,\n            MAX(bp.print_time) AS print_time,\n            MAX(ri.retailer_mark) AS retailer_mark\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n            LEFT JOIN t_bill_print bp ON pp.pick_id = bp.pick_id AND bp.is_delete = 0\n         WHERE  pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            AND pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n            AND pr.stall_id = 8\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.status = 'submitted' AND pr.is_delete = 0\n        AND pp.retailer_id > 0 AND pp.is_delete = 0 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id\n     \n        ) rg LEFT JOIN (\n             \n        SELECT GROUP_CONCAT(pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date AS bill_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            GROUP_CONCAT(pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL((\n                    \n                    0\n            ), 0) AS dead_pig_count,\n            GROUP_CONCAT(ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            GROUP_CONCAT(ri.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(mp.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(bp.print_status SEPARATOR ',') AS print_status,\n            SUM(IF(bp.print_status = '1', IFNULL(pp.lay_count, 0) + IFNULL(pp.hang_count, 0), 0)) AS print_count,\n            MAX(bp.print_time) AS print_time,\n            MAX(ri.retailer_mark) AS retailer_mark\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n            LEFT JOIN t_bill_print bp ON pp.pick_id = bp.pick_id AND bp.is_delete = 0\n         WHERE  pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            AND pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n            AND pr.stall_id = 8\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.status = 'morningpick' AND pr.is_delete = 0\n        AND pp.retailer_id > 0 AND pp.is_delete = 0 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id\n     \n        ) mn ON rg.bill_date = mn.bill_date AND rg.stall_id = mn.stall_id AND rg.retailer_id = mn.retailer_id\n        HAVING purchase_count != 0 OR print_count != 0\n     \n            ) UNION (\n                 \n        SELECT CONCAT('|', mn2.recognize_ids) AS recognize_ids,\n            CONCAT('|', mn2.trade_ids) AS trade_ids,\n            mn2.stall_id,\n            mn2.stall_code,\n            mn2.stall_name,\n            mn2.bill_date,\n            mn2.status,\n            mn2.pick_ids,\n            mn2.retailer_id,\n            mn2.tattoo_code,\n            mn2.lay_count + mn2.hang_count AS purchase_count,\n            mn2.lay_count,\n            mn2.hang_count,\n            mn2.dead_pig_count,\n            \n            mn2.retailer_name,\n            mn2.retailer_location,\n            mn2.contact_phone,\n            mn2.market_name,\n            mn2.print_status,\n            mn2.print_count,\n            mn2.print_time,\n            mn2.retailer_mark\n        FROM (\n             \n        SELECT GROUP_CONCAT(pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date AS bill_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            GROUP_CONCAT(pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL((\n                    \n                    0\n            ), 0) AS dead_pig_count,\n            GROUP_CONCAT(ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            GROUP_CONCAT(ri.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(mp.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(bp.print_status SEPARATOR ',') AS print_status,\n            SUM(IF(bp.print_status = '1', IFNULL(pp.lay_count, 0) + IFNULL(pp.hang_count, 0), 0)) AS print_count,\n            MAX(bp.print_time) AS print_time,\n            MAX(ri.retailer_mark) AS retailer_mark\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n            LEFT JOIN t_bill_print bp ON pp.pick_id = bp.pick_id AND bp.is_delete = 0\n         WHERE  pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            AND pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n            AND pr.stall_id = 8\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.status = 'morningpick' AND pr.is_delete = 0\n        AND pp.retailer_id > 0 AND pp.is_delete = 0 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id\n     \n        ) mn2\n     \n            )\n        ) gb\n        GROUP BY gb.bill_date, gb.retailer_id\n     \n        ORDER BY bill_date DESC, tattoo_code ASC\n LIMIT 100","ts":"2025-01-03T04:47:33"},"fingerprint":"select group_concat(gb.recognize_ids separator ?) as recognize_ids, group_concat(gb.trade_ids separator ?) as trade_ids, group_concat(gb.stall_id separator ?) as stall_ids, group_concat(gb.stall_code separator ?) as stall_code, group_concat(gb.stall_name separator ?) as stall_name, gb.bill_date, group_concat(gb.pick_ids separator ?) as pick_ids, gb.retailer_id, group_concat(gb.tattoo_code separator ?) as tattoo_code, sum(gb.purchase_count) as purchase_count, sum(gb.dead_pig_count) as dead_pig_count, group_concat(gb.retailer_name separator ?) as retailer_name, max(gb.retailer_location) as retailer_location, group_concat(gb.contact_phone separator ?) as contact_phone, group_concat(gb.market_name separator ?) as market_name, group_concat(gb.print_status separator ?) as print_status, sum(gb.print_count) as print_count, max(gb.print_time) as print_time, max(gb.retailer_mark) as retailer_mark from ( ( select concat(rg.recognize_ids, ?, ifnull(mn.recognize_ids, ?)) as recognize_ids, concat(rg.trade_ids, ?, ifnull(mn.trade_ids, ?)) as trade_ids, rg.stall_id, rg.stall_code, rg.stall_name, rg.bill_date, rg.status, rg.pick_ids, rg.retailer_id, rg.tattoo_code, if(rg.lay_count ? rg.hang_count ? if(mn.stall_id is ?, ?, mn.lay_count ? mn.hang_count) >= ?, rg.lay_count ? rg.hang_count ? if(mn.stall_id is ?, ?, mn.lay_count ? mn.hang_count), ?) as purchase_count, rg.lay_count, rg.hang_count, rg.dead_pig_count, rg.retailer_name, rg.retailer_location, rg.contact_phone, rg.market_name, rg.print_status, if(rg.print_count ? if(mn.stall_id is ?, ?, mn.print_count) >= ?, rg.print_count ? if(mn.stall_id is ?, ?, mn.print_count), ?) as print_count, rg.print_time, rg.retailer_mark from ( select group_concat(pr.recognize_id separator ?) as recognize_ids, group_concat(pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(pr.stall_code separator ?) as stall_code, group_concat(pr.stall_name separator ?) as stall_name, pr.pick_date as bill_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, group_concat(pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(( ? ), ?) as dead_pig_count, group_concat(ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, group_concat(ri.contact_phone separator ?) as contact_phone, group_concat(mp.market_name separator ?) as market_name, group_concat(bp.print_status separator ?) as print_status, sum(if(bp.print_status = ?, ifnull(pp.lay_count, ?) ? ifnull(pp.hang_count, ?), ?)) as print_count, max(bp.print_time) as print_time, max(ri.retailer_mark) as retailer_mark from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_market_place mp on ri.market_id = mp.market_id left join t_bill_print bp on pp.pick_id = bp.pick_id and bp.is_delete = ? where pr.pick_date >= ? and pr.pick_date <= ? and pr.stall_id = ? and pr.status = ? and pr.is_delete = ? and pp.retailer_id > ? and pp.is_delete = ? group by pr.pick_date, pr.stall_id, pp.retailer_id ) rg left join ( select group_concat(pr.recognize_id separator ?) as recognize_ids, group_concat(pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(pr.stall_code separator ?) as stall_code, group_concat(pr.stall_name separator ?) as stall_name, pr.pick_date as bill_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, group_concat(pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(( ? ), ?) as dead_pig_count, group_concat(ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, group_concat(ri.contact_phone separator ?) as contact_phone, group_concat(mp.market_name separator ?) as market_name, group_concat(bp.print_status separator ?) as print_status, sum(if(bp.print_status = ?, ifnull(pp.lay_count, ?) ? ifnull(pp.hang_count, ?), ?)) as print_count, max(bp.print_time) as print_time, max(ri.retailer_mark) as retailer_mark from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_market_place mp on ri.market_id = mp.market_id left join t_bill_print bp on pp.pick_id = bp.pick_id and bp.is_delete = ? where pr.pick_date >= ? and pr.pick_date <= ? and pr.stall_id = ? and pr.status = ? and pr.is_delete = ? and pp.retailer_id > ? and pp.is_delete = ? group by pr.pick_date, pr.stall_id, pp.retailer_id ) mn on rg.bill_date = mn.bill_date and rg.stall_id = mn.stall_id and rg.retailer_id = mn.retailer_id having purchase_count != ? or print_count != ? ) union ( select concat(?, mn?recognize_ids) as recognize_ids, concat(?, mn?trade_ids) as trade_ids, mn?stall_id, mn?stall_cod","histograms":{"Query_time":[0,0,0,0,0,0,13,24]},"metrics":{"Lock_time":{"avg":"0.000012","max":"0.000038","median":"0.000008","min":"0.000006","pct":"0.034906","pct_95":"0.000029","stddev":"0.000007","sum":"0.000433"},"Query_length":{"avg":"9871","max":"9872","median":"9553","min":"9869","pct":"0","pct_95":"9553","stddev":"0","sum":"365243"},"Query_time":{"avg":"10.580418","max":"13.806294","median":"10.319484","min":"2.022361","pct":"0.034906","pct_95":"13.170567","stddev":"2.211208","sum":"391.475456"},"Rows_examined":{"avg":"158","max":"344","median":"118","min":"15","pct":"0","pct_95":"329","stddev":"80","sum":"5853"},"Rows_sent":{"avg":"49","max":"100","median":"38","min":"5","pct":"0","pct_95":"97","stddev":"23","sum":"1835"},"db":{"value":"pz_wsnh_prod"},"host":{"value":"192.168.5.243"},"user":{"value":"pz_wsnh"}},"query_count":37,"tables":[{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pick_recognize`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pick_recognize'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pig_pick`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pig_pick'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_market_place`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_market_place'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_bill_print`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_bill_print'\\G"}],"ts_max":"2025-01-03T04:47:39","ts_min":"2025-01-03T02:14:35"},{"attribute":"fingerprint","checksum":"1FE8F6D1D512D3A2EB818529480A2440","distillate":"SELECT UNION t_pick_recognize t_pig_pick t_retailer_info t_market_place t_bill_print t_pick_recognize t_pig_pick t_retailer_info t_market_place t_bill_print t_pick_recognize t_pig_pick t_retailer_info t_market_place t_bill_print","example":{"Query_time":"15.651954","query":"select count(0) from ( \nSELECT GROUP_CONCAT(gb.recognize_ids SEPARATOR '+') AS recognize_ids,\n            GROUP_CONCAT(gb.trade_ids SEPARATOR '+') AS trade_ids,\n            GROUP_CONCAT(gb.stall_id SEPARATOR ',') AS stall_ids,\n            GROUP_CONCAT(gb.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(gb.stall_name SEPARATOR ',') AS stall_name,\n            gb.bill_date,\n            GROUP_CONCAT(gb.pick_ids SEPARATOR ',') AS pick_ids,\n            gb.retailer_id,\n            GROUP_CONCAT(gb.tattoo_code SEPARATOR ',') AS tattoo_code,\n            SUM(gb.purchase_count) AS purchase_count,\n            SUM(gb.dead_pig_count) AS dead_pig_count,\n            GROUP_CONCAT(gb.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(gb.retailer_location) AS retailer_location,\n            GROUP_CONCAT(gb.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(gb.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(gb.print_status SEPARATOR ',') AS print_status,\n            SUM(gb.print_count) AS print_count,\n            MAX(gb.print_time) AS print_time,\n            MAX(gb.retailer_mark) AS retailer_mark\n        FROM (\n            (\n                 \n        SELECT CONCAT(rg.recognize_ids, '|', IFNULL(mn.recognize_ids, '')) AS recognize_ids,\n            CONCAT(rg.trade_ids, '|', IFNULL(mn.trade_ids, '')) AS trade_ids,\n            rg.stall_id,\n            rg.stall_code,\n            rg.stall_name,\n            rg.bill_date,\n            rg.status,\n            rg.pick_ids,\n            rg.retailer_id,\n            rg.tattoo_code,\n            IF(rg.lay_count + rg.hang_count - IF(mn.stall_id IS NULL, 0, mn.lay_count + mn.hang_count) >= 0,\n                rg.lay_count + rg.hang_count - IF(mn.stall_id IS NULL, 0, mn.lay_count + mn.hang_count), 0) AS purchase_count,\n            rg.lay_count,\n            rg.hang_count,\n            rg.dead_pig_count,\n            \n            rg.retailer_name,\n            rg.retailer_location,\n            rg.contact_phone,\n            rg.market_name,\n            rg.print_status,\n            IF(rg.print_count - IF(mn.stall_id IS NULL, 0, mn.print_count) >= 0,\n                rg.print_count - IF(mn.stall_id IS NULL, 0, mn.print_count), 0) AS print_count,\n            rg.print_time,\n            rg.retailer_mark\n        FROM (\n             \n        SELECT GROUP_CONCAT(pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date AS bill_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            GROUP_CONCAT(pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL((\n                    \n                    0\n            ), 0) AS dead_pig_count,\n            GROUP_CONCAT(ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            GROUP_CONCAT(ri.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(mp.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(bp.print_status SEPARATOR ',') AS print_status,\n            SUM(IF(bp.print_status = '1', IFNULL(pp.lay_count, 0) + IFNULL(pp.hang_count, 0), 0)) AS print_count,\n            MAX(bp.print_time) AS print_time,\n            MAX(ri.retailer_mark) AS retailer_mark\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n            LEFT JOIN t_bill_print bp ON pp.pick_id = bp.pick_id AND bp.is_delete = 0\n         WHERE  pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            AND pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n            AND pr.stall_id = 20\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.status = 'submitted' AND pr.is_delete = 0\n        AND pp.retailer_id > 0 AND pp.is_delete = 0 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id\n     \n        ) rg LEFT JOIN (\n             \n        SELECT GROUP_CONCAT(pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date AS bill_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            GROUP_CONCAT(pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL((\n                    \n                    0\n            ), 0) AS dead_pig_count,\n            GROUP_CONCAT(ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            GROUP_CONCAT(ri.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(mp.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(bp.print_status SEPARATOR ',') AS print_status,\n            SUM(IF(bp.print_status = '1', IFNULL(pp.lay_count, 0) + IFNULL(pp.hang_count, 0), 0)) AS print_count,\n            MAX(bp.print_time) AS print_time,\n            MAX(ri.retailer_mark) AS retailer_mark\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n            LEFT JOIN t_bill_print bp ON pp.pick_id = bp.pick_id AND bp.is_delete = 0\n         WHERE  pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            AND pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n            AND pr.stall_id = 20\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.status = 'morningpick' AND pr.is_delete = 0\n        AND pp.retailer_id > 0 AND pp.is_delete = 0 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id\n     \n        ) mn ON rg.bill_date = mn.bill_date AND rg.stall_id = mn.stall_id AND rg.retailer_id = mn.retailer_id\n        HAVING purchase_count != 0 OR print_count != 0\n     \n            ) UNION (\n                 \n        SELECT CONCAT('|', mn2.recognize_ids) AS recognize_ids,\n            CONCAT('|', mn2.trade_ids) AS trade_ids,\n            mn2.stall_id,\n            mn2.stall_code,\n            mn2.stall_name,\n            mn2.bill_date,\n            mn2.status,\n            mn2.pick_ids,\n            mn2.retailer_id,\n            mn2.tattoo_code,\n            mn2.lay_count + mn2.hang_count AS purchase_count,\n            mn2.lay_count,\n            mn2.hang_count,\n            mn2.dead_pig_count,\n            \n            mn2.retailer_name,\n            mn2.retailer_location,\n            mn2.contact_phone,\n            mn2.market_name,\n            mn2.print_status,\n            mn2.print_count,\n            mn2.print_time,\n            mn2.retailer_mark\n        FROM (\n             \n        SELECT GROUP_CONCAT(pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date AS bill_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            GROUP_CONCAT(pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL((\n                    \n                    0\n            ), 0) AS dead_pig_count,\n            GROUP_CONCAT(ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            GROUP_CONCAT(ri.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(mp.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(bp.print_status SEPARATOR ',') AS print_status,\n            SUM(IF(bp.print_status = '1', IFNULL(pp.lay_count, 0) + IFNULL(pp.hang_count, 0), 0)) AS print_count,\n            MAX(bp.print_time) AS print_time,\n            MAX(ri.retailer_mark) AS retailer_mark\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n            LEFT JOIN t_bill_print bp ON pp.pick_id = bp.pick_id AND bp.is_delete = 0\n         WHERE  pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            AND pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n            AND pr.stall_id = 20\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.status = 'morningpick' AND pr.is_delete = 0\n        AND pp.retailer_id > 0 AND pp.is_delete = 0 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id\n     \n        ) mn2\n     \n            )\n        ) gb\n        GROUP BY gb.bill_date, gb.retailer_id\n     \n        ORDER BY bill_date DESC, tattoo_code ASC\n ) tmp_count","ts":"2025-01-03T02:23:01"},"fingerprint":"select count(?) from ( select group_concat(gb.recognize_ids separator ?) as recognize_ids, group_concat(gb.trade_ids separator ?) as trade_ids, group_concat(gb.stall_id separator ?) as stall_ids, group_concat(gb.stall_code separator ?) as stall_code, group_concat(gb.stall_name separator ?) as stall_name, gb.bill_date, group_concat(gb.pick_ids separator ?) as pick_ids, gb.retailer_id, group_concat(gb.tattoo_code separator ?) as tattoo_code, sum(gb.purchase_count) as purchase_count, sum(gb.dead_pig_count) as dead_pig_count, group_concat(gb.retailer_name separator ?) as retailer_name, max(gb.retailer_location) as retailer_location, group_concat(gb.contact_phone separator ?) as contact_phone, group_concat(gb.market_name separator ?) as market_name, group_concat(gb.print_status separator ?) as print_status, sum(gb.print_count) as print_count, max(gb.print_time) as print_time, max(gb.retailer_mark) as retailer_mark from ( ( select concat(rg.recognize_ids, ?, ifnull(mn.recognize_ids, ?)) as recognize_ids, concat(rg.trade_ids, ?, ifnull(mn.trade_ids, ?)) as trade_ids, rg.stall_id, rg.stall_code, rg.stall_name, rg.bill_date, rg.status, rg.pick_ids, rg.retailer_id, rg.tattoo_code, if(rg.lay_count ? rg.hang_count ? if(mn.stall_id is ?, ?, mn.lay_count ? mn.hang_count) >= ?, rg.lay_count ? rg.hang_count ? if(mn.stall_id is ?, ?, mn.lay_count ? mn.hang_count), ?) as purchase_count, rg.lay_count, rg.hang_count, rg.dead_pig_count, rg.retailer_name, rg.retailer_location, rg.contact_phone, rg.market_name, rg.print_status, if(rg.print_count ? if(mn.stall_id is ?, ?, mn.print_count) >= ?, rg.print_count ? if(mn.stall_id is ?, ?, mn.print_count), ?) as print_count, rg.print_time, rg.retailer_mark from ( select group_concat(pr.recognize_id separator ?) as recognize_ids, group_concat(pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(pr.stall_code separator ?) as stall_code, group_concat(pr.stall_name separator ?) as stall_name, pr.pick_date as bill_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, group_concat(pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(( ? ), ?) as dead_pig_count, group_concat(ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, group_concat(ri.contact_phone separator ?) as contact_phone, group_concat(mp.market_name separator ?) as market_name, group_concat(bp.print_status separator ?) as print_status, sum(if(bp.print_status = ?, ifnull(pp.lay_count, ?) ? ifnull(pp.hang_count, ?), ?)) as print_count, max(bp.print_time) as print_time, max(ri.retailer_mark) as retailer_mark from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_market_place mp on ri.market_id = mp.market_id left join t_bill_print bp on pp.pick_id = bp.pick_id and bp.is_delete = ? where pr.pick_date >= ? and pr.pick_date <= ? and pr.stall_id = ? and pr.status = ? and pr.is_delete = ? and pp.retailer_id > ? and pp.is_delete = ? group by pr.pick_date, pr.stall_id, pp.retailer_id ) rg left join ( select group_concat(pr.recognize_id separator ?) as recognize_ids, group_concat(pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(pr.stall_code separator ?) as stall_code, group_concat(pr.stall_name separator ?) as stall_name, pr.pick_date as bill_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, group_concat(pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(( ? ), ?) as dead_pig_count, group_concat(ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, group_concat(ri.contact_phone separator ?) as contact_phone, group_concat(mp.market_name separator ?) as market_name, group_concat(bp.print_status separator ?) as print_status, sum(if(bp.print_status = ?, ifnull(pp.lay_count, ?) ? ifnull(pp.hang_count, ?), ?)) as print_count, max(bp.print_time) as print_time, max(ri.retailer_mark) as retailer_mark from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_market_place mp on ri.market_id = mp.market_id left join t_bill_print bp on pp.pick_id = bp.pick_id and bp.is_delete = ? where pr.pick_date >= ? and pr.pick_date <= ? and pr.stall_id = ? and pr.status = ? and pr.is_delete = ? and pp.retailer_id > ? and pp.is_delete = ? group by pr.pick_date, pr.stall_id, pp.retailer_id ) mn on rg.bill_date = mn.bill_date and rg.stall_id = mn.stall_id and rg.retailer_id = mn.retailer_id having purchase_count != ? or print_count != ? ) union ( select concat(?, mn?recognize_ids) as recognize_ids, concat(?, mn?trade_ids) as trade_ids, mn","histograms":{"Query_time":[0,0,0,0,0,0,4,28]},"metrics":{"Lock_time":{"avg":"0.000019","max":"0.000052","median":"0.000014","min":"0.000009","pct":"0.030189","pct_95":"0.000039","stddev":"0.000011","sum":"0.000616"},"Query_length":{"avg":"9897","max":"9898","median":"9553","min":"9895","pct":"0","pct_95":"9553","stddev":"0","sum":"316721"},"Query_time":{"avg":"12.223351","max":"15.651954","median":"13.170567","min":"2.460768","pct":"0.030189","pct_95":"14.520551","stddev":"3.546574","sum":"391.147244"},"Rows_examined":{"avg":"52","max":"117","median":"49","min":"5","pct":"0","pct_95":"107","stddev":"26","sum":"1677"},"Rows_sent":{"avg":"1","max":"1","median":"1","min":"1","pct":"0","pct_95":"1","stddev":"0","sum":"32"},"db":{"value":"pz_wsnh_prod"},"host":{"value":"192.168.5.243"},"user":{"value":"pz_wsnh"}},"query_count":32,"tables":[{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pick_recognize`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pick_recognize'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pig_pick`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pig_pick'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_market_place`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_market_place'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_bill_print`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_bill_print'\\G"}],"ts_max":"2025-01-03T04:47:29","ts_min":"2025-01-03T02:14:28"},{"attribute":"fingerprint","checksum":"25FE54908DD41796F87A30B38FB67CD3","distillate":"UPDATE qrtz_SCHEDULER_STATE","example":{"Query_time":"357.098356","as_select":"select  LAST_CHECKIN_TIME = 1735916412787 from qrtz_SCHEDULER_STATE where  SCHED_NAME = 'ws_nh_portal_scheduler' AND INSTANCE_NAME = '03f1f0d6ba731735812640338'","query":"UPDATE qrtz_SCHEDULER_STATE SET LAST_CHECKIN_TIME = 1735916412787 WHERE SCHED_NAME = 'ws_nh_portal_scheduler' AND INSTANCE_NAME = '03f1f0d6ba731735812640338'","ts":"2025-01-03T15:06:09"},"fingerprint":"update qrtz_scheduler_state set last_checkin_time = ? where sched_name = ? and instance_name = ?","histograms":{"Query_time":[0,0,0,0,0,0,3,1]},"metrics":{"Lock_time":{"avg":"0.000004","max":"0.000007","median":"0.000005","min":"0.000002","pct":"0.003774","pct_95":"0.000007","stddev":"0.000002","sum":"0.000016"},"Query_length":{"avg":"157","max":"157","median":"157","min":"157","pct":"0","pct_95":"157","stddev":"0","sum":"628"},"Query_time":{"avg":"91.333691","max":"357.098356","median":"174.936292","min":"2.077822","pct":"0.003774","pct_95":"346.168483","stddev":"148.736119","sum":"365.334763"},"Rows_examined":{"avg":"1","max":"1","median":"1","min":"1","pct":"0","pct_95":"1","stddev":"0","sum":"4"},"Rows_sent":{"avg":"0","max":"0","median":"0","min":"0","pct":"0","pct_95":"0","stddev":"0","sum":"0"},"db":{"value":"wsnh_prod"},"host":{"value":"192.168.5.243"},"user":{"value":"wsnh"}},"query_count":4,"tables":[{"create":"SHOW CREATE TABLE `wsnh_prod`.`qrtz_SCHEDULER_STATE`\\G","status":"SHOW TABLE STATUS FROM `wsnh_prod` LIKE 'qrtz_SCHEDULER_STATE'\\G"}],"ts_max":"2025-01-03T15:07:15","ts_min":"2025-01-03T00:12:44"},{"attribute":"fingerprint","checksum":"0AEFBD46EC0CD9056D262D15FA13D225","distillate":"SELECT UNION t_pick_recognize t_pig_pick t_retailer_info t_market_place t_bill_print t_pick_recognize t_pig_pick t_retailer_info t_market_place t_bill_print t_pick_recognize t_pig_pick t_retailer_info t_market_place t_bill_print","example":{"Query_time":"9.607664","query":"SELECT GROUP_CONCAT(pick_ids SEPARATOR ',') AS pick_ids,\n            SUM(purchase_count) AS purchase_count,\n            SUM(dead_pig_count) AS dead_pig_count,\n            SUM(IF(print_count > purchase_count, purchase_count, print_count)) AS print_count,\n            MAX(print_time) AS print_time\n        FROM ( \n        SELECT GROUP_CONCAT(gb.recognize_ids SEPARATOR '+') AS recognize_ids,\n            GROUP_CONCAT(gb.trade_ids SEPARATOR '+') AS trade_ids,\n            GROUP_CONCAT(gb.stall_id SEPARATOR ',') AS stall_ids,\n            GROUP_CONCAT(gb.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(gb.stall_name SEPARATOR ',') AS stall_name,\n            gb.bill_date,\n            GROUP_CONCAT(gb.pick_ids SEPARATOR ',') AS pick_ids,\n            gb.retailer_id,\n            GROUP_CONCAT(gb.tattoo_code SEPARATOR ',') AS tattoo_code,\n            SUM(gb.purchase_count) AS purchase_count,\n            SUM(gb.dead_pig_count) AS dead_pig_count,\n            GROUP_CONCAT(gb.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(gb.retailer_location) AS retailer_location,\n            GROUP_CONCAT(gb.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(gb.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(gb.print_status SEPARATOR ',') AS print_status,\n            SUM(gb.print_count) AS print_count,\n            MAX(gb.print_time) AS print_time,\n            MAX(gb.retailer_mark) AS retailer_mark\n        FROM (\n            (\n                 \n        SELECT CONCAT(rg.recognize_ids, '|', IFNULL(mn.recognize_ids, '')) AS recognize_ids,\n            CONCAT(rg.trade_ids, '|', IFNULL(mn.trade_ids, '')) AS trade_ids,\n            rg.stall_id,\n            rg.stall_code,\n            rg.stall_name,\n            rg.bill_date,\n            rg.status,\n            rg.pick_ids,\n            rg.retailer_id,\n            rg.tattoo_code,\n            IF(rg.lay_count + rg.hang_count - IF(mn.stall_id IS NULL, 0, mn.lay_count + mn.hang_count) >= 0,\n                rg.lay_count + rg.hang_count - IF(mn.stall_id IS NULL, 0, mn.lay_count + mn.hang_count), 0) AS purchase_count,\n            rg.lay_count,\n            rg.hang_count,\n            rg.dead_pig_count,\n            \n            rg.retailer_name,\n            rg.retailer_location,\n            rg.contact_phone,\n            rg.market_name,\n            rg.print_status,\n            IF(rg.print_count - IF(mn.stall_id IS NULL, 0, mn.print_count) >= 0,\n                rg.print_count - IF(mn.stall_id IS NULL, 0, mn.print_count), 0) AS print_count,\n            rg.print_time,\n            rg.retailer_mark\n        FROM (\n             \n        SELECT GROUP_CONCAT(pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date AS bill_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            GROUP_CONCAT(pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL((\n                    \n                    0\n            ), 0) AS dead_pig_count,\n            GROUP_CONCAT(ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            GROUP_CONCAT(ri.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(mp.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(bp.print_status SEPARATOR ',') AS print_status,\n            SUM(IF(bp.print_status = '1', IFNULL(pp.lay_count, 0) + IFNULL(pp.hang_count, 0), 0)) AS print_count,\n            MAX(bp.print_time) AS print_time,\n            MAX(ri.retailer_mark) AS retailer_mark\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n            LEFT JOIN t_bill_print bp ON pp.pick_id = bp.pick_id AND bp.is_delete = 0\n         WHERE  pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            AND pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n        \n        \n        \n            AND ri.retailer_mark = 0\n        \n        \n        \n        \n            AND pr.status IN\n            ('submitted')\n        \n        \n            AND IFNULL(bp.print_status, '0') = '0'\n        \n        \n        AND pr.status = 'submitted' AND pr.is_delete = 0\n        AND pp.retailer_id > 0 AND pp.is_delete = 0 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id\n     \n        ) rg LEFT JOIN (\n             \n        SELECT GROUP_CONCAT(pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date AS bill_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            GROUP_CONCAT(pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL((\n                    \n                    0\n            ), 0) AS dead_pig_count,\n            GROUP_CONCAT(ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            GROUP_CONCAT(ri.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(mp.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(bp.print_status SEPARATOR ',') AS print_status,\n            SUM(IF(bp.print_status = '1', IFNULL(pp.lay_count, 0) + IFNULL(pp.hang_count, 0), 0)) AS print_count,\n            MAX(bp.print_time) AS print_time,\n            MAX(ri.retailer_mark) AS retailer_mark\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n            LEFT JOIN t_bill_print bp ON pp.pick_id = bp.pick_id AND bp.is_delete = 0\n         WHERE  pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            AND pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n        \n        \n        \n            AND ri.retailer_mark = 0\n        \n        \n        \n        \n        \n        \n        AND pr.status = 'morningpick' AND pr.is_delete = 0\n        AND pp.retailer_id > 0 AND pp.is_delete = 0 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id\n     \n        ) mn ON rg.bill_date = mn.bill_date AND rg.stall_id = mn.stall_id AND rg.retailer_id = mn.retailer_id\n        HAVING purchase_count != 0 OR print_count != 0\n     \n            ) UNION (\n                 \n        SELECT CONCAT('|', mn2.recognize_ids) AS recognize_ids,\n            CONCAT('|', mn2.trade_ids) AS trade_ids,\n            mn2.stall_id,\n            mn2.stall_code,\n            mn2.stall_name,\n            mn2.bill_date,\n            mn2.status,\n            mn2.pick_ids,\n            mn2.retailer_id,\n            mn2.tattoo_code,\n            mn2.lay_count + mn2.hang_count AS purchase_count,\n            mn2.lay_count,\n            mn2.hang_count,\n            mn2.dead_pig_count,\n            \n            mn2.retailer_name,\n            mn2.retailer_location,\n            mn2.contact_phone,\n            mn2.market_name,\n            mn2.print_status,\n            mn2.print_count,\n            mn2.print_time,\n            mn2.retailer_mark\n        FROM (\n             \n        SELECT GROUP_CONCAT(pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date AS bill_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            GROUP_CONCAT(pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL((\n                    \n                    0\n            ), 0) AS dead_pig_count,\n            GROUP_CONCAT(ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            GROUP_CONCAT(ri.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(mp.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(bp.print_status SEPARATOR ',') AS print_status,\n            SUM(IF(bp.print_status = '1', IFNULL(pp.lay_count, 0) + IFNULL(pp.hang_count, 0), 0)) AS print_count,\n            MAX(bp.print_time) AS print_time,\n            MAX(ri.retailer_mark) AS retailer_mark\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n            LEFT JOIN t_bill_print bp ON pp.pick_id = bp.pick_id AND bp.is_delete = 0\n         WHERE  pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            AND pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n        \n        \n        \n            AND ri.retailer_mark = 0\n        \n        \n        \n        \n            AND pr.status","ts":"2025-01-03T06:08:17"},"fingerprint":"select group_concat(pick_ids separator ?) as pick_ids, sum(purchase_count) as purchase_count, sum(dead_pig_count) as dead_pig_count, sum(if(print_count > purchase_count, purchase_count, print_count)) as print_count, max(print_time) as print_time from ( select group_concat(gb.recognize_ids separator ?) as recognize_ids, group_concat(gb.trade_ids separator ?) as trade_ids, group_concat(gb.stall_id separator ?) as stall_ids, group_concat(gb.stall_code separator ?) as stall_code, group_concat(gb.stall_name separator ?) as stall_name, gb.bill_date, group_concat(gb.pick_ids separator ?) as pick_ids, gb.retailer_id, group_concat(gb.tattoo_code separator ?) as tattoo_code, sum(gb.purchase_count) as purchase_count, sum(gb.dead_pig_count) as dead_pig_count, group_concat(gb.retailer_name separator ?) as retailer_name, max(gb.retailer_location) as retailer_location, group_concat(gb.contact_phone separator ?) as contact_phone, group_concat(gb.market_name separator ?) as market_name, group_concat(gb.print_status separator ?) as print_status, sum(gb.print_count) as print_count, max(gb.print_time) as print_time, max(gb.retailer_mark) as retailer_mark from ( ( select concat(rg.recognize_ids, ?, ifnull(mn.recognize_ids, ?)) as recognize_ids, concat(rg.trade_ids, ?, ifnull(mn.trade_ids, ?)) as trade_ids, rg.stall_id, rg.stall_code, rg.stall_name, rg.bill_date, rg.status, rg.pick_ids, rg.retailer_id, rg.tattoo_code, if(rg.lay_count ? rg.hang_count ? if(mn.stall_id is ?, ?, mn.lay_count ? mn.hang_count) >= ?, rg.lay_count ? rg.hang_count ? if(mn.stall_id is ?, ?, mn.lay_count ? mn.hang_count), ?) as purchase_count, rg.lay_count, rg.hang_count, rg.dead_pig_count, rg.retailer_name, rg.retailer_location, rg.contact_phone, rg.market_name, rg.print_status, if(rg.print_count ? if(mn.stall_id is ?, ?, mn.print_count) >= ?, rg.print_count ? if(mn.stall_id is ?, ?, mn.print_count), ?) as print_count, rg.print_time, rg.retailer_mark from ( select group_concat(pr.recognize_id separator ?) as recognize_ids, group_concat(pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(pr.stall_code separator ?) as stall_code, group_concat(pr.stall_name separator ?) as stall_name, pr.pick_date as bill_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, group_concat(pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(( ? ), ?) as dead_pig_count, group_concat(ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, group_concat(ri.contact_phone separator ?) as contact_phone, group_concat(mp.market_name separator ?) as market_name, group_concat(bp.print_status separator ?) as print_status, sum(if(bp.print_status = ?, ifnull(pp.lay_count, ?) ? ifnull(pp.hang_count, ?), ?)) as print_count, max(bp.print_time) as print_time, max(ri.retailer_mark) as retailer_mark from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_market_place mp on ri.market_id = mp.market_id left join t_bill_print bp on pp.pick_id = bp.pick_id and bp.is_delete = ? where pr.pick_date >= ? and pr.pick_date <= ? and ri.retailer_mark = ? and pr.status in(?+) and ifnull(bp.print_status, ?) = ? and pr.status = ? and pr.is_delete = ? and pp.retailer_id > ? and pp.is_delete = ? group by pr.pick_date, pr.stall_id, pp.retailer_id ) rg left join ( select group_concat(pr.recognize_id separator ?) as recognize_ids, group_concat(pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(pr.stall_code separator ?) as stall_code, group_concat(pr.stall_name separator ?) as stall_name, pr.pick_date as bill_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, group_concat(pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(( ? ), ?) as dead_pig_count, group_concat(ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, group_concat(ri.contact_phone separator ?) as contact_phone, group_concat(mp.market_name separator ?) as market_name, group_concat(bp.print_status separator ?) as print_status, sum(if(bp.print_status = ?, ifnull(pp.lay_count, ?) ? ifnull(pp.hang_count, ?), ?)) as print_count, max(bp.print_time) as print_time, max(ri.retailer_mark) as retailer_mark from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_market_place mp on ri.market_id = mp.market_id left join t_bill_print bp on pp.pick_id = bp.pick_id and bp.is_delete = ? where pr.pick_date >= ? and pr.pick_date <= ? and ri.retailer_mark = ? and pr.status = ? and pr.is_delete = ? and pp.retailer_id > ? and pp.is_delete = ? group b","histograms":{"Query_time":[0,0,0,0,0,0,46,0]},"metrics":{"Lock_time":{"avg":"0.000019","max":"0.000079","median":"0.000015","min":"0.000007","pct":"0.043396","pct_95":"0.000037","stddev":"0.000013","sum":"0.000877"},"Query_length":{"avg":"10398","max":"10400","median":"10031","min":"10396","pct":"0","pct_95":"10031","stddev":"0","sum":"478316"},"Query_time":{"avg":"5.880083","max":"9.607664","median":"5.212041","min":"2.939219","pct":"0.043396","pct_95":"8.914358","stddev":"2.011602","sum":"270.483798"},"Rows_examined":{"avg":"57","max":"211","median":"19","min":"0","pct":"0","pct_95":"192","stddev":"69","sum":"2630"},"Rows_sent":{"avg":"1","max":"1","median":"1","min":"1","pct":"0","pct_95":"1","stddev":"0","sum":"46"},"db":{"value":"pz_wsnh_prod"},"host":{"value":"192.168.5.243"},"user":{"value":"pz_wsnh"}},"query_count":46,"tables":[{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pick_recognize`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pick_recognize'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pig_pick`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pig_pick'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_market_place`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_market_place'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_bill_print`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_bill_print'\\G"}],"ts_max":"2025-01-03T06:12:31","ts_min":"2025-01-03T02:10:07"},{"attribute":"fingerprint","checksum":"CDE7460F7A48F440740568BF8629F1BB","distillate":"SELECT UNION t_pick_recognize t_pig_pick t_retailer_info t_market_place t_bill_print t_pick_recognize t_pig_pick t_retailer_info t_market_place t_bill_print t_pick_recognize t_pig_pick t_retailer_info t_market_place t_bill_print","example":{"Query_time":"9.656520","query":"select count(0) from ( \nSELECT GROUP_CONCAT(gb.recognize_ids SEPARATOR '+') AS recognize_ids,\n            GROUP_CONCAT(gb.trade_ids SEPARATOR '+') AS trade_ids,\n            GROUP_CONCAT(gb.stall_id SEPARATOR ',') AS stall_ids,\n            GROUP_CONCAT(gb.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(gb.stall_name SEPARATOR ',') AS stall_name,\n            gb.bill_date,\n            GROUP_CONCAT(gb.pick_ids SEPARATOR ',') AS pick_ids,\n            gb.retailer_id,\n            GROUP_CONCAT(gb.tattoo_code SEPARATOR ',') AS tattoo_code,\n            SUM(gb.purchase_count) AS purchase_count,\n            SUM(gb.dead_pig_count) AS dead_pig_count,\n            GROUP_CONCAT(gb.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(gb.retailer_location) AS retailer_location,\n            GROUP_CONCAT(gb.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(gb.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(gb.print_status SEPARATOR ',') AS print_status,\n            SUM(gb.print_count) AS print_count,\n            MAX(gb.print_time) AS print_time,\n            MAX(gb.retailer_mark) AS retailer_mark\n        FROM (\n            (\n                 \n        SELECT CONCAT(rg.recognize_ids, '|', IFNULL(mn.recognize_ids, '')) AS recognize_ids,\n            CONCAT(rg.trade_ids, '|', IFNULL(mn.trade_ids, '')) AS trade_ids,\n            rg.stall_id,\n            rg.stall_code,\n            rg.stall_name,\n            rg.bill_date,\n            rg.status,\n            rg.pick_ids,\n            rg.retailer_id,\n            rg.tattoo_code,\n            IF(rg.lay_count + rg.hang_count - IF(mn.stall_id IS NULL, 0, mn.lay_count + mn.hang_count) >= 0,\n                rg.lay_count + rg.hang_count - IF(mn.stall_id IS NULL, 0, mn.lay_count + mn.hang_count), 0) AS purchase_count,\n            rg.lay_count,\n            rg.hang_count,\n            rg.dead_pig_count,\n            \n            rg.retailer_name,\n            rg.retailer_location,\n            rg.contact_phone,\n            rg.market_name,\n            rg.print_status,\n            IF(rg.print_count - IF(mn.stall_id IS NULL, 0, mn.print_count) >= 0,\n                rg.print_count - IF(mn.stall_id IS NULL, 0, mn.print_count), 0) AS print_count,\n            rg.print_time,\n            rg.retailer_mark\n        FROM (\n             \n        SELECT GROUP_CONCAT(pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date AS bill_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            GROUP_CONCAT(pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL((\n                    \n                    0\n            ), 0) AS dead_pig_count,\n            GROUP_CONCAT(ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            GROUP_CONCAT(ri.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(mp.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(bp.print_status SEPARATOR ',') AS print_status,\n            SUM(IF(bp.print_status = '1', IFNULL(pp.lay_count, 0) + IFNULL(pp.hang_count, 0), 0)) AS print_count,\n            MAX(bp.print_time) AS print_time,\n            MAX(ri.retailer_mark) AS retailer_mark\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n            LEFT JOIN t_bill_print bp ON pp.pick_id = bp.pick_id AND bp.is_delete = 0\n         WHERE  pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            AND pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n        \n        \n        \n            AND ri.retailer_mark = 0\n        \n        \n        \n        \n            AND pr.status IN\n            ('submitted')\n        \n        \n            AND IFNULL(bp.print_status, '0') = '0'\n        \n        \n        AND pr.status = 'submitted' AND pr.is_delete = 0\n        AND pp.retailer_id > 0 AND pp.is_delete = 0 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id\n     \n        ) rg LEFT JOIN (\n             \n        SELECT GROUP_CONCAT(pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date AS bill_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            GROUP_CONCAT(pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL((\n                    \n                    0\n            ), 0) AS dead_pig_count,\n            GROUP_CONCAT(ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            GROUP_CONCAT(ri.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(mp.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(bp.print_status SEPARATOR ',') AS print_status,\n            SUM(IF(bp.print_status = '1', IFNULL(pp.lay_count, 0) + IFNULL(pp.hang_count, 0), 0)) AS print_count,\n            MAX(bp.print_time) AS print_time,\n            MAX(ri.retailer_mark) AS retailer_mark\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n            LEFT JOIN t_bill_print bp ON pp.pick_id = bp.pick_id AND bp.is_delete = 0\n         WHERE  pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            AND pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n        \n        \n        \n            AND ri.retailer_mark = 0\n        \n        \n        \n        \n        \n        \n        AND pr.status = 'morningpick' AND pr.is_delete = 0\n        AND pp.retailer_id > 0 AND pp.is_delete = 0 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id\n     \n        ) mn ON rg.bill_date = mn.bill_date AND rg.stall_id = mn.stall_id AND rg.retailer_id = mn.retailer_id\n        HAVING purchase_count != 0 OR print_count != 0\n     \n            ) UNION (\n                 \n        SELECT CONCAT('|', mn2.recognize_ids) AS recognize_ids,\n            CONCAT('|', mn2.trade_ids) AS trade_ids,\n            mn2.stall_id,\n            mn2.stall_code,\n            mn2.stall_name,\n            mn2.bill_date,\n            mn2.status,\n            mn2.pick_ids,\n            mn2.retailer_id,\n            mn2.tattoo_code,\n            mn2.lay_count + mn2.hang_count AS purchase_count,\n            mn2.lay_count,\n            mn2.hang_count,\n            mn2.dead_pig_count,\n            \n            mn2.retailer_name,\n            mn2.retailer_location,\n            mn2.contact_phone,\n            mn2.market_name,\n            mn2.print_status,\n            mn2.print_count,\n            mn2.print_time,\n            mn2.retailer_mark\n        FROM (\n             \n        SELECT GROUP_CONCAT(pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date AS bill_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            GROUP_CONCAT(pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL((\n                    \n                    0\n            ), 0) AS dead_pig_count,\n            GROUP_CONCAT(ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            GROUP_CONCAT(ri.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(mp.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(bp.print_status SEPARATOR ',') AS print_status,\n            SUM(IF(bp.print_status = '1', IFNULL(pp.lay_count, 0) + IFNULL(pp.hang_count, 0), 0)) AS print_count,\n            MAX(bp.print_time) AS print_time,\n            MAX(ri.retailer_mark) AS retailer_mark\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n            LEFT JOIN t_bill_print bp ON pp.pick_id = bp.pick_id AND bp.is_delete = 0\n         WHERE  pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            AND pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n        \n        \n        \n            AND ri.retailer_mark = 0\n        \n        \n        \n        \n            AND pr.status IN\n            ('submitted')\n        \n        \n            AND IFNULL(bp.print_status, '0') = '0'\n        \n        \n        AND pr.status = 'morningpick' AND pr.is_delete = 0\n        AND pp.retailer_id > 0 AND pp.is_delete = 0 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id\n     \n  ","ts":"2025-01-03T06:08:17"},"fingerprint":"select count(?) from ( select group_concat(gb.recognize_ids separator ?) as recognize_ids, group_concat(gb.trade_ids separator ?) as trade_ids, group_concat(gb.stall_id separator ?) as stall_ids, group_concat(gb.stall_code separator ?) as stall_code, group_concat(gb.stall_name separator ?) as stall_name, gb.bill_date, group_concat(gb.pick_ids separator ?) as pick_ids, gb.retailer_id, group_concat(gb.tattoo_code separator ?) as tattoo_code, sum(gb.purchase_count) as purchase_count, sum(gb.dead_pig_count) as dead_pig_count, group_concat(gb.retailer_name separator ?) as retailer_name, max(gb.retailer_location) as retailer_location, group_concat(gb.contact_phone separator ?) as contact_phone, group_concat(gb.market_name separator ?) as market_name, group_concat(gb.print_status separator ?) as print_status, sum(gb.print_count) as print_count, max(gb.print_time) as print_time, max(gb.retailer_mark) as retailer_mark from ( ( select concat(rg.recognize_ids, ?, ifnull(mn.recognize_ids, ?)) as recognize_ids, concat(rg.trade_ids, ?, ifnull(mn.trade_ids, ?)) as trade_ids, rg.stall_id, rg.stall_code, rg.stall_name, rg.bill_date, rg.status, rg.pick_ids, rg.retailer_id, rg.tattoo_code, if(rg.lay_count ? rg.hang_count ? if(mn.stall_id is ?, ?, mn.lay_count ? mn.hang_count) >= ?, rg.lay_count ? rg.hang_count ? if(mn.stall_id is ?, ?, mn.lay_count ? mn.hang_count), ?) as purchase_count, rg.lay_count, rg.hang_count, rg.dead_pig_count, rg.retailer_name, rg.retailer_location, rg.contact_phone, rg.market_name, rg.print_status, if(rg.print_count ? if(mn.stall_id is ?, ?, mn.print_count) >= ?, rg.print_count ? if(mn.stall_id is ?, ?, mn.print_count), ?) as print_count, rg.print_time, rg.retailer_mark from ( select group_concat(pr.recognize_id separator ?) as recognize_ids, group_concat(pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(pr.stall_code separator ?) as stall_code, group_concat(pr.stall_name separator ?) as stall_name, pr.pick_date as bill_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, group_concat(pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(( ? ), ?) as dead_pig_count, group_concat(ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, group_concat(ri.contact_phone separator ?) as contact_phone, group_concat(mp.market_name separator ?) as market_name, group_concat(bp.print_status separator ?) as print_status, sum(if(bp.print_status = ?, ifnull(pp.lay_count, ?) ? ifnull(pp.hang_count, ?), ?)) as print_count, max(bp.print_time) as print_time, max(ri.retailer_mark) as retailer_mark from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_market_place mp on ri.market_id = mp.market_id left join t_bill_print bp on pp.pick_id = bp.pick_id and bp.is_delete = ? where pr.pick_date >= ? and pr.pick_date <= ? and ri.retailer_mark = ? and pr.status in(?+) and ifnull(bp.print_status, ?) = ? and pr.status = ? and pr.is_delete = ? and pp.retailer_id > ? and pp.is_delete = ? group by pr.pick_date, pr.stall_id, pp.retailer_id ) rg left join ( select group_concat(pr.recognize_id separator ?) as recognize_ids, group_concat(pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(pr.stall_code separator ?) as stall_code, group_concat(pr.stall_name separator ?) as stall_name, pr.pick_date as bill_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, group_concat(pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(( ? ), ?) as dead_pig_count, group_concat(ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, group_concat(ri.contact_phone separator ?) as contact_phone, group_concat(mp.market_name separator ?) as market_name, group_concat(bp.print_status separator ?) as print_status, sum(if(bp.print_status = ?, ifnull(pp.lay_count, ?) ? ifnull(pp.hang_count, ?), ?)) as print_count, max(bp.print_time) as print_time, max(ri.retailer_mark) as retailer_mark from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_market_place mp on ri.market_id = mp.market_id left join t_bill_print bp on pp.pick_id = bp.pick_id and bp.is_delete = ? where pr.pick_date >= ? and pr.pick_date <= ? and ri.retailer_mark = ? and pr.status = ? and pr.is_delete = ? and pp.retailer_id > ? and pp.is_delete = ? group by pr.pick_date, pr.stall_id, pp.retailer_id ) mn on rg.bill_date = mn.bill_date and rg.stall_id = mn.stall_id and rg.retailer_id = mn.retailer_id having purchase_count != ? or print_count != ? ) union ( select concat(?, mn?recogni","histograms":{"Query_time":[0,0,0,0,0,0,46,0]},"metrics":{"Lock_time":{"avg":"0.000018","max":"0.000038","median":"0.000017","min":"0.000009","pct":"0.043396","pct_95":"0.000034","stddev":"0.000007","sum":"0.000842"},"Query_length":{"avg":"10160","max":"10162","median":"10031","min":"10158","pct":"0","pct_95":"10031","stddev":"0","sum":"467368"},"Query_time":{"avg":"5.850426","max":"9.656520","median":"4.727475","min":"3.047313","pct":"0.043396","pct_95":"8.914358","stddev":"2.008146","sum":"269.119618"},"Rows_examined":{"avg":"57","max":"211","median":"19","min":"0","pct":"0","pct_95":"192","stddev":"69","sum":"2630"},"Rows_sent":{"avg":"1","max":"1","median":"1","min":"1","pct":"0","pct_95":"1","stddev":"0","sum":"46"},"db":{"value":"pz_wsnh_prod"},"host":{"value":"192.168.5.243"},"user":{"value":"pz_wsnh"}},"query_count":46,"tables":[{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pick_recognize`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pick_recognize'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pig_pick`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pig_pick'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_market_place`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_market_place'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_bill_print`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_bill_print'\\G"}],"ts_max":"2025-01-03T06:12:31","ts_min":"2025-01-03T02:10:07"},{"attribute":"fingerprint","checksum":"8B55BF36C822BA98875299B9B2C88515","distillate":"SELECT UNION t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place","example":{"Query_time":"4.638089","query":"SELECT SUM(plan_count) AS plan_count,\n            SUM(lay_count) AS lay_count,\n            SUM(hang_count) AS hang_count,\n            SUM(morning_count) AS morning_count,\n            SUM(head_count) AS head_count,\n            SUM(whole_count) AS whole_count,\n            SUM(service_fee) AS service_fee,\n            SUM(pig_fee) AS pig_fee,\n            SUM(service_fee + pig_fee) AS total_fee,\n            Count(DISTINCT pick_date) AS total_days\n        FROM ( \n         \n\n        SELECT CONCAT(rg.recognize_ids, '|', IFNULL(mn.recognize_ids, '')) AS recognize_ids,\n            CONCAT(rg.trade_ids, '|', IFNULL(mn.trade_ids, '')) AS trade_ids,\n            rg.stall_id,\n            rg.stall_code,\n            rg.stall_name,\n            rg.pick_date,\n            CONCAT(rg.status, '|', IFNULL(mn.status, '')) AS status,\n            CONCAT(rg.pick_ids, '|', IFNULL(mn.pick_ids, '')) AS pick_ids,\n            rg.retailer_id,\n            rg.tattoo_code,\n            IF(mn.stall_id IS NULL OR rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count)\n                + IF(mn.stall_id IS NULL OR rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count)\n            AS plan_count,\n            IF(mn.stall_id IS NULL OR rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) AS lay_count,\n            IF(mn.stall_id IS NULL OR rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) AS hang_count,\n            IF(mn.stall_id IS NULL, rg.morning_count, mn.morning_count) AS morning_count,\n            rg.head_count,\n            rg.whole_count,\n            rg.service_fee,\n            rg.pick_time,\n            rg.claim_slaughter_time,\n            rg.owner_ids,\n            rg.owner_code,\n            rg.owner_name,\n            rg.owner_phone,\n            rg.company_name,\n            rg.retailer_name,\n            rg.retailer_location,\n            rg.location,\n            rg.contact_phone,\n            rg.market_id,\n            rg.pig_fee,\n            rg.service_fee + rg.pig_fee AS total_fee,\n            rg.order_no,\n            rg.pay_way,\n            rg.integral,\n            rg.distributor_id,\n            rg.distributor_name,\n            rg.distributor_phone,\n            mp.market_code,\n            mp.market_name,\n            rg.default_plan_time\n        FROM ( \n        SELECT GROUP_CONCAT(DISTINCT pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(DISTINCT pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(DISTINCT pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(DISTINCT pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            pp.order_no,\n            pp.pay_way,\n            GROUP_CONCAT(DISTINCT pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.plan_count), 0) AS plan_count,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL(SUM(pp.morning_count), 0) AS morning_count,\n            IFNULL(SUM(pp.head_count), 0) AS head_count,\n            IFNULL(SUM(pp.whole_count), 0) AS whole_count,\n            IFNULL(SUM(pp.service_fee), 0) AS service_fee,\n            MAX(pp.create_time) AS pick_time,\n            MAX(pp.claim_slaughter_time) AS claim_slaughter_time,\n            GROUP_CONCAT(DISTINCT st.owner_id SEPARATOR ',') AS owner_ids,\n            GROUP_CONCAT(DISTINCT st.owner_code SEPARATOR ',') AS owner_code,\n            GROUP_CONCAT(DISTINCT st.owner_name SEPARATOR ',') AS owner_name,\n            GROUP_CONCAT(DISTINCT st.owner_phone SEPARATOR ',') AS owner_phone,\n            GROUP_CONCAT(DISTINCT st.company_name SEPARATOR ',') AS company_name,\n            GROUP_CONCAT(DISTINCT ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            MAX(ri.location) AS location,\n            GROUP_CONCAT(DISTINCT ri.contact_phone SEPARATOR ',') AS contact_phone,\n            ri.market_id,\n            IFNULL(SUM(pp.pig_fee), 0) AS pig_fee,\n            rit.integral,\n            di.distributor_id,\n            di.distributor_name,\n            di.distributor_phone,\n            MAX(ri.default_plan_time) AS default_plan_time\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_slaughter_trade st ON pr.trade_id = st.trade_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_retailer_integral rit ON pp.retailer_id = rit.retailer_id\n            LEFT JOIN t_distributor_info di ON ri.distributor_id = di.distributor_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n         WHERE pr.status = 'submitted'\n            \n        \n        \n        \n            and pr.pick_date >= '2025-01-03 00:00:00'\n        \n        \n            and pr.pick_date <= '2025-01-03 00:00:00'\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.is_delete = 0\n        AND pp.is_delete = 0\n    \n            AND isnull(pp.relate_pick_id) = 1 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone\n     ) rg\n            LEFT JOIN ( \n        SELECT GROUP_CONCAT(DISTINCT pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(DISTINCT pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(DISTINCT pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(DISTINCT pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            pp.order_no,\n            pp.pay_way,\n            GROUP_CONCAT(DISTINCT pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.plan_count), 0) AS plan_count,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL(SUM(pp.morning_count), 0) AS morning_count,\n            IFNULL(SUM(pp.head_count), 0) AS head_count,\n            IFNULL(SUM(pp.whole_count), 0) AS whole_count,\n            IFNULL(SUM(pp.service_fee), 0) AS service_fee,\n            MAX(pp.create_time) AS pick_time,\n            MAX(pp.claim_slaughter_time) AS claim_slaughter_time,\n            GROUP_CONCAT(DISTINCT st.owner_id SEPARATOR ',') AS owner_ids,\n            GROUP_CONCAT(DISTINCT st.owner_code SEPARATOR ',') AS owner_code,\n            GROUP_CONCAT(DISTINCT st.owner_name SEPARATOR ',') AS owner_name,\n            GROUP_CONCAT(DISTINCT st.owner_phone SEPARATOR ',') AS owner_phone,\n            GROUP_CONCAT(DISTINCT st.company_name SEPARATOR ',') AS company_name,\n            GROUP_CONCAT(DISTINCT ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            MAX(ri.location) AS location,\n            GROUP_CONCAT(DISTINCT ri.contact_phone SEPARATOR ',') AS contact_phone,\n            ri.market_id,\n            IFNULL(SUM(pp.pig_fee), 0) AS pig_fee,\n            rit.integral,\n            di.distributor_id,\n            di.distributor_name,\n            di.distributor_phone,\n            MAX(ri.default_plan_time) AS default_plan_time\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_slaughter_trade st ON pr.trade_id = st.trade_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_retailer_integral rit ON pp.retailer_id = rit.retailer_id\n            LEFT JOIN t_distributor_info di ON ri.distributor_id = di.distributor_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n         WHERE pr.status = 'morningpick'\n            \n        \n        \n        \n            and pr.pick_date >= '2025-01-03 00:00:00'\n        \n        \n            and pr.pick_date <= '2025-01-03 00:00:00'\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.is_delete = 0\n        AND pp.is_delete = 0\n    \n            AND isnull(pp.relate_pick_id) = 1 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone\n     ) mn\n                ON rg.stall_id = mn.stall_id AND rg.pick_date = mn.pick_date AND rg.retailer_id = mn.retailer_id\n            LEFT JOIN t_market_place mp ON rg.market_id = mp.market_id\n        UNION (\n            SELECT CONCAT(IFNULL(rg2.recognize_ids, ''), '|', mn2.recognize_ids) AS recognize_ids,\n                CONCAT(IFNULL(rg2.trade_ids, ''), '|', mn2.trade_ids) AS trade_ids,\n                mn2.stall_id,\n                mn2.stall_code,\n                mn2.stall_name,\n                mn2.pick_date,\n                CONCAT(IFNULL(rg2.status, ''), '|', mn2.status) AS status,\n                CONCAT(IFNULL(rg2.pick_ids, ''), '|', mn2.pick_ids) AS pick_ids,\n                mn2.retailer_id,\n                mn2.tattoo_code,\n                mn2.plan_count,\n                mn2.lay_count,\n                mn2.hang_count,\n                mn2.morning_count,\n                mn2.head_count,\n                mn2.whole_count,\n                mn2.service_fee,\n                mn2.pick_time,\n                mn2.claim_slaughter_time,\n                mn2.owner_ids,\n                mn2.owner_code,\n                mn2.owner_name,\n                mn2.owner_phone,\n                mn2.company_name,\n                mn2.retailer_name,\n                mn2.retailer_location,\n    ","ts":"2025-01-03T06:11:43"},"fingerprint":"select sum(plan_count) as plan_count, sum(lay_count) as lay_count, sum(hang_count) as hang_count, sum(morning_count) as morning_count, sum(head_count) as head_count, sum(whole_count) as whole_count, sum(service_fee) as service_fee, sum(pig_fee) as pig_fee, sum(service_fee ? pig_fee) as total_fee, count(distinct pick_date) as total_days from ( select concat(rg.recognize_ids, ?, ifnull(mn.recognize_ids, ?)) as recognize_ids, concat(rg.trade_ids, ?, ifnull(mn.trade_ids, ?)) as trade_ids, rg.stall_id, rg.stall_code, rg.stall_name, rg.pick_date, concat(rg.status, ?, ifnull(mn.status, ?)) as status, concat(rg.pick_ids, ?, ifnull(mn.pick_ids, ?)) as pick_ids, rg.retailer_id, rg.tattoo_code, if(mn.stall_id is ? or rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) ? if(mn.stall_id is ? or rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) as plan_count, if(mn.stall_id is ? or rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) as lay_count, if(mn.stall_id is ? or rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) as hang_count, if(mn.stall_id is ?, rg.morning_count, mn.morning_count) as morning_count, rg.head_count, rg.whole_count, rg.service_fee, rg.pick_time, rg.claim_slaughter_time, rg.owner_ids, rg.owner_code, rg.owner_name, rg.owner_phone, rg.company_name, rg.retailer_name, rg.retailer_location, rg.location, rg.contact_phone, rg.market_id, rg.pig_fee, rg.service_fee ? rg.pig_fee as total_fee, rg.order_no, rg.pay_way, rg.integral, rg.distributor_id, rg.distributor_name, rg.distributor_phone, mp.market_code, mp.market_name, rg.default_plan_time from ( select group_concat(distinct pr.recognize_id separator ?) as recognize_ids, group_concat(distinct pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(distinct pr.stall_code separator ?) as stall_code, group_concat(distinct pr.stall_name separator ?) as stall_name, pr.pick_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, group_concat(distinct pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.plan_count), ?) as plan_count, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(sum(pp.morning_count), ?) as morning_count, ifnull(sum(pp.head_count), ?) as head_count, ifnull(sum(pp.whole_count), ?) as whole_count, ifnull(sum(pp.service_fee), ?) as service_fee, max(pp.create_time) as pick_time, max(pp.claim_slaughter_time) as claim_slaughter_time, group_concat(distinct st.owner_id separator ?) as owner_ids, group_concat(distinct st.owner_code separator ?) as owner_code, group_concat(distinct st.owner_name separator ?) as owner_name, group_concat(distinct st.owner_phone separator ?) as owner_phone, group_concat(distinct st.company_name separator ?) as company_name, group_concat(distinct ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, max(ri.location) as location, group_concat(distinct ri.contact_phone separator ?) as contact_phone, ri.market_id, ifnull(sum(pp.pig_fee), ?) as pig_fee, rit.integral, di.distributor_id, di.distributor_name, di.distributor_phone, max(ri.default_plan_time) as default_plan_time from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id left join t_slaughter_trade st on pr.trade_id = st.trade_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_retailer_integral rit on pp.retailer_id = rit.retailer_id left join t_distributor_info di on ri.distributor_id = di.distributor_id left join t_market_place mp on ri.market_id = mp.market_id where pr.status = ? and pr.pick_date >= ? and pr.pick_date <= ? and pr.is_delete = ? and pp.is_delete = ? and isnull(pp.relate_pick_id) = ? group by pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone ) rg left join ( select group_concat(distinct pr.recognize_id separator ?) as recognize_ids, group_concat(distinct pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(distinct pr.stall_code separator ?) as stall_code, group_concat(distinct pr.stall_name separator ?) as stall_name, pr.pick_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, group_concat(distinct pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.plan_count), ?) as plan_count, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(sum(pp.morning_count), ?) as morning_count, ifnull(sum(pp.head_count), ?) as head_count, ifnull(sum(pp.whole_count), ?) as whole_count, ifnull(sum(pp.service_fee), ?) as service_fee, max(pp.create_time) as pick_time, max(pp.claim_slaughter_time) as claim_slaughter_time, group_concat(distinct st.owner_id separator ?) as owner_ids, group_concat(distinct st.owner_code separator ?) as ","histograms":{"Query_time":[0,0,0,0,0,0,62,0]},"metrics":{"Lock_time":{"avg":"0.000028","max":"0.000060","median":"0.000025","min":"0.000013","pct":"0.058491","pct_95":"0.000043","stddev":"0.000009","sum":"0.001755"},"Query_length":{"avg":"17262","max":"17262","median":"17262","min":"17262","pct":"0","pct_95":"17262","stddev":"0","sum":"1070244"},"Query_time":{"avg":"4.237336","max":"4.638089","median":"4.287959","min":"3.240844","pct":"0.058491","pct_95":"4.502357","stddev":"0.359854","sum":"262.714839"},"Rows_examined":{"avg":"415","max":"742","median":"463","min":"9","pct":"0","pct_95":"719","stddev":"249","sum":"25770"},"Rows_sent":{"avg":"1","max":"1","median":"1","min":"1","pct":"0","pct_95":"1","stddev":"0","sum":"62"},"db":{"value":"pz_wsnh_prod"},"host":{"value":"192.168.5.243"},"user":{"value":"pz_wsnh"}},"query_count":62,"tables":[{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pick_recognize`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pick_recognize'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pig_pick`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pig_pick'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_slaughter_trade`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_slaughter_trade'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_integral`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_integral'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_distributor_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_distributor_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_market_place`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_market_place'\\G"}],"ts_max":"2025-01-03T06:12:36","ts_min":"2025-01-03T00:20:57"},{"attribute":"fingerprint","checksum":"42912BF65120B43DC00110474AEC3BAE","distillate":"SELECT UNION t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place","example":{"Query_time":"5.664115","query":"SELECT temp.*\n        FROM ( \n         \n\n        SELECT CONCAT(rg.recognize_ids, '|', IFNULL(mn.recognize_ids, '')) AS recognize_ids,\n            CONCAT(rg.trade_ids, '|', IFNULL(mn.trade_ids, '')) AS trade_ids,\n            rg.stall_id,\n            rg.stall_code,\n            rg.stall_name,\n            rg.pick_date,\n            CONCAT(rg.status, '|', IFNULL(mn.status, '')) AS status,\n            CONCAT(rg.pick_ids, '|', IFNULL(mn.pick_ids, '')) AS pick_ids,\n            rg.retailer_id,\n            rg.tattoo_code,\n            IF(mn.stall_id IS NULL OR rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count)\n                + IF(mn.stall_id IS NULL OR rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count)\n            AS plan_count,\n            IF(mn.stall_id IS NULL OR rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) AS lay_count,\n            IF(mn.stall_id IS NULL OR rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) AS hang_count,\n            IF(mn.stall_id IS NULL, rg.morning_count, mn.morning_count) AS morning_count,\n            rg.head_count,\n            rg.whole_count,\n            rg.service_fee,\n            rg.pick_time,\n            rg.claim_slaughter_time,\n            rg.owner_ids,\n            rg.owner_code,\n            rg.owner_name,\n            rg.owner_phone,\n            rg.company_name,\n            rg.retailer_name,\n            rg.retailer_location,\n            rg.location,\n            rg.contact_phone,\n            rg.market_id,\n            rg.pig_fee,\n            rg.service_fee + rg.pig_fee AS total_fee,\n            rg.order_no,\n            rg.pay_way,\n            rg.integral,\n            rg.distributor_id,\n            rg.distributor_name,\n            rg.distributor_phone,\n            mp.market_code,\n            mp.market_name,\n            rg.default_plan_time\n        FROM ( \n        SELECT GROUP_CONCAT(DISTINCT pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(DISTINCT pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(DISTINCT pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(DISTINCT pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            pp.order_no,\n            pp.pay_way,\n            GROUP_CONCAT(DISTINCT pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.plan_count), 0) AS plan_count,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL(SUM(pp.morning_count), 0) AS morning_count,\n            IFNULL(SUM(pp.head_count), 0) AS head_count,\n            IFNULL(SUM(pp.whole_count), 0) AS whole_count,\n            IFNULL(SUM(pp.service_fee), 0) AS service_fee,\n            MAX(pp.create_time) AS pick_time,\n            MAX(pp.claim_slaughter_time) AS claim_slaughter_time,\n            GROUP_CONCAT(DISTINCT st.owner_id SEPARATOR ',') AS owner_ids,\n            GROUP_CONCAT(DISTINCT st.owner_code SEPARATOR ',') AS owner_code,\n            GROUP_CONCAT(DISTINCT st.owner_name SEPARATOR ',') AS owner_name,\n            GROUP_CONCAT(DISTINCT st.owner_phone SEPARATOR ',') AS owner_phone,\n            GROUP_CONCAT(DISTINCT st.company_name SEPARATOR ',') AS company_name,\n            GROUP_CONCAT(DISTINCT ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            MAX(ri.location) AS location,\n            GROUP_CONCAT(DISTINCT ri.contact_phone SEPARATOR ',') AS contact_phone,\n            ri.market_id,\n            IFNULL(SUM(pp.pig_fee), 0) AS pig_fee,\n            rit.integral,\n            di.distributor_id,\n            di.distributor_name,\n            di.distributor_phone,\n            MAX(ri.default_plan_time) AS default_plan_time\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_slaughter_trade st ON pr.trade_id = st.trade_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_retailer_integral rit ON pp.retailer_id = rit.retailer_id\n            LEFT JOIN t_distributor_info di ON ri.distributor_id = di.distributor_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n         WHERE pr.status = 'submitted'\n            \n        \n            and pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            and pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.is_delete = 0\n        AND pp.is_delete = 0\n    \n            AND isnull(pp.relate_pick_id) = 1 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone\n     ) rg\n            LEFT JOIN ( \n        SELECT GROUP_CONCAT(DISTINCT pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(DISTINCT pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(DISTINCT pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(DISTINCT pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            pp.order_no,\n            pp.pay_way,\n            GROUP_CONCAT(DISTINCT pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.plan_count), 0) AS plan_count,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL(SUM(pp.morning_count), 0) AS morning_count,\n            IFNULL(SUM(pp.head_count), 0) AS head_count,\n            IFNULL(SUM(pp.whole_count), 0) AS whole_count,\n            IFNULL(SUM(pp.service_fee), 0) AS service_fee,\n            MAX(pp.create_time) AS pick_time,\n            MAX(pp.claim_slaughter_time) AS claim_slaughter_time,\n            GROUP_CONCAT(DISTINCT st.owner_id SEPARATOR ',') AS owner_ids,\n            GROUP_CONCAT(DISTINCT st.owner_code SEPARATOR ',') AS owner_code,\n            GROUP_CONCAT(DISTINCT st.owner_name SEPARATOR ',') AS owner_name,\n            GROUP_CONCAT(DISTINCT st.owner_phone SEPARATOR ',') AS owner_phone,\n            GROUP_CONCAT(DISTINCT st.company_name SEPARATOR ',') AS company_name,\n            GROUP_CONCAT(DISTINCT ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            MAX(ri.location) AS location,\n            GROUP_CONCAT(DISTINCT ri.contact_phone SEPARATOR ',') AS contact_phone,\n            ri.market_id,\n            IFNULL(SUM(pp.pig_fee), 0) AS pig_fee,\n            rit.integral,\n            di.distributor_id,\n            di.distributor_name,\n            di.distributor_phone,\n            MAX(ri.default_plan_time) AS default_plan_time\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_slaughter_trade st ON pr.trade_id = st.trade_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_retailer_integral rit ON pp.retailer_id = rit.retailer_id\n            LEFT JOIN t_distributor_info di ON ri.distributor_id = di.distributor_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n         WHERE pr.status = 'morningpick'\n            \n        \n            and pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            and pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.is_delete = 0\n        AND pp.is_delete = 0\n    \n            AND isnull(pp.relate_pick_id) = 1 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone\n     ) mn\n                ON rg.stall_id = mn.stall_id AND rg.pick_date = mn.pick_date AND rg.retailer_id = mn.retailer_id\n            LEFT JOIN t_market_place mp ON rg.market_id = mp.market_id\n        UNION (\n            SELECT CONCAT(IFNULL(rg2.recognize_ids, ''), '|', mn2.recognize_ids) AS recognize_ids,\n                CONCAT(IFNULL(rg2.trade_ids, ''), '|', mn2.trade_ids) AS trade_ids,\n                mn2.stall_id,\n                mn2.stall_code,\n                mn2.stall_name,\n                mn2.pick_date,\n                CONCAT(IFNULL(rg2.status, ''), '|', mn2.status) AS status,\n                CONCAT(IFNULL(rg2.pick_ids, ''), '|', mn2.pick_ids) AS pick_ids,\n                mn2.retailer_id,\n                mn2.tattoo_code,\n                mn2.plan_count,\n                mn2.lay_count,\n                mn2.hang_count,\n                mn2.morning_count,\n                mn2.head_count,\n                mn2.whole_count,\n                mn2.service_fee,\n                mn2.pick_time,\n                mn2.claim_slaughter_time,\n                mn2.owner_ids,\n                mn2.owner_code,\n                mn2.owner_name,\n                mn2.owner_phone,\n                mn2.company_name,\n                mn2.retailer_name,\n                mn2.retailer_location,\n                mn2.location,\n                mn2.contact_phone,\n                mn2.market_id,\n                mn2.pig_fee,\n                mn2.service_fee + mn2.pig_fee AS total_fee,\n                mn2.order_no,\n                mn2.pay_way,\n                mn2.integral,\n                mn2.distributor_id,\n                mn2.distributor_name,\n                mn2.distributor_phone,\n                mp.market_code,\n         ","ts":"2025-01-03T03:20:06"},"fingerprint":"select temp.* from ( select concat(rg.recognize_ids, ?, ifnull(mn.recognize_ids, ?)) as recognize_ids, concat(rg.trade_ids, ?, ifnull(mn.trade_ids, ?)) as trade_ids, rg.stall_id, rg.stall_code, rg.stall_name, rg.pick_date, concat(rg.status, ?, ifnull(mn.status, ?)) as status, concat(rg.pick_ids, ?, ifnull(mn.pick_ids, ?)) as pick_ids, rg.retailer_id, rg.tattoo_code, if(mn.stall_id is ? or rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) ? if(mn.stall_id is ? or rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) as plan_count, if(mn.stall_id is ? or rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) as lay_count, if(mn.stall_id is ? or rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) as hang_count, if(mn.stall_id is ?, rg.morning_count, mn.morning_count) as morning_count, rg.head_count, rg.whole_count, rg.service_fee, rg.pick_time, rg.claim_slaughter_time, rg.owner_ids, rg.owner_code, rg.owner_name, rg.owner_phone, rg.company_name, rg.retailer_name, rg.retailer_location, rg.location, rg.contact_phone, rg.market_id, rg.pig_fee, rg.service_fee ? rg.pig_fee as total_fee, rg.order_no, rg.pay_way, rg.integral, rg.distributor_id, rg.distributor_name, rg.distributor_phone, mp.market_code, mp.market_name, rg.default_plan_time from ( select group_concat(distinct pr.recognize_id separator ?) as recognize_ids, group_concat(distinct pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(distinct pr.stall_code separator ?) as stall_code, group_concat(distinct pr.stall_name separator ?) as stall_name, pr.pick_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, group_concat(distinct pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.plan_count), ?) as plan_count, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(sum(pp.morning_count), ?) as morning_count, ifnull(sum(pp.head_count), ?) as head_count, ifnull(sum(pp.whole_count), ?) as whole_count, ifnull(sum(pp.service_fee), ?) as service_fee, max(pp.create_time) as pick_time, max(pp.claim_slaughter_time) as claim_slaughter_time, group_concat(distinct st.owner_id separator ?) as owner_ids, group_concat(distinct st.owner_code separator ?) as owner_code, group_concat(distinct st.owner_name separator ?) as owner_name, group_concat(distinct st.owner_phone separator ?) as owner_phone, group_concat(distinct st.company_name separator ?) as company_name, group_concat(distinct ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, max(ri.location) as location, group_concat(distinct ri.contact_phone separator ?) as contact_phone, ri.market_id, ifnull(sum(pp.pig_fee), ?) as pig_fee, rit.integral, di.distributor_id, di.distributor_name, di.distributor_phone, max(ri.default_plan_time) as default_plan_time from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id left join t_slaughter_trade st on pr.trade_id = st.trade_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_retailer_integral rit on pp.retailer_id = rit.retailer_id left join t_distributor_info di on ri.distributor_id = di.distributor_id left join t_market_place mp on ri.market_id = mp.market_id where pr.status = ? and pr.pick_date >= ? and pr.pick_date <= ? and pr.is_delete = ? and pp.is_delete = ? and isnull(pp.relate_pick_id) = ? group by pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone ) rg left join ( select group_concat(distinct pr.recognize_id separator ?) as recognize_ids, group_concat(distinct pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(distinct pr.stall_code separator ?) as stall_code, group_concat(distinct pr.stall_name separator ?) as stall_name, pr.pick_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, group_concat(distinct pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.plan_count), ?) as plan_count, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(sum(pp.morning_count), ?) as morning_count, ifnull(sum(pp.head_count), ?) as head_count, ifnull(sum(pp.whole_count), ?) as whole_count, ifnull(sum(pp.service_fee), ?) as service_fee, max(pp.create_time) as pick_time, max(pp.claim_slaughter_time) as claim_slaughter_time, group_concat(distinct st.owner_id separator ?) as owner_ids, group_concat(distinct st.owner_code separator ?) as owner_code, group_concat(distinct st.owner_name separator ?) as owner_name, group_concat(distinct st.owner_phone separator ?) as owner_phone, group_concat(distinct st.company_name separator ?) as company_name, group_concat(distinct ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_locati","histograms":{"Query_time":[0,0,0,0,0,0,62,0]},"metrics":{"Lock_time":{"avg":"0.000023","max":"0.000038","median":"0.000022","min":"0.000011","pct":"0.058491","pct_95":"0.000029","stddev":"0.000005","sum":"0.001407"},"Query_length":{"avg":"16935","max":"16935","median":"16935","min":"16935","pct":"0","pct_95":"16935","stddev":"0","sum":"1049970"},"Query_time":{"avg":"4.222562","max":"5.664115","median":"4.287959","min":"3.178254","pct":"0.058491","pct_95":"4.287959","stddev":"0.401111","sum":"261.798835"},"Rows_examined":{"avg":"504","max":"842","median":"563","min":"18","pct":"0","pct_95":"833","stddev":"264","sum":"31280"},"Rows_sent":{"avg":"88","max":"100","median":"97","min":"9","pct":"0","pct_95":"97","stddev":"26","sum":"5510"},"db":{"value":"pz_wsnh_prod"},"host":{"value":"192.168.5.243"},"user":{"value":"pz_wsnh"}},"query_count":62,"tables":[{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pick_recognize`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pick_recognize'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pig_pick`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pig_pick'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_slaughter_trade`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_slaughter_trade'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_integral`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_integral'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_distributor_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_distributor_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_market_place`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_market_place'\\G"}],"ts_max":"2025-01-03T06:12:40","ts_min":"2025-01-03T00:21:00"},{"attribute":"fingerprint","checksum":"D09963AC73DD36195EACC48FC1C95770","distillate":"SELECT UNION t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place","example":{"Query_time":"4.623306","query":"SELECT count(0) FROM (SELECT CONCAT(rg.recognize_ids, '|', IFNULL(mn.recognize_ids, '')) AS recognize_ids, CONCAT(rg.trade_ids, '|', IFNULL(mn.trade_ids, '')) AS trade_ids, rg.stall_id, rg.stall_code, rg.stall_name, rg.pick_date, CONCAT(rg.status, '|', IFNULL(mn.status, '')) AS status, CONCAT(rg.pick_ids, '|', IFNULL(mn.pick_ids, '')) AS pick_ids, rg.retailer_id, rg.tattoo_code, IF(mn.stall_id IS NULL OR rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) + IF(mn.stall_id IS NULL OR rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) AS plan_count, IF(mn.stall_id IS NULL OR rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) AS lay_count, IF(mn.stall_id IS NULL OR rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) AS hang_count, IF(mn.stall_id IS NULL, rg.morning_count, mn.morning_count) AS morning_count, rg.head_count, rg.whole_count, rg.service_fee, rg.pick_time, rg.claim_slaughter_time, rg.owner_ids, rg.owner_code, rg.owner_name, rg.owner_phone, rg.company_name, rg.retailer_name, rg.retailer_location, rg.location, rg.contact_phone, rg.market_id, rg.pig_fee, rg.service_fee + rg.pig_fee AS total_fee, rg.order_no, rg.pay_way, rg.integral, rg.distributor_id, rg.distributor_name, rg.distributor_phone, mp.market_code, mp.market_name, rg.default_plan_time FROM (SELECT GROUP_CONCAT(DISTINCT pr.recognize_id SEPARATOR ',') AS recognize_ids, GROUP_CONCAT(DISTINCT pr.trade_id SEPARATOR ',') AS trade_ids, pr.stall_id, GROUP_CONCAT(DISTINCT pr.stall_code SEPARATOR ',') AS stall_code, GROUP_CONCAT(DISTINCT pr.stall_name SEPARATOR ',') AS stall_name, pr.pick_date, GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status, GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, GROUP_CONCAT(DISTINCT pp.tattoo_code SEPARATOR ',') AS tattoo_code, IFNULL(SUM(pp.plan_count), 0) AS plan_count, IFNULL(SUM(pp.lay_count), 0) AS lay_count, IFNULL(SUM(pp.hang_count), 0) AS hang_count, IFNULL(SUM(pp.morning_count), 0) AS morning_count, IFNULL(SUM(pp.head_count), 0) AS head_count, IFNULL(SUM(pp.whole_count), 0) AS whole_count, IFNULL(SUM(pp.service_fee), 0) AS service_fee, MAX(pp.create_time) AS pick_time, MAX(pp.claim_slaughter_time) AS claim_slaughter_time, GROUP_CONCAT(DISTINCT st.owner_id SEPARATOR ',') AS owner_ids, GROUP_CONCAT(DISTINCT st.owner_code SEPARATOR ',') AS owner_code, GROUP_CONCAT(DISTINCT st.owner_name SEPARATOR ',') AS owner_name, GROUP_CONCAT(DISTINCT st.owner_phone SEPARATOR ',') AS owner_phone, GROUP_CONCAT(DISTINCT st.company_name SEPARATOR ',') AS company_name, GROUP_CONCAT(DISTINCT ri.retailer_name SEPARATOR ',') AS retailer_name, MAX(ri.retailer_location) AS retailer_location, MAX(ri.location) AS location, GROUP_CONCAT(DISTINCT ri.contact_phone SEPARATOR ',') AS contact_phone, ri.market_id, IFNULL(SUM(pp.pig_fee), 0) AS pig_fee, rit.integral, di.distributor_id, di.distributor_name, di.distributor_phone, MAX(ri.default_plan_time) AS default_plan_time FROM t_pick_recognize pr JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id LEFT JOIN t_slaughter_trade st ON pr.trade_id = st.trade_id LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id LEFT JOIN t_retailer_integral rit ON pp.retailer_id = rit.retailer_id LEFT JOIN t_distributor_info di ON ri.distributor_id = di.distributor_id LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id WHERE pr.status = 'submitted' AND pr.pick_date >= '2025-01-02 16:00:00' AND pr.pick_date <= '2025-01-03 15:59:59.999' AND pr.is_delete = 0 AND pp.is_delete = 0 AND isnull(pp.relate_pick_id) = 1 GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone) rg LEFT JOIN (SELECT GROUP_CONCAT(DISTINCT pr.recognize_id SEPARATOR ',') AS recognize_ids, GROUP_CONCAT(DISTINCT pr.trade_id SEPARATOR ',') AS trade_ids, pr.stall_id, GROUP_CONCAT(DISTINCT pr.stall_code SEPARATOR ',') AS stall_code, GROUP_CONCAT(DISTINCT pr.stall_name SEPARATOR ',') AS stall_name, pr.pick_date, GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status, GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, GROUP_CONCAT(DISTINCT pp.tattoo_code SEPARATOR ',') AS tattoo_code, IFNULL(SUM(pp.plan_count), 0) AS plan_count, IFNULL(SUM(pp.lay_count), 0) AS lay_count, IFNULL(SUM(pp.hang_count), 0) AS hang_count, IFNULL(SUM(pp.morning_count), 0) AS morning_count, IFNULL(SUM(pp.head_count), 0) AS head_count, IFNULL(SUM(pp.whole_count), 0) AS whole_count, IFNULL(SUM(pp.service_fee), 0) AS service_fee, MAX(pp.create_time) AS pick_time, MAX(pp.claim_slaughter_time) AS claim_slaughter_time, GROUP_CONCAT(DISTINCT st.owner_id SEPARATOR ',') AS owner_ids, GROUP_CONCAT(DISTINCT st.owner_code SEPARATOR ',') AS owner_code, GROUP_CONCAT(DISTINCT st.owner_name SEPARATOR ',') AS owner_name, GROUP_CONCAT(DISTINCT st.owner_phone SEPARATOR ',') AS owner_phone, GROUP_CONCAT(DISTINCT st.company_name SEPARATOR ',') AS company_name, GROUP_CONCAT(DISTINCT ri.retailer_name SEPARATOR ',') AS retailer_name, MAX(ri.retailer_location) AS retailer_location, MAX(ri.location) AS location, GROUP_CONCAT(DISTINCT ri.contact_phone SEPARATOR ',') AS contact_phone, ri.market_id, IFNULL(SUM(pp.pig_fee), 0) AS pig_fee, rit.integral, di.distributor_id, di.distributor_name, di.distributor_phone, MAX(ri.default_plan_time) AS default_plan_time FROM t_pick_recognize pr JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id LEFT JOIN t_slaughter_trade st ON pr.trade_id = st.trade_id LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id LEFT JOIN t_retailer_integral rit ON pp.retailer_id = rit.retailer_id LEFT JOIN t_distributor_info di ON ri.distributor_id = di.distributor_id LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id WHERE pr.status = 'morningpick' AND pr.pick_date >= '2025-01-02 16:00:00' AND pr.pick_date <= '2025-01-03 15:59:59.999' AND pr.is_delete = 0 AND pp.is_delete = 0 AND isnull(pp.relate_pick_id) = 1 GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone) mn ON rg.stall_id = mn.stall_id AND rg.pick_date = mn.pick_date AND rg.retailer_id = mn.retailer_id LEFT JOIN t_market_place mp ON rg.market_id = mp.market_id UNION (SELECT CONCAT(IFNULL(rg2.recognize_ids, ''), '|', mn2.recognize_ids) AS recognize_ids, CONCAT(IFNULL(rg2.trade_ids, ''), '|', mn2.trade_ids) AS trade_ids, mn2.stall_id, mn2.stall_code, mn2.stall_name, mn2.pick_date, CONCAT(IFNULL(rg2.status, ''), '|', mn2.status) AS status, CONCAT(IFNULL(rg2.pick_ids, ''), '|', mn2.pick_ids) AS pick_ids, mn2.retailer_id, mn2.tattoo_code, mn2.plan_count, mn2.lay_count, mn2.hang_count, mn2.morning_count, mn2.head_count, mn2.whole_count, mn2.service_fee, mn2.pick_time, mn2.claim_slaughter_time, mn2.owner_ids, mn2.owner_code, mn2.owner_name, mn2.owner_phone, mn2.company_name, mn2.retailer_name, mn2.retailer_location, mn2.location, mn2.contact_phone, mn2.market_id, mn2.pig_fee, mn2.service_fee + mn2.pig_fee AS total_fee, mn2.order_no, mn2.pay_way, mn2.integral, mn2.distributor_id, mn2.distributor_name, mn2.distributor_phone, mp.market_code, mp.market_name, mn2.default_plan_time FROM (SELECT GROUP_CONCAT(DISTINCT pr.recognize_id SEPARATOR ',') AS recognize_ids, GROUP_CONCAT(DISTINCT pr.trade_id SEPARATOR ',') AS trade_ids, pr.stall_id, GROUP_CONCAT(DISTINCT pr.stall_code SEPARATOR ',') AS stall_code, GROUP_CONCAT(DISTINCT pr.stall_name SEPARATOR ',') AS stall_name, pr.pick_date, GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status, GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, GROUP_CONCAT(DISTINCT pp.tattoo_code SEPARATOR ',') AS tattoo_code, IFNULL(SUM(pp.plan_count), 0) AS plan_count, IFNULL(SUM(pp.lay_count), 0) AS lay_count, IFNULL(SUM(pp.hang_count), 0) AS hang_count, IFNULL(SUM(pp.morning_count), 0) AS morning_count, IFNULL(SUM(pp.head_count), 0) AS head_count, IFNULL(SUM(pp.whole_count), 0) AS whole_count, IFNULL(SUM(pp.service_fee), 0) AS service_fee, MAX(pp.create_time) AS pick_time, MAX(pp.claim_slaughter_time) AS claim_slaughter_time, GROUP_CONCAT(DISTINCT st.owner_id SEPARATOR ',') AS owner_ids, GROUP_CONCAT(DISTINCT st.owner_code SEPARATOR ',') AS owner_code, GROUP_CONCAT(DISTINCT st.owner_name SEPARATOR ',') AS owner_name, GROUP_CONCAT(DISTINCT st.owner_phone SEPARATOR ',') AS owner_phone, GROUP_CONCAT(DISTINCT st.company_name SEPARATOR ',') AS company_name, GROUP_CONCAT(DISTINCT ri.retailer_name SEPARATOR ',') AS retailer_name, MAX(ri.retailer_location) AS retailer_location, MAX(ri.location) AS location, GROUP_CONCAT(DISTINCT ri.contact_phone SEPARATOR ',') AS contact_phone, ri.market_id, IFNULL(SUM(pp.pig_fee), 0) AS pig_fee, rit.integral, di.distributor_id, di.distributor_name, di.distributor_phone, MAX(ri.default_plan_time) AS default_plan_time FROM t_pick_recognize pr JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id LEFT JOIN t_slaughter_trade st ON pr.trade_id = st.trade_id LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id LEFT JOIN t_retailer_integral rit ON pp.retailer_id = rit.retailer_id LEFT JOIN t_distributor_info di ON ri.distributor_id = di.distributor_id LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id WHERE pr.status = 'submitted' AND pr.pick_date >= '2025-01-02 16:00:00' AND pr.pick_date <= '2025-01-03 15:59:59.999' AND pr.is_delete = 0 AND pp.is_delete = 0 AND isnull(pp.relate_pick_id) = 1 GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone) rg2 RIGHT JOIN (SELECT GROUP_CONCAT(DISTINCT pr.recognize_id SEPARATOR ',') AS recognize_ids, GROUP_CONCAT(DISTINCT pr.trade_id SEPARATOR ',') AS trade_ids, pr.stall_id, GROUP_CONCAT(DISTINCT pr.stall_code SEPARATOR ',') AS stall_code, GROUP_CONCAT(DISTINCT pr.stall_name SEPARATOR ',') AS stal","ts":"2025-01-03T06:11:43"},"fingerprint":"select count(?) from (select concat(rg.recognize_ids, ?, ifnull(mn.recognize_ids, ?)) as recognize_ids, concat(rg.trade_ids, ?, ifnull(mn.trade_ids, ?)) as trade_ids, rg.stall_id, rg.stall_code, rg.stall_name, rg.pick_date, concat(rg.status, ?, ifnull(mn.status, ?)) as status, concat(rg.pick_ids, ?, ifnull(mn.pick_ids, ?)) as pick_ids, rg.retailer_id, rg.tattoo_code, if(mn.stall_id is ? or rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) ? if(mn.stall_id is ? or rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) as plan_count, if(mn.stall_id is ? or rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) as lay_count, if(mn.stall_id is ? or rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) as hang_count, if(mn.stall_id is ?, rg.morning_count, mn.morning_count) as morning_count, rg.head_count, rg.whole_count, rg.service_fee, rg.pick_time, rg.claim_slaughter_time, rg.owner_ids, rg.owner_code, rg.owner_name, rg.owner_phone, rg.company_name, rg.retailer_name, rg.retailer_location, rg.location, rg.contact_phone, rg.market_id, rg.pig_fee, rg.service_fee ? rg.pig_fee as total_fee, rg.order_no, rg.pay_way, rg.integral, rg.distributor_id, rg.distributor_name, rg.distributor_phone, mp.market_code, mp.market_name, rg.default_plan_time from (select group_concat(distinct pr.recognize_id separator ?) as recognize_ids, group_concat(distinct pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(distinct pr.stall_code separator ?) as stall_code, group_concat(distinct pr.stall_name separator ?) as stall_name, pr.pick_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, group_concat(distinct pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.plan_count), ?) as plan_count, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(sum(pp.morning_count), ?) as morning_count, ifnull(sum(pp.head_count), ?) as head_count, ifnull(sum(pp.whole_count), ?) as whole_count, ifnull(sum(pp.service_fee), ?) as service_fee, max(pp.create_time) as pick_time, max(pp.claim_slaughter_time) as claim_slaughter_time, group_concat(distinct st.owner_id separator ?) as owner_ids, group_concat(distinct st.owner_code separator ?) as owner_code, group_concat(distinct st.owner_name separator ?) as owner_name, group_concat(distinct st.owner_phone separator ?) as owner_phone, group_concat(distinct st.company_name separator ?) as company_name, group_concat(distinct ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, max(ri.location) as location, group_concat(distinct ri.contact_phone separator ?) as contact_phone, ri.market_id, ifnull(sum(pp.pig_fee), ?) as pig_fee, rit.integral, di.distributor_id, di.distributor_name, di.distributor_phone, max(ri.default_plan_time) as default_plan_time from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id left join t_slaughter_trade st on pr.trade_id = st.trade_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_retailer_integral rit on pp.retailer_id = rit.retailer_id left join t_distributor_info di on ri.distributor_id = di.distributor_id left join t_market_place mp on ri.market_id = mp.market_id where pr.status = ? and pr.pick_date >= ? and pr.pick_date <= ? and pr.is_delete = ? and pp.is_delete = ? and isnull(pp.relate_pick_id) = ? group by pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone) rg left join (select group_concat(distinct pr.recognize_id separator ?) as recognize_ids, group_concat(distinct pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(distinct pr.stall_code separator ?) as stall_code, group_concat(distinct pr.stall_name separator ?) as stall_name, pr.pick_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, group_concat(distinct pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.plan_count), ?) as plan_count, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(sum(pp.morning_count), ?) as morning_count, ifnull(sum(pp.head_count), ?) as head_count, ifnull(sum(pp.whole_count), ?) as whole_count, ifnull(sum(pp.service_fee), ?) as service_fee, max(pp.create_time) as pick_time, max(pp.claim_slaughter_time) as claim_slaughter_time, group_concat(distinct st.owner_id separator ?) as owner_ids, group_concat(distinct st.owner_code separator ?) as owner_code, group_concat(distinct st.owner_name separator ?) as owner_name, group_concat(distinct st.owner_phone separator ?) as owner_phone, group_concat(distinct st.company_name separator ?) as company_name, group_concat(distinct ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location","histograms":{"Query_time":[0,0,0,0,0,0,62,0]},"metrics":{"Lock_time":{"avg":"0.000030","max":"0.000133","median":"0.000024","min":"0.000011","pct":"0.058491","pct_95":"0.000045","stddev":"0.000020","sum":"0.001883"},"Query_length":{"avg":"12353","max":"12353","median":"12353","min":"12353","pct":"0","pct_95":"12353","stddev":"0","sum":"765886"},"Query_time":{"avg":"4.216428","max":"4.623306","median":"4.287959","min":"3.201867","pct":"0.058491","pct_95":"4.502357","stddev":"0.350007","sum":"261.418557"},"Rows_examined":{"avg":"415","max":"742","median":"463","min":"9","pct":"0","pct_95":"719","stddev":"249","sum":"25770"},"Rows_sent":{"avg":"1","max":"1","median":"1","min":"1","pct":"0","pct_95":"1","stddev":"0","sum":"62"},"db":{"value":"pz_wsnh_prod"},"host":{"value":"192.168.5.243"},"user":{"value":"pz_wsnh"}},"query_count":62,"tables":[{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pick_recognize`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pick_recognize'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pig_pick`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pig_pick'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_slaughter_trade`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_slaughter_trade'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_integral`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_integral'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_distributor_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_distributor_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_market_place`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_market_place'\\G"}],"ts_max":"2025-01-03T06:12:36","ts_min":"2025-01-03T00:20:57"},{"attribute":"fingerprint","checksum":"8DC71273E478001F73A4BB95745935A3","distillate":"INSERT t_heartbeat_detection","example":{"Query_time":"204.071597","query":"INSERT INTO t_heartbeat_detection  ( heartbeat_time,\nstate,\n\n\ndispose,\ndispose_info,\n\ncreate_time,\ncreate_user )  VALUES  ( '2025-01-03 15:02:45.883',\n1,\n\n\n1,\n'é¢è­¦ç®æ³å¿è·³',\n\n'2025-01-03 15:02:45.883',\n'system' )","ts":"2025-01-03T15:06:09"},"fingerprint":"insert into t_heartbeat_detection ( heartbeat_time, state, dispose, dispose_info, create_time, create_user ) values(?+)","histograms":{"Query_time":[0,0,0,0,0,0,0,1]},"metrics":{"Lock_time":{"avg":"0.000002","max":"0.000002","median":"0.000002","min":"0.000002","pct":"0.000943","pct_95":"0.000002","stddev":"0.000000","sum":"0.000002"},"Query_length":{"avg":"219","max":"219","median":"219","min":"219","pct":"0","pct_95":"219","stddev":"0","sum":"219"},"Query_time":{"avg":"204.071597","max":"204.071597","median":"204.071597","min":"204.071597","pct":"0.000943","pct_95":"204.071597","stddev":"0.000000","sum":"204.071597"},"Rows_examined":{"avg":"0","max":"0","median":"0","min":"0","pct":"0","pct_95":"0","stddev":"0","sum":"0"},"Rows_sent":{"avg":"0","max":"0","median":"0","min":"0","pct":"0","pct_95":"0","stddev":"0","sum":"0"},"db":{"value":"wsnh_prod"},"host":{"value":"192.168.5.243"},"user":{"value":"wsnh"}},"query_count":1,"tables":[{"create":"SHOW CREATE TABLE `wsnh_prod`.`t_heartbeat_detection`\\G","status":"SHOW TABLE STATUS FROM `wsnh_prod` LIKE 't_heartbeat_detection'\\G"}],"ts_max":"2025-01-03T15:06:09","ts_min":"2025-01-03T15:06:09"},{"attribute":"fingerprint","checksum":"3B1F291795243C2A045BA476C4538AA1","distillate":"SELECT UNION t_pick_recognize t_pig_pick t_retailer_info t_market_place t_bill_print t_pick_recognize t_pig_pick t_retailer_info t_market_place t_bill_print t_pick_recognize t_pig_pick t_retailer_info t_market_place t_bill_print","example":{"Query_time":"8.990435","query":"SELECT GROUP_CONCAT(gb.recognize_ids SEPARATOR '+') AS recognize_ids,\n            GROUP_CONCAT(gb.trade_ids SEPARATOR '+') AS trade_ids,\n            GROUP_CONCAT(gb.stall_id SEPARATOR ',') AS stall_ids,\n            GROUP_CONCAT(gb.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(gb.stall_name SEPARATOR ',') AS stall_name,\n            gb.bill_date,\n            GROUP_CONCAT(gb.pick_ids SEPARATOR ',') AS pick_ids,\n            gb.retailer_id,\n            GROUP_CONCAT(gb.tattoo_code SEPARATOR ',') AS tattoo_code,\n            SUM(gb.purchase_count) AS purchase_count,\n            SUM(gb.dead_pig_count) AS dead_pig_count,\n            GROUP_CONCAT(gb.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(gb.retailer_location) AS retailer_location,\n            GROUP_CONCAT(gb.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(gb.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(gb.print_status SEPARATOR ',') AS print_status,\n            SUM(gb.print_count) AS print_count,\n            MAX(gb.print_time) AS print_time,\n            MAX(gb.retailer_mark) AS retailer_mark\n        FROM (\n            (\n                 \n        SELECT CONCAT(rg.recognize_ids, '|', IFNULL(mn.recognize_ids, '')) AS recognize_ids,\n            CONCAT(rg.trade_ids, '|', IFNULL(mn.trade_ids, '')) AS trade_ids,\n            rg.stall_id,\n            rg.stall_code,\n            rg.stall_name,\n            rg.bill_date,\n            rg.status,\n            rg.pick_ids,\n            rg.retailer_id,\n            rg.tattoo_code,\n            IF(rg.lay_count + rg.hang_count - IF(mn.stall_id IS NULL, 0, mn.lay_count + mn.hang_count) >= 0,\n                rg.lay_count + rg.hang_count - IF(mn.stall_id IS NULL, 0, mn.lay_count + mn.hang_count), 0) AS purchase_count,\n            rg.lay_count,\n            rg.hang_count,\n            rg.dead_pig_count,\n            \n            rg.retailer_name,\n            rg.retailer_location,\n            rg.contact_phone,\n            rg.market_name,\n            rg.print_status,\n            IF(rg.print_count - IF(mn.stall_id IS NULL, 0, mn.print_count) >= 0,\n                rg.print_count - IF(mn.stall_id IS NULL, 0, mn.print_count), 0) AS print_count,\n            rg.print_time,\n            rg.retailer_mark\n        FROM (\n             \n        SELECT GROUP_CONCAT(pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date AS bill_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            GROUP_CONCAT(pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL((\n                    \n                    0\n            ), 0) AS dead_pig_count,\n            GROUP_CONCAT(ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            GROUP_CONCAT(ri.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(mp.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(bp.print_status SEPARATOR ',') AS print_status,\n            SUM(IF(bp.print_status = '1', IFNULL(pp.lay_count, 0) + IFNULL(pp.hang_count, 0), 0)) AS print_count,\n            MAX(bp.print_time) AS print_time,\n            MAX(ri.retailer_mark) AS retailer_mark\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n            LEFT JOIN t_bill_print bp ON pp.pick_id = bp.pick_id AND bp.is_delete = 0\n         WHERE  pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            AND pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n        \n        \n        \n            AND ri.retailer_mark = 0\n        \n        \n        \n        \n            AND pr.status IN\n            ('submitted')\n        \n        \n            AND IFNULL(bp.print_status, '0') = '0'\n        \n        \n        AND pr.status = 'submitted' AND pr.is_delete = 0\n        AND pp.retailer_id > 0 AND pp.is_delete = 0 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id\n     \n        ) rg LEFT JOIN (\n             \n        SELECT GROUP_CONCAT(pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date AS bill_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            GROUP_CONCAT(pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL((\n                    \n                    0\n            ), 0) AS dead_pig_count,\n            GROUP_CONCAT(ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            GROUP_CONCAT(ri.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(mp.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(bp.print_status SEPARATOR ',') AS print_status,\n            SUM(IF(bp.print_status = '1', IFNULL(pp.lay_count, 0) + IFNULL(pp.hang_count, 0), 0)) AS print_count,\n            MAX(bp.print_time) AS print_time,\n            MAX(ri.retailer_mark) AS retailer_mark\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n            LEFT JOIN t_bill_print bp ON pp.pick_id = bp.pick_id AND bp.is_delete = 0\n         WHERE  pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            AND pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n        \n        \n        \n            AND ri.retailer_mark = 0\n        \n        \n        \n        \n        \n        \n        AND pr.status = 'morningpick' AND pr.is_delete = 0\n        AND pp.retailer_id > 0 AND pp.is_delete = 0 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id\n     \n        ) mn ON rg.bill_date = mn.bill_date AND rg.stall_id = mn.stall_id AND rg.retailer_id = mn.retailer_id\n        HAVING purchase_count != 0 OR print_count != 0\n     \n            ) UNION (\n                 \n        SELECT CONCAT('|', mn2.recognize_ids) AS recognize_ids,\n            CONCAT('|', mn2.trade_ids) AS trade_ids,\n            mn2.stall_id,\n            mn2.stall_code,\n            mn2.stall_name,\n            mn2.bill_date,\n            mn2.status,\n            mn2.pick_ids,\n            mn2.retailer_id,\n            mn2.tattoo_code,\n            mn2.lay_count + mn2.hang_count AS purchase_count,\n            mn2.lay_count,\n            mn2.hang_count,\n            mn2.dead_pig_count,\n            \n            mn2.retailer_name,\n            mn2.retailer_location,\n            mn2.contact_phone,\n            mn2.market_name,\n            mn2.print_status,\n            mn2.print_count,\n            mn2.print_time,\n            mn2.retailer_mark\n        FROM (\n             \n        SELECT GROUP_CONCAT(pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date AS bill_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            GROUP_CONCAT(pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL((\n                    \n                    0\n            ), 0) AS dead_pig_count,\n            GROUP_CONCAT(ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            GROUP_CONCAT(ri.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(mp.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(bp.print_status SEPARATOR ',') AS print_status,\n            SUM(IF(bp.print_status = '1', IFNULL(pp.lay_count, 0) + IFNULL(pp.hang_count, 0), 0)) AS print_count,\n            MAX(bp.print_time) AS print_time,\n            MAX(ri.retailer_mark) AS retailer_mark\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n            LEFT JOIN t_bill_print bp ON pp.pick_id = bp.pick_id AND bp.is_delete = 0\n         WHERE  pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            AND pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n        \n        \n        \n            AND ri.retailer_mark = 0\n        \n        \n        \n        \n            AND pr.status IN\n            ('submitted')\n        \n        \n            AND IFNULL(bp.print_status, '0') = '0'\n        \n        \n        AND pr.status = 'morningpick' AND pr.is_delete = 0\n        AND pp.retailer_id > 0 AND pp.is_delete = 0 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id\n     \n        ) mn2\n     \n      ","ts":"2025-01-03T06:08:26"},"fingerprint":"select group_concat(gb.recognize_ids separator ?) as recognize_ids, group_concat(gb.trade_ids separator ?) as trade_ids, group_concat(gb.stall_id separator ?) as stall_ids, group_concat(gb.stall_code separator ?) as stall_code, group_concat(gb.stall_name separator ?) as stall_name, gb.bill_date, group_concat(gb.pick_ids separator ?) as pick_ids, gb.retailer_id, group_concat(gb.tattoo_code separator ?) as tattoo_code, sum(gb.purchase_count) as purchase_count, sum(gb.dead_pig_count) as dead_pig_count, group_concat(gb.retailer_name separator ?) as retailer_name, max(gb.retailer_location) as retailer_location, group_concat(gb.contact_phone separator ?) as contact_phone, group_concat(gb.market_name separator ?) as market_name, group_concat(gb.print_status separator ?) as print_status, sum(gb.print_count) as print_count, max(gb.print_time) as print_time, max(gb.retailer_mark) as retailer_mark from ( ( select concat(rg.recognize_ids, ?, ifnull(mn.recognize_ids, ?)) as recognize_ids, concat(rg.trade_ids, ?, ifnull(mn.trade_ids, ?)) as trade_ids, rg.stall_id, rg.stall_code, rg.stall_name, rg.bill_date, rg.status, rg.pick_ids, rg.retailer_id, rg.tattoo_code, if(rg.lay_count ? rg.hang_count ? if(mn.stall_id is ?, ?, mn.lay_count ? mn.hang_count) >= ?, rg.lay_count ? rg.hang_count ? if(mn.stall_id is ?, ?, mn.lay_count ? mn.hang_count), ?) as purchase_count, rg.lay_count, rg.hang_count, rg.dead_pig_count, rg.retailer_name, rg.retailer_location, rg.contact_phone, rg.market_name, rg.print_status, if(rg.print_count ? if(mn.stall_id is ?, ?, mn.print_count) >= ?, rg.print_count ? if(mn.stall_id is ?, ?, mn.print_count), ?) as print_count, rg.print_time, rg.retailer_mark from ( select group_concat(pr.recognize_id separator ?) as recognize_ids, group_concat(pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(pr.stall_code separator ?) as stall_code, group_concat(pr.stall_name separator ?) as stall_name, pr.pick_date as bill_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, group_concat(pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(( ? ), ?) as dead_pig_count, group_concat(ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, group_concat(ri.contact_phone separator ?) as contact_phone, group_concat(mp.market_name separator ?) as market_name, group_concat(bp.print_status separator ?) as print_status, sum(if(bp.print_status = ?, ifnull(pp.lay_count, ?) ? ifnull(pp.hang_count, ?), ?)) as print_count, max(bp.print_time) as print_time, max(ri.retailer_mark) as retailer_mark from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_market_place mp on ri.market_id = mp.market_id left join t_bill_print bp on pp.pick_id = bp.pick_id and bp.is_delete = ? where pr.pick_date >= ? and pr.pick_date <= ? and ri.retailer_mark = ? and pr.status in(?+) and ifnull(bp.print_status, ?) = ? and pr.status = ? and pr.is_delete = ? and pp.retailer_id > ? and pp.is_delete = ? group by pr.pick_date, pr.stall_id, pp.retailer_id ) rg left join ( select group_concat(pr.recognize_id separator ?) as recognize_ids, group_concat(pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(pr.stall_code separator ?) as stall_code, group_concat(pr.stall_name separator ?) as stall_name, pr.pick_date as bill_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, group_concat(pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(( ? ), ?) as dead_pig_count, group_concat(ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, group_concat(ri.contact_phone separator ?) as contact_phone, group_concat(mp.market_name separator ?) as market_name, group_concat(bp.print_status separator ?) as print_status, sum(if(bp.print_status = ?, ifnull(pp.lay_count, ?) ? ifnull(pp.hang_count, ?), ?)) as print_count, max(bp.print_time) as print_time, max(ri.retailer_mark) as retailer_mark from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_market_place mp on ri.market_id = mp.market_id left join t_bill_print bp on pp.pick_id = bp.pick_id and bp.is_delete = ? where pr.pick_date >= ? and pr.pick_date <= ? and ri.retailer_mark = ? and pr.status = ? and pr.is_delete = ? and pp.retailer_id > ? and pp.is_delete = ? group by pr.pick_date, pr.stall_id, pp.retailer_id ) mn on rg.bill_date = mn.bill_date and rg.stall_id = mn.stall_id and rg.retailer_id = mn.retailer_id having purchase_count != ? or print_count != ? ) union ( select concat(?, mn?recognize_ids) as recognize_id","histograms":{"Query_time":[0,0,0,0,0,0,38,0]},"metrics":{"Lock_time":{"avg":"0.000011","max":"0.000021","median":"0.000009","min":"0.000005","pct":"0.035849","pct_95":"0.000018","stddev":"0.000004","sum":"0.000411"},"Query_length":{"avg":"10134","max":"10136","median":"10031","min":"10132","pct":"0","pct_95":"10031","stddev":"0","sum":"385096"},"Query_time":{"avg":"5.152320","max":"8.990435","median":"4.963848","min":"2.525052","pct":"0.035849","pct_95":"8.489865","stddev":"1.734743","sum":"195.788174"},"Rows_examined":{"avg":"192","max":"530","median":"80","min":"8","pct":"0","pct_95":"511","stddev":"179","sum":"7308"},"Rows_sent":{"avg":"46","max":"100","median":"24","min":"2","pct":"0","pct_95":"97","stddev":"35","sum":"1770"},"db":{"value":"pz_wsnh_prod"},"host":{"value":"192.168.5.243"},"user":{"value":"pz_wsnh"}},"query_count":38,"tables":[{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pick_recognize`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pick_recognize'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pig_pick`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pig_pick'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_market_place`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_market_place'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_bill_print`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_bill_print'\\G"}],"ts_max":"2025-01-03T06:11:45","ts_min":"2025-01-03T02:10:11"},{"attribute":"fingerprint","checksum":"81F02B1579BCADFD2EFF761B17D21F90","distillate":"SELECT UNION t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place","example":{"Query_time":"4.410400","query":"SELECT SUM(plan_count) AS plan_count,\n            SUM(lay_count) AS lay_count,\n            SUM(hang_count) AS hang_count,\n            SUM(morning_count) AS morning_count,\n            SUM(head_count) AS head_count,\n            SUM(whole_count) AS whole_count,\n            SUM(service_fee) AS service_fee,\n            SUM(pig_fee) AS pig_fee,\n            SUM(service_fee + pig_fee) AS total_fee,\n            Count(DISTINCT pick_date) AS total_days\n        FROM ( \n         \n\n        SELECT CONCAT(rg.recognize_ids, '|', IFNULL(mn.recognize_ids, '')) AS recognize_ids,\n            CONCAT(rg.trade_ids, '|', IFNULL(mn.trade_ids, '')) AS trade_ids,\n            rg.stall_id,\n            rg.stall_code,\n            rg.stall_name,\n            rg.pick_date,\n            CONCAT(rg.status, '|', IFNULL(mn.status, '')) AS status,\n            CONCAT(rg.pick_ids, '|', IFNULL(mn.pick_ids, '')) AS pick_ids,\n            rg.retailer_id,\n            rg.tattoo_code,\n            IF(mn.stall_id IS NULL OR rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count)\n                + IF(mn.stall_id IS NULL OR rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count)\n            AS plan_count,\n            IF(mn.stall_id IS NULL OR rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) AS lay_count,\n            IF(mn.stall_id IS NULL OR rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) AS hang_count,\n            IF(mn.stall_id IS NULL, rg.morning_count, mn.morning_count) AS morning_count,\n            rg.head_count,\n            rg.whole_count,\n            rg.service_fee,\n            rg.pick_time,\n            rg.claim_slaughter_time,\n            rg.owner_ids,\n            rg.owner_code,\n            rg.owner_name,\n            rg.owner_phone,\n            rg.company_name,\n            rg.retailer_name,\n            rg.retailer_location,\n            rg.location,\n            rg.contact_phone,\n            rg.market_id,\n            rg.pig_fee,\n            rg.service_fee + rg.pig_fee AS total_fee,\n            rg.order_no,\n            rg.pay_way,\n            rg.integral,\n            rg.distributor_id,\n            rg.distributor_name,\n            rg.distributor_phone,\n            mp.market_code,\n            mp.market_name,\n            rg.default_plan_time\n        FROM ( \n        SELECT GROUP_CONCAT(DISTINCT pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(DISTINCT pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(DISTINCT pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(DISTINCT pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            pp.order_no,\n            pp.pay_way,\n            GROUP_CONCAT(DISTINCT pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.plan_count), 0) AS plan_count,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL(SUM(pp.morning_count), 0) AS morning_count,\n            IFNULL(SUM(pp.head_count), 0) AS head_count,\n            IFNULL(SUM(pp.whole_count), 0) AS whole_count,\n            IFNULL(SUM(pp.service_fee), 0) AS service_fee,\n            MAX(pp.create_time) AS pick_time,\n            MAX(pp.claim_slaughter_time) AS claim_slaughter_time,\n            GROUP_CONCAT(DISTINCT st.owner_id SEPARATOR ',') AS owner_ids,\n            GROUP_CONCAT(DISTINCT st.owner_code SEPARATOR ',') AS owner_code,\n            GROUP_CONCAT(DISTINCT st.owner_name SEPARATOR ',') AS owner_name,\n            GROUP_CONCAT(DISTINCT st.owner_phone SEPARATOR ',') AS owner_phone,\n            GROUP_CONCAT(DISTINCT st.company_name SEPARATOR ',') AS company_name,\n            GROUP_CONCAT(DISTINCT ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            MAX(ri.location) AS location,\n            GROUP_CONCAT(DISTINCT ri.contact_phone SEPARATOR ',') AS contact_phone,\n            ri.market_id,\n            IFNULL(SUM(pp.pig_fee), 0) AS pig_fee,\n            rit.integral,\n            di.distributor_id,\n            di.distributor_name,\n            di.distributor_phone,\n            MAX(ri.default_plan_time) AS default_plan_time\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_slaughter_trade st ON pr.trade_id = st.trade_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_retailer_integral rit ON pp.retailer_id = rit.retailer_id\n            LEFT JOIN t_distributor_info di ON ri.distributor_id = di.distributor_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n         WHERE pr.status = 'submitted'\n            \n        \n        \n        \n            and pr.pick_date >= '2025-01-03 00:00:00'\n        \n        \n            and pr.pick_date <= '2025-01-03 00:00:00'\n        \n        \n        \n        \n        \n        \n            AND pr.stall_id = 18\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.is_delete = 0\n        AND pp.is_delete = 0\n    \n            AND isnull(pp.relate_pick_id) = 1 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone\n     ) rg\n            LEFT JOIN ( \n        SELECT GROUP_CONCAT(DISTINCT pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(DISTINCT pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(DISTINCT pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(DISTINCT pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            pp.order_no,\n            pp.pay_way,\n            GROUP_CONCAT(DISTINCT pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.plan_count), 0) AS plan_count,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL(SUM(pp.morning_count), 0) AS morning_count,\n            IFNULL(SUM(pp.head_count), 0) AS head_count,\n            IFNULL(SUM(pp.whole_count), 0) AS whole_count,\n            IFNULL(SUM(pp.service_fee), 0) AS service_fee,\n            MAX(pp.create_time) AS pick_time,\n            MAX(pp.claim_slaughter_time) AS claim_slaughter_time,\n            GROUP_CONCAT(DISTINCT st.owner_id SEPARATOR ',') AS owner_ids,\n            GROUP_CONCAT(DISTINCT st.owner_code SEPARATOR ',') AS owner_code,\n            GROUP_CONCAT(DISTINCT st.owner_name SEPARATOR ',') AS owner_name,\n            GROUP_CONCAT(DISTINCT st.owner_phone SEPARATOR ',') AS owner_phone,\n            GROUP_CONCAT(DISTINCT st.company_name SEPARATOR ',') AS company_name,\n            GROUP_CONCAT(DISTINCT ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            MAX(ri.location) AS location,\n            GROUP_CONCAT(DISTINCT ri.contact_phone SEPARATOR ',') AS contact_phone,\n            ri.market_id,\n            IFNULL(SUM(pp.pig_fee), 0) AS pig_fee,\n            rit.integral,\n            di.distributor_id,\n            di.distributor_name,\n            di.distributor_phone,\n            MAX(ri.default_plan_time) AS default_plan_time\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_slaughter_trade st ON pr.trade_id = st.trade_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_retailer_integral rit ON pp.retailer_id = rit.retailer_id\n            LEFT JOIN t_distributor_info di ON ri.distributor_id = di.distributor_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n         WHERE pr.status = 'morningpick'\n            \n        \n        \n        \n            and pr.pick_date >= '2025-01-03 00:00:00'\n        \n        \n            and pr.pick_date <= '2025-01-03 00:00:00'\n        \n        \n        \n        \n        \n        \n            AND pr.stall_id = 18\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.is_delete = 0\n        AND pp.is_delete = 0\n    \n            AND isnull(pp.relate_pick_id) = 1 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone\n     ) mn\n                ON rg.stall_id = mn.stall_id AND rg.pick_date = mn.pick_date AND rg.retailer_id = mn.retailer_id\n            LEFT JOIN t_market_place mp ON rg.market_id = mp.market_id\n        UNION (\n            SELECT CONCAT(IFNULL(rg2.recognize_ids, ''), '|', mn2.recognize_ids) AS recognize_ids,\n                CONCAT(IFNULL(rg2.trade_ids, ''), '|', mn2.trade_ids) AS trade_ids,\n                mn2.stall_id,\n                mn2.stall_code,\n                mn2.stall_name,\n                mn2.pick_date,\n                CONCAT(IFNULL(rg2.status, ''), '|', mn2.status) AS status,\n                CONCAT(IFNULL(rg2.pick_ids, ''), '|', mn2.pick_ids) AS pick_ids,\n                mn2.retailer_id,\n                mn2.tattoo_code,\n                mn2.plan_count,\n                mn2.lay_count,\n                mn2.hang_count,\n                mn2.morning_count,\n                mn2.head_count,\n                mn2.whole_count,\n                mn2.service_fee,\n                mn2.pick_time,\n                mn2.claim_slaughter_time,\n                mn2.owner_ids,\n                mn2.owner_code,\n                mn2.owner_name,\n                mn2.owner_phone,\n                mn2.company_","ts":"2025-01-03T02:17:36"},"fingerprint":"select sum(plan_count) as plan_count, sum(lay_count) as lay_count, sum(hang_count) as hang_count, sum(morning_count) as morning_count, sum(head_count) as head_count, sum(whole_count) as whole_count, sum(service_fee) as service_fee, sum(pig_fee) as pig_fee, sum(service_fee ? pig_fee) as total_fee, count(distinct pick_date) as total_days from ( select concat(rg.recognize_ids, ?, ifnull(mn.recognize_ids, ?)) as recognize_ids, concat(rg.trade_ids, ?, ifnull(mn.trade_ids, ?)) as trade_ids, rg.stall_id, rg.stall_code, rg.stall_name, rg.pick_date, concat(rg.status, ?, ifnull(mn.status, ?)) as status, concat(rg.pick_ids, ?, ifnull(mn.pick_ids, ?)) as pick_ids, rg.retailer_id, rg.tattoo_code, if(mn.stall_id is ? or rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) ? if(mn.stall_id is ? or rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) as plan_count, if(mn.stall_id is ? or rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) as lay_count, if(mn.stall_id is ? or rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) as hang_count, if(mn.stall_id is ?, rg.morning_count, mn.morning_count) as morning_count, rg.head_count, rg.whole_count, rg.service_fee, rg.pick_time, rg.claim_slaughter_time, rg.owner_ids, rg.owner_code, rg.owner_name, rg.owner_phone, rg.company_name, rg.retailer_name, rg.retailer_location, rg.location, rg.contact_phone, rg.market_id, rg.pig_fee, rg.service_fee ? rg.pig_fee as total_fee, rg.order_no, rg.pay_way, rg.integral, rg.distributor_id, rg.distributor_name, rg.distributor_phone, mp.market_code, mp.market_name, rg.default_plan_time from ( select group_concat(distinct pr.recognize_id separator ?) as recognize_ids, group_concat(distinct pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(distinct pr.stall_code separator ?) as stall_code, group_concat(distinct pr.stall_name separator ?) as stall_name, pr.pick_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, group_concat(distinct pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.plan_count), ?) as plan_count, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(sum(pp.morning_count), ?) as morning_count, ifnull(sum(pp.head_count), ?) as head_count, ifnull(sum(pp.whole_count), ?) as whole_count, ifnull(sum(pp.service_fee), ?) as service_fee, max(pp.create_time) as pick_time, max(pp.claim_slaughter_time) as claim_slaughter_time, group_concat(distinct st.owner_id separator ?) as owner_ids, group_concat(distinct st.owner_code separator ?) as owner_code, group_concat(distinct st.owner_name separator ?) as owner_name, group_concat(distinct st.owner_phone separator ?) as owner_phone, group_concat(distinct st.company_name separator ?) as company_name, group_concat(distinct ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, max(ri.location) as location, group_concat(distinct ri.contact_phone separator ?) as contact_phone, ri.market_id, ifnull(sum(pp.pig_fee), ?) as pig_fee, rit.integral, di.distributor_id, di.distributor_name, di.distributor_phone, max(ri.default_plan_time) as default_plan_time from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id left join t_slaughter_trade st on pr.trade_id = st.trade_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_retailer_integral rit on pp.retailer_id = rit.retailer_id left join t_distributor_info di on ri.distributor_id = di.distributor_id left join t_market_place mp on ri.market_id = mp.market_id where pr.status = ? and pr.pick_date >= ? and pr.pick_date <= ? and pr.stall_id = ? and pr.is_delete = ? and pp.is_delete = ? and isnull(pp.relate_pick_id) = ? group by pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone ) rg left join ( select group_concat(distinct pr.recognize_id separator ?) as recognize_ids, group_concat(distinct pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(distinct pr.stall_code separator ?) as stall_code, group_concat(distinct pr.stall_name separator ?) as stall_name, pr.pick_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, group_concat(distinct pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.plan_count), ?) as plan_count, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(sum(pp.morning_count), ?) as morning_count, ifnull(sum(pp.head_count), ?) as head_count, ifnull(sum(pp.whole_count), ?) as whole_count, ifnull(sum(pp.service_fee), ?) as service_fee, max(pp.create_time) as pick_time, max(pp.claim_slaughter_time) as claim_slaughter_time, group_concat(distinct st.owner_id separator ?) as owner_ids, group_concat(distinct st.owner_c","histograms":{"Query_time":[0,0,0,0,0,0,40,0]},"metrics":{"Lock_time":{"avg":"0.000027","max":"0.000076","median":"0.000022","min":"0.000018","pct":"0.037736","pct_95":"0.000045","stddev":"0.000012","sum":"0.001071"},"Query_length":{"avg":"17429","max":"17430","median":"17156","min":"17426","pct":"0","pct_95":"17156","stddev":"0","sum":"697168"},"Query_time":{"avg":"4.060004","max":"4.410400","median":"3.889305","min":"3.761278","pct":"0.037736","pct_95":"4.287959","stddev":"0.133909","sum":"162.400167"},"Rows_examined":{"avg":"49","max":"117","median":"38","min":"5","pct":"0","pct_95":"112","stddev":"25","sum":"1995"},"Rows_sent":{"avg":"1","max":"1","median":"1","min":"1","pct":"0","pct_95":"1","stddev":"0","sum":"40"},"db":{"value":"pz_wsnh_prod"},"host":{"value":"192.168.5.243"},"user":{"value":"pz_wsnh"}},"query_count":40,"tables":[{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pick_recognize`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pick_recognize'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pig_pick`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pig_pick'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_slaughter_trade`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_slaughter_trade'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_integral`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_integral'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_distributor_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_distributor_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_market_place`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_market_place'\\G"}],"ts_max":"2025-01-03T04:47:43","ts_min":"2025-01-03T02:14:39"},{"attribute":"fingerprint","checksum":"4B8A50E91CA0C92A2BD1E572FA14DE9D","distillate":"SELECT UNION t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place","example":{"Query_time":"5.045156","query":"SELECT count(0) FROM (SELECT CONCAT(rg.recognize_ids, '|', IFNULL(mn.recognize_ids, '')) AS recognize_ids, CONCAT(rg.trade_ids, '|', IFNULL(mn.trade_ids, '')) AS trade_ids, rg.stall_id, rg.stall_code, rg.stall_name, rg.pick_date, CONCAT(rg.status, '|', IFNULL(mn.status, '')) AS status, CONCAT(rg.pick_ids, '|', IFNULL(mn.pick_ids, '')) AS pick_ids, rg.retailer_id, rg.tattoo_code, IF(mn.stall_id IS NULL OR rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) + IF(mn.stall_id IS NULL OR rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) AS plan_count, IF(mn.stall_id IS NULL OR rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) AS lay_count, IF(mn.stall_id IS NULL OR rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) AS hang_count, IF(mn.stall_id IS NULL, rg.morning_count, mn.morning_count) AS morning_count, rg.head_count, rg.whole_count, rg.service_fee, rg.pick_time, rg.claim_slaughter_time, rg.owner_ids, rg.owner_code, rg.owner_name, rg.owner_phone, rg.company_name, rg.retailer_name, rg.retailer_location, rg.location, rg.contact_phone, rg.market_id, rg.pig_fee, rg.service_fee + rg.pig_fee AS total_fee, rg.order_no, rg.pay_way, rg.integral, rg.distributor_id, rg.distributor_name, rg.distributor_phone, mp.market_code, mp.market_name, rg.default_plan_time FROM (SELECT GROUP_CONCAT(DISTINCT pr.recognize_id SEPARATOR ',') AS recognize_ids, GROUP_CONCAT(DISTINCT pr.trade_id SEPARATOR ',') AS trade_ids, pr.stall_id, GROUP_CONCAT(DISTINCT pr.stall_code SEPARATOR ',') AS stall_code, GROUP_CONCAT(DISTINCT pr.stall_name SEPARATOR ',') AS stall_name, pr.pick_date, GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status, GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, GROUP_CONCAT(DISTINCT pp.tattoo_code SEPARATOR ',') AS tattoo_code, IFNULL(SUM(pp.plan_count), 0) AS plan_count, IFNULL(SUM(pp.lay_count), 0) AS lay_count, IFNULL(SUM(pp.hang_count), 0) AS hang_count, IFNULL(SUM(pp.morning_count), 0) AS morning_count, IFNULL(SUM(pp.head_count), 0) AS head_count, IFNULL(SUM(pp.whole_count), 0) AS whole_count, IFNULL(SUM(pp.service_fee), 0) AS service_fee, MAX(pp.create_time) AS pick_time, MAX(pp.claim_slaughter_time) AS claim_slaughter_time, GROUP_CONCAT(DISTINCT st.owner_id SEPARATOR ',') AS owner_ids, GROUP_CONCAT(DISTINCT st.owner_code SEPARATOR ',') AS owner_code, GROUP_CONCAT(DISTINCT st.owner_name SEPARATOR ',') AS owner_name, GROUP_CONCAT(DISTINCT st.owner_phone SEPARATOR ',') AS owner_phone, GROUP_CONCAT(DISTINCT st.company_name SEPARATOR ',') AS company_name, GROUP_CONCAT(DISTINCT ri.retailer_name SEPARATOR ',') AS retailer_name, MAX(ri.retailer_location) AS retailer_location, MAX(ri.location) AS location, GROUP_CONCAT(DISTINCT ri.contact_phone SEPARATOR ',') AS contact_phone, ri.market_id, IFNULL(SUM(pp.pig_fee), 0) AS pig_fee, rit.integral, di.distributor_id, di.distributor_name, di.distributor_phone, MAX(ri.default_plan_time) AS default_plan_time FROM t_pick_recognize pr JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id LEFT JOIN t_slaughter_trade st ON pr.trade_id = st.trade_id LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id LEFT JOIN t_retailer_integral rit ON pp.retailer_id = rit.retailer_id LEFT JOIN t_distributor_info di ON ri.distributor_id = di.distributor_id LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id WHERE pr.status = 'submitted' AND pr.pick_date >= '2025-01-02 16:00:00' AND pr.pick_date <= '2025-01-03 15:59:59.999' AND pr.stall_id = 7 AND pr.is_delete = 0 AND pp.is_delete = 0 AND isnull(pp.relate_pick_id) = 1 GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone) rg LEFT JOIN (SELECT GROUP_CONCAT(DISTINCT pr.recognize_id SEPARATOR ',') AS recognize_ids, GROUP_CONCAT(DISTINCT pr.trade_id SEPARATOR ',') AS trade_ids, pr.stall_id, GROUP_CONCAT(DISTINCT pr.stall_code SEPARATOR ',') AS stall_code, GROUP_CONCAT(DISTINCT pr.stall_name SEPARATOR ',') AS stall_name, pr.pick_date, GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status, GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, GROUP_CONCAT(DISTINCT pp.tattoo_code SEPARATOR ',') AS tattoo_code, IFNULL(SUM(pp.plan_count), 0) AS plan_count, IFNULL(SUM(pp.lay_count), 0) AS lay_count, IFNULL(SUM(pp.hang_count), 0) AS hang_count, IFNULL(SUM(pp.morning_count), 0) AS morning_count, IFNULL(SUM(pp.head_count), 0) AS head_count, IFNULL(SUM(pp.whole_count), 0) AS whole_count, IFNULL(SUM(pp.service_fee), 0) AS service_fee, MAX(pp.create_time) AS pick_time, MAX(pp.claim_slaughter_time) AS claim_slaughter_time, GROUP_CONCAT(DISTINCT st.owner_id SEPARATOR ',') AS owner_ids, GROUP_CONCAT(DISTINCT st.owner_code SEPARATOR ',') AS owner_code, GROUP_CONCAT(DISTINCT st.owner_name SEPARATOR ',') AS owner_name, GROUP_CONCAT(DISTINCT st.owner_phone SEPARATOR ',') AS owner_phone, GROUP_CONCAT(DISTINCT st.company_name SEPARATOR ',') AS company_name, GROUP_CONCAT(DISTINCT ri.retailer_name SEPARATOR ',') AS retailer_name, MAX(ri.retailer_location) AS retailer_location, MAX(ri.location) AS location, GROUP_CONCAT(DISTINCT ri.contact_phone SEPARATOR ',') AS contact_phone, ri.market_id, IFNULL(SUM(pp.pig_fee), 0) AS pig_fee, rit.integral, di.distributor_id, di.distributor_name, di.distributor_phone, MAX(ri.default_plan_time) AS default_plan_time FROM t_pick_recognize pr JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id LEFT JOIN t_slaughter_trade st ON pr.trade_id = st.trade_id LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id LEFT JOIN t_retailer_integral rit ON pp.retailer_id = rit.retailer_id LEFT JOIN t_distributor_info di ON ri.distributor_id = di.distributor_id LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id WHERE pr.status = 'morningpick' AND pr.pick_date >= '2025-01-02 16:00:00' AND pr.pick_date <= '2025-01-03 15:59:59.999' AND pr.stall_id = 7 AND pr.is_delete = 0 AND pp.is_delete = 0 AND isnull(pp.relate_pick_id) = 1 GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone) mn ON rg.stall_id = mn.stall_id AND rg.pick_date = mn.pick_date AND rg.retailer_id = mn.retailer_id LEFT JOIN t_market_place mp ON rg.market_id = mp.market_id UNION (SELECT CONCAT(IFNULL(rg2.recognize_ids, ''), '|', mn2.recognize_ids) AS recognize_ids, CONCAT(IFNULL(rg2.trade_ids, ''), '|', mn2.trade_ids) AS trade_ids, mn2.stall_id, mn2.stall_code, mn2.stall_name, mn2.pick_date, CONCAT(IFNULL(rg2.status, ''), '|', mn2.status) AS status, CONCAT(IFNULL(rg2.pick_ids, ''), '|', mn2.pick_ids) AS pick_ids, mn2.retailer_id, mn2.tattoo_code, mn2.plan_count, mn2.lay_count, mn2.hang_count, mn2.morning_count, mn2.head_count, mn2.whole_count, mn2.service_fee, mn2.pick_time, mn2.claim_slaughter_time, mn2.owner_ids, mn2.owner_code, mn2.owner_name, mn2.owner_phone, mn2.company_name, mn2.retailer_name, mn2.retailer_location, mn2.location, mn2.contact_phone, mn2.market_id, mn2.pig_fee, mn2.service_fee + mn2.pig_fee AS total_fee, mn2.order_no, mn2.pay_way, mn2.integral, mn2.distributor_id, mn2.distributor_name, mn2.distributor_phone, mp.market_code, mp.market_name, mn2.default_plan_time FROM (SELECT GROUP_CONCAT(DISTINCT pr.recognize_id SEPARATOR ',') AS recognize_ids, GROUP_CONCAT(DISTINCT pr.trade_id SEPARATOR ',') AS trade_ids, pr.stall_id, GROUP_CONCAT(DISTINCT pr.stall_code SEPARATOR ',') AS stall_code, GROUP_CONCAT(DISTINCT pr.stall_name SEPARATOR ',') AS stall_name, pr.pick_date, GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status, GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, GROUP_CONCAT(DISTINCT pp.tattoo_code SEPARATOR ',') AS tattoo_code, IFNULL(SUM(pp.plan_count), 0) AS plan_count, IFNULL(SUM(pp.lay_count), 0) AS lay_count, IFNULL(SUM(pp.hang_count), 0) AS hang_count, IFNULL(SUM(pp.morning_count), 0) AS morning_count, IFNULL(SUM(pp.head_count), 0) AS head_count, IFNULL(SUM(pp.whole_count), 0) AS whole_count, IFNULL(SUM(pp.service_fee), 0) AS service_fee, MAX(pp.create_time) AS pick_time, MAX(pp.claim_slaughter_time) AS claim_slaughter_time, GROUP_CONCAT(DISTINCT st.owner_id SEPARATOR ',') AS owner_ids, GROUP_CONCAT(DISTINCT st.owner_code SEPARATOR ',') AS owner_code, GROUP_CONCAT(DISTINCT st.owner_name SEPARATOR ',') AS owner_name, GROUP_CONCAT(DISTINCT st.owner_phone SEPARATOR ',') AS owner_phone, GROUP_CONCAT(DISTINCT st.company_name SEPARATOR ',') AS company_name, GROUP_CONCAT(DISTINCT ri.retailer_name SEPARATOR ',') AS retailer_name, MAX(ri.retailer_location) AS retailer_location, MAX(ri.location) AS location, GROUP_CONCAT(DISTINCT ri.contact_phone SEPARATOR ',') AS contact_phone, ri.market_id, IFNULL(SUM(pp.pig_fee), 0) AS pig_fee, rit.integral, di.distributor_id, di.distributor_name, di.distributor_phone, MAX(ri.default_plan_time) AS default_plan_time FROM t_pick_recognize pr JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id LEFT JOIN t_slaughter_trade st ON pr.trade_id = st.trade_id LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id LEFT JOIN t_retailer_integral rit ON pp.retailer_id = rit.retailer_id LEFT JOIN t_distributor_info di ON ri.distributor_id = di.distributor_id LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id WHERE pr.status = 'submitted' AND pr.pick_date >= '2025-01-02 16:00:00' AND pr.pick_date <= '2025-01-03 15:59:59.999' AND pr.stall_id = 7 AND pr.is_delete = 0 AND pp.is_delete = 0 AND isnull(pp.relate_pick_id) = 1 GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone) rg2 RIGHT JOIN (SELECT GROUP_CONCAT(DISTINCT pr.recognize_id SEPARATOR ',') AS recognize_ids, GROUP_CONCAT(DISTINCT pr.trade_id SEPARATOR ',') AS trade_ids, pr.stall_id, GROUP_CONCAT(DISTINCT pr.stall_code SEPARATOR ',') AS stall_code","ts":"2025-01-03T02:15:01"},"fingerprint":"select count(?) from (select concat(rg.recognize_ids, ?, ifnull(mn.recognize_ids, ?)) as recognize_ids, concat(rg.trade_ids, ?, ifnull(mn.trade_ids, ?)) as trade_ids, rg.stall_id, rg.stall_code, rg.stall_name, rg.pick_date, concat(rg.status, ?, ifnull(mn.status, ?)) as status, concat(rg.pick_ids, ?, ifnull(mn.pick_ids, ?)) as pick_ids, rg.retailer_id, rg.tattoo_code, if(mn.stall_id is ? or rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) ? if(mn.stall_id is ? or rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) as plan_count, if(mn.stall_id is ? or rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) as lay_count, if(mn.stall_id is ? or rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) as hang_count, if(mn.stall_id is ?, rg.morning_count, mn.morning_count) as morning_count, rg.head_count, rg.whole_count, rg.service_fee, rg.pick_time, rg.claim_slaughter_time, rg.owner_ids, rg.owner_code, rg.owner_name, rg.owner_phone, rg.company_name, rg.retailer_name, rg.retailer_location, rg.location, rg.contact_phone, rg.market_id, rg.pig_fee, rg.service_fee ? rg.pig_fee as total_fee, rg.order_no, rg.pay_way, rg.integral, rg.distributor_id, rg.distributor_name, rg.distributor_phone, mp.market_code, mp.market_name, rg.default_plan_time from (select group_concat(distinct pr.recognize_id separator ?) as recognize_ids, group_concat(distinct pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(distinct pr.stall_code separator ?) as stall_code, group_concat(distinct pr.stall_name separator ?) as stall_name, pr.pick_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, group_concat(distinct pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.plan_count), ?) as plan_count, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(sum(pp.morning_count), ?) as morning_count, ifnull(sum(pp.head_count), ?) as head_count, ifnull(sum(pp.whole_count), ?) as whole_count, ifnull(sum(pp.service_fee), ?) as service_fee, max(pp.create_time) as pick_time, max(pp.claim_slaughter_time) as claim_slaughter_time, group_concat(distinct st.owner_id separator ?) as owner_ids, group_concat(distinct st.owner_code separator ?) as owner_code, group_concat(distinct st.owner_name separator ?) as owner_name, group_concat(distinct st.owner_phone separator ?) as owner_phone, group_concat(distinct st.company_name separator ?) as company_name, group_concat(distinct ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, max(ri.location) as location, group_concat(distinct ri.contact_phone separator ?) as contact_phone, ri.market_id, ifnull(sum(pp.pig_fee), ?) as pig_fee, rit.integral, di.distributor_id, di.distributor_name, di.distributor_phone, max(ri.default_plan_time) as default_plan_time from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id left join t_slaughter_trade st on pr.trade_id = st.trade_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_retailer_integral rit on pp.retailer_id = rit.retailer_id left join t_distributor_info di on ri.distributor_id = di.distributor_id left join t_market_place mp on ri.market_id = mp.market_id where pr.status = ? and pr.pick_date >= ? and pr.pick_date <= ? and pr.stall_id = ? and pr.is_delete = ? and pp.is_delete = ? and isnull(pp.relate_pick_id) = ? group by pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone) rg left join (select group_concat(distinct pr.recognize_id separator ?) as recognize_ids, group_concat(distinct pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(distinct pr.stall_code separator ?) as stall_code, group_concat(distinct pr.stall_name separator ?) as stall_name, pr.pick_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, group_concat(distinct pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.plan_count), ?) as plan_count, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(sum(pp.morning_count), ?) as morning_count, ifnull(sum(pp.head_count), ?) as head_count, ifnull(sum(pp.whole_count), ?) as whole_count, ifnull(sum(pp.service_fee), ?) as service_fee, max(pp.create_time) as pick_time, max(pp.claim_slaughter_time) as claim_slaughter_time, group_concat(distinct st.owner_id separator ?) as owner_ids, group_concat(distinct st.owner_code separator ?) as owner_code, group_concat(distinct st.owner_name separator ?) as owner_name, group_concat(distinct st.owner_phone separator ?) as owner_phone, group_concat(distinct st.company_name separator ?) as company_name, group_concat(distinct ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) ","histograms":{"Query_time":[0,0,0,0,0,0,40,0]},"metrics":{"Lock_time":{"avg":"0.000026","max":"0.000084","median":"0.000021","min":"0.000016","pct":"0.037736","pct_95":"0.000043","stddev":"0.000012","sum":"0.001023"},"Query_length":{"avg":"12436","max":"12437","median":"12192","min":"12433","pct":"0","pct_95":"12192","stddev":"0","sum":"497448"},"Query_time":{"avg":"4.043017","max":"5.045156","median":"3.889305","min":"3.639086","pct":"0.037736","pct_95":"4.083770","stddev":"0.205547","sum":"161.720670"},"Rows_examined":{"avg":"49","max":"117","median":"38","min":"5","pct":"0","pct_95":"112","stddev":"25","sum":"1995"},"Rows_sent":{"avg":"1","max":"1","median":"1","min":"1","pct":"0","pct_95":"1","stddev":"0","sum":"40"},"db":{"value":"pz_wsnh_prod"},"host":{"value":"192.168.5.243"},"user":{"value":"pz_wsnh"}},"query_count":40,"tables":[{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pick_recognize`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pick_recognize'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pig_pick`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pig_pick'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_slaughter_trade`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_slaughter_trade'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_integral`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_integral'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_distributor_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_distributor_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_market_place`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_market_place'\\G"}],"ts_max":"2025-01-03T04:47:51","ts_min":"2025-01-03T02:14:39"},{"attribute":"fingerprint","checksum":"9BD69500AA201373B22E64B1B17F62E2","distillate":"SELECT UNION t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place","example":{"Query_time":"4.718487","query":"SELECT temp.*\n        FROM ( \n         \n\n        SELECT CONCAT(rg.recognize_ids, '|', IFNULL(mn.recognize_ids, '')) AS recognize_ids,\n            CONCAT(rg.trade_ids, '|', IFNULL(mn.trade_ids, '')) AS trade_ids,\n            rg.stall_id,\n            rg.stall_code,\n            rg.stall_name,\n            rg.pick_date,\n            CONCAT(rg.status, '|', IFNULL(mn.status, '')) AS status,\n            CONCAT(rg.pick_ids, '|', IFNULL(mn.pick_ids, '')) AS pick_ids,\n            rg.retailer_id,\n            rg.tattoo_code,\n            IF(mn.stall_id IS NULL OR rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count)\n                + IF(mn.stall_id IS NULL OR rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count)\n            AS plan_count,\n            IF(mn.stall_id IS NULL OR rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) AS lay_count,\n            IF(mn.stall_id IS NULL OR rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) AS hang_count,\n            IF(mn.stall_id IS NULL, rg.morning_count, mn.morning_count) AS morning_count,\n            rg.head_count,\n            rg.whole_count,\n            rg.service_fee,\n            rg.pick_time,\n            rg.claim_slaughter_time,\n            rg.owner_ids,\n            rg.owner_code,\n            rg.owner_name,\n            rg.owner_phone,\n            rg.company_name,\n            rg.retailer_name,\n            rg.retailer_location,\n            rg.location,\n            rg.contact_phone,\n            rg.market_id,\n            rg.pig_fee,\n            rg.service_fee + rg.pig_fee AS total_fee,\n            rg.order_no,\n            rg.pay_way,\n            rg.integral,\n            rg.distributor_id,\n            rg.distributor_name,\n            rg.distributor_phone,\n            mp.market_code,\n            mp.market_name,\n            rg.default_plan_time\n        FROM ( \n        SELECT GROUP_CONCAT(DISTINCT pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(DISTINCT pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(DISTINCT pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(DISTINCT pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            pp.order_no,\n            pp.pay_way,\n            GROUP_CONCAT(DISTINCT pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.plan_count), 0) AS plan_count,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL(SUM(pp.morning_count), 0) AS morning_count,\n            IFNULL(SUM(pp.head_count), 0) AS head_count,\n            IFNULL(SUM(pp.whole_count), 0) AS whole_count,\n            IFNULL(SUM(pp.service_fee), 0) AS service_fee,\n            MAX(pp.create_time) AS pick_time,\n            MAX(pp.claim_slaughter_time) AS claim_slaughter_time,\n            GROUP_CONCAT(DISTINCT st.owner_id SEPARATOR ',') AS owner_ids,\n            GROUP_CONCAT(DISTINCT st.owner_code SEPARATOR ',') AS owner_code,\n            GROUP_CONCAT(DISTINCT st.owner_name SEPARATOR ',') AS owner_name,\n            GROUP_CONCAT(DISTINCT st.owner_phone SEPARATOR ',') AS owner_phone,\n            GROUP_CONCAT(DISTINCT st.company_name SEPARATOR ',') AS company_name,\n            GROUP_CONCAT(DISTINCT ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            MAX(ri.location) AS location,\n            GROUP_CONCAT(DISTINCT ri.contact_phone SEPARATOR ',') AS contact_phone,\n            ri.market_id,\n            IFNULL(SUM(pp.pig_fee), 0) AS pig_fee,\n            rit.integral,\n            di.distributor_id,\n            di.distributor_name,\n            di.distributor_phone,\n            MAX(ri.default_plan_time) AS default_plan_time\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_slaughter_trade st ON pr.trade_id = st.trade_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_retailer_integral rit ON pp.retailer_id = rit.retailer_id\n            LEFT JOIN t_distributor_info di ON ri.distributor_id = di.distributor_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n         WHERE pr.status = 'submitted'\n            \n        \n            and pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            and pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n        \n        \n        \n        \n        \n        \n            AND pr.stall_id = 7\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.is_delete = 0\n        AND pp.is_delete = 0\n    \n            AND isnull(pp.relate_pick_id) = 1 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone\n     ) rg\n            LEFT JOIN ( \n        SELECT GROUP_CONCAT(DISTINCT pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(DISTINCT pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(DISTINCT pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(DISTINCT pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            pp.order_no,\n            pp.pay_way,\n            GROUP_CONCAT(DISTINCT pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.plan_count), 0) AS plan_count,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL(SUM(pp.morning_count), 0) AS morning_count,\n            IFNULL(SUM(pp.head_count), 0) AS head_count,\n            IFNULL(SUM(pp.whole_count), 0) AS whole_count,\n            IFNULL(SUM(pp.service_fee), 0) AS service_fee,\n            MAX(pp.create_time) AS pick_time,\n            MAX(pp.claim_slaughter_time) AS claim_slaughter_time,\n            GROUP_CONCAT(DISTINCT st.owner_id SEPARATOR ',') AS owner_ids,\n            GROUP_CONCAT(DISTINCT st.owner_code SEPARATOR ',') AS owner_code,\n            GROUP_CONCAT(DISTINCT st.owner_name SEPARATOR ',') AS owner_name,\n            GROUP_CONCAT(DISTINCT st.owner_phone SEPARATOR ',') AS owner_phone,\n            GROUP_CONCAT(DISTINCT st.company_name SEPARATOR ',') AS company_name,\n            GROUP_CONCAT(DISTINCT ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            MAX(ri.location) AS location,\n            GROUP_CONCAT(DISTINCT ri.contact_phone SEPARATOR ',') AS contact_phone,\n            ri.market_id,\n            IFNULL(SUM(pp.pig_fee), 0) AS pig_fee,\n            rit.integral,\n            di.distributor_id,\n            di.distributor_name,\n            di.distributor_phone,\n            MAX(ri.default_plan_time) AS default_plan_time\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_slaughter_trade st ON pr.trade_id = st.trade_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_retailer_integral rit ON pp.retailer_id = rit.retailer_id\n            LEFT JOIN t_distributor_info di ON ri.distributor_id = di.distributor_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n         WHERE pr.status = 'morningpick'\n            \n        \n            and pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            and pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n        \n        \n        \n        \n        \n        \n            AND pr.stall_id = 7\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.is_delete = 0\n        AND pp.is_delete = 0\n    \n            AND isnull(pp.relate_pick_id) = 1 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone\n     ) mn\n                ON rg.stall_id = mn.stall_id AND rg.pick_date = mn.pick_date AND rg.retailer_id = mn.retailer_id\n            LEFT JOIN t_market_place mp ON rg.market_id = mp.market_id\n        UNION (\n            SELECT CONCAT(IFNULL(rg2.recognize_ids, ''), '|', mn2.recognize_ids) AS recognize_ids,\n                CONCAT(IFNULL(rg2.trade_ids, ''), '|', mn2.trade_ids) AS trade_ids,\n                mn2.stall_id,\n                mn2.stall_code,\n                mn2.stall_name,\n                mn2.pick_date,\n                CONCAT(IFNULL(rg2.status, ''), '|', mn2.status) AS status,\n                CONCAT(IFNULL(rg2.pick_ids, ''), '|', mn2.pick_ids) AS pick_ids,\n                mn2.retailer_id,\n                mn2.tattoo_code,\n                mn2.plan_count,\n                mn2.lay_count,\n                mn2.hang_count,\n                mn2.morning_count,\n                mn2.head_count,\n                mn2.whole_count,\n                mn2.service_fee,\n                mn2.pick_time,\n                mn2.claim_slaughter_time,\n                mn2.owner_ids,\n                mn2.owner_code,\n                mn2.owner_name,\n                mn2.owner_phone,\n                mn2.company_name,\n                mn2.retailer_name,\n                mn2.retailer_location,\n                mn2.location,\n                mn2.contact_phone,\n                mn2.market_id,\n                mn2.pig_fee,\n                mn2.service_fee + mn2.pig_fee AS total_fee,\n                mn2.order_no,\n                mn2.pay_way,\n                mn2.integral,\n                mn2.distributor_id,\n                mn2.distributor_name","ts":"2025-01-03T02:15:05"},"fingerprint":"select temp.* from ( select concat(rg.recognize_ids, ?, ifnull(mn.recognize_ids, ?)) as recognize_ids, concat(rg.trade_ids, ?, ifnull(mn.trade_ids, ?)) as trade_ids, rg.stall_id, rg.stall_code, rg.stall_name, rg.pick_date, concat(rg.status, ?, ifnull(mn.status, ?)) as status, concat(rg.pick_ids, ?, ifnull(mn.pick_ids, ?)) as pick_ids, rg.retailer_id, rg.tattoo_code, if(mn.stall_id is ? or rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) ? if(mn.stall_id is ? or rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) as plan_count, if(mn.stall_id is ? or rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) as lay_count, if(mn.stall_id is ? or rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) as hang_count, if(mn.stall_id is ?, rg.morning_count, mn.morning_count) as morning_count, rg.head_count, rg.whole_count, rg.service_fee, rg.pick_time, rg.claim_slaughter_time, rg.owner_ids, rg.owner_code, rg.owner_name, rg.owner_phone, rg.company_name, rg.retailer_name, rg.retailer_location, rg.location, rg.contact_phone, rg.market_id, rg.pig_fee, rg.service_fee ? rg.pig_fee as total_fee, rg.order_no, rg.pay_way, rg.integral, rg.distributor_id, rg.distributor_name, rg.distributor_phone, mp.market_code, mp.market_name, rg.default_plan_time from ( select group_concat(distinct pr.recognize_id separator ?) as recognize_ids, group_concat(distinct pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(distinct pr.stall_code separator ?) as stall_code, group_concat(distinct pr.stall_name separator ?) as stall_name, pr.pick_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, group_concat(distinct pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.plan_count), ?) as plan_count, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(sum(pp.morning_count), ?) as morning_count, ifnull(sum(pp.head_count), ?) as head_count, ifnull(sum(pp.whole_count), ?) as whole_count, ifnull(sum(pp.service_fee), ?) as service_fee, max(pp.create_time) as pick_time, max(pp.claim_slaughter_time) as claim_slaughter_time, group_concat(distinct st.owner_id separator ?) as owner_ids, group_concat(distinct st.owner_code separator ?) as owner_code, group_concat(distinct st.owner_name separator ?) as owner_name, group_concat(distinct st.owner_phone separator ?) as owner_phone, group_concat(distinct st.company_name separator ?) as company_name, group_concat(distinct ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, max(ri.location) as location, group_concat(distinct ri.contact_phone separator ?) as contact_phone, ri.market_id, ifnull(sum(pp.pig_fee), ?) as pig_fee, rit.integral, di.distributor_id, di.distributor_name, di.distributor_phone, max(ri.default_plan_time) as default_plan_time from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id left join t_slaughter_trade st on pr.trade_id = st.trade_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_retailer_integral rit on pp.retailer_id = rit.retailer_id left join t_distributor_info di on ri.distributor_id = di.distributor_id left join t_market_place mp on ri.market_id = mp.market_id where pr.status = ? and pr.pick_date >= ? and pr.pick_date <= ? and pr.stall_id = ? and pr.is_delete = ? and pp.is_delete = ? and isnull(pp.relate_pick_id) = ? group by pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone ) rg left join ( select group_concat(distinct pr.recognize_id separator ?) as recognize_ids, group_concat(distinct pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(distinct pr.stall_code separator ?) as stall_code, group_concat(distinct pr.stall_name separator ?) as stall_name, pr.pick_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, group_concat(distinct pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.plan_count), ?) as plan_count, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(sum(pp.morning_count), ?) as morning_count, ifnull(sum(pp.head_count), ?) as head_count, ifnull(sum(pp.whole_count), ?) as whole_count, ifnull(sum(pp.service_fee), ?) as service_fee, max(pp.create_time) as pick_time, max(pp.claim_slaughter_time) as claim_slaughter_time, group_concat(distinct st.owner_id separator ?) as owner_ids, group_concat(distinct st.owner_code separator ?) as owner_code, group_concat(distinct st.owner_name separator ?) as owner_name, group_concat(distinct st.owner_phone separator ?) as owner_phone, group_concat(distinct st.company_name separator ?) as company_name, group_concat(distinct ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location","histograms":{"Query_time":[0,0,0,0,0,0,40,0]},"metrics":{"Lock_time":{"avg":"0.000022","max":"0.000036","median":"0.000021","min":"0.000013","pct":"0.037736","pct_95":"0.000032","stddev":"0.000005","sum":"0.000875"},"Query_length":{"avg":"17102","max":"17103","median":"16339","min":"17099","pct":"0","pct_95":"16339","stddev":"0","sum":"684088"},"Query_time":{"avg":"4.041125","max":"4.718487","median":"3.889305","min":"3.474835","pct":"0.037736","pct_95":"4.287959","stddev":"0.192649","sum":"161.645002"},"Rows_examined":{"avg":"98","max":"217","median":"76","min":"10","pct":"0","pct_95":"212","stddev":"47","sum":"3922"},"Rows_sent":{"avg":"48","max":"100","median":"38","min":"5","pct":"0","pct_95":"97","stddev":"21","sum":"1927"},"db":{"value":"pz_wsnh_prod"},"host":{"value":"192.168.5.243"},"user":{"value":"pz_wsnh"}},"query_count":40,"tables":[{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pick_recognize`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pick_recognize'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pig_pick`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pig_pick'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_slaughter_trade`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_slaughter_trade'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_integral`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_integral'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_distributor_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_distributor_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_market_place`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_market_place'\\G"}],"ts_max":"2025-01-03T04:47:55","ts_min":"2025-01-03T02:14:43"},{"attribute":"fingerprint","checksum":"31D972F367F5F4399C74D91F30FD4763","distillate":"SELECT t_pig_tally","example":{"Query_time":"13.307361","query":"SELECT tt.tally_id,\n            pt.camera_id,\n            tt.start_time,\n            pt.end_time,\n            pt.place_type,\n            pt.place_id,\n            tt.tally_count,\n            tt.confirm_count,\n            pt.tally_pic,\n            pt.tally_video,\n            pt.remark,\n            pt.create_time,\n            pt.create_user,\n            pt.update_time,\n            pt.update_user\n        FROM (\n            SELECT MAX(tally_id) AS tally_id,\n                MIN(start_time) AS start_time,\n                place_type,\n                place_id,\n                SUM(tally_count) AS tally_count,\n                SUM(confirm_count) AS confirm_count\n            FROM t_pig_tally\n             WHERE  place_type = 'line_count'\n                \n                \n                    AND place_id IN\n                    (1,2,3)\n                \n                \n                    AND start_time >= '2025-01-02 21:00:00' AND (end_time IS NULL OR end_time >= '2025-01-02 21:00:00')\n                \n                \n                    AND start_time <= '2025-01-03 12:50:16.199' AND (end_time IS NULL OR end_time <= '2025-01-03 12:50:16.199')\n                \n                AND is_delete = 0 \n            GROUP BY place_type, place_id\n        ) tt JOIN t_pig_tally pt ON tt.tally_id = pt.tally_id","ts":"2025-01-03T12:50:29"},"fingerprint":"select tt.tally_id, pt.camera_id, tt.start_time, pt.end_time, pt.place_type, pt.place_id, tt.tally_count, tt.confirm_count, pt.tally_pic, pt.tally_video, pt.remark, pt.create_time, pt.create_user, pt.update_time, pt.update_user from ( select max(tally_id) as tally_id, min(start_time) as start_time, place_type, place_id, sum(tally_count) as tally_count, sum(confirm_count) as confirm_count from t_pig_tally where place_type = ? and place_id in(?+) and start_time >= ? and (end_time is ? or end_time >= ?) and start_time <= ? and (end_time is ? or end_time <= ?) and is_delete = ? group by place_type, place_id ) tt join t_pig_tally pt on tt.tally_id = pt.tally_id","histograms":{"Query_time":[0,0,0,0,0,0,23,3]},"metrics":{"Lock_time":{"avg":"0.000004","max":"0.000009","median":"0.000004","min":"0.000002","pct":"0.024528","pct_95":"0.000005","stddev":"0.000001","sum":"0.000106"},"Query_length":{"avg":"1303","max":"1305","median":"1292","min":"1301","pct":"0","pct_95":"1292","stddev":"0","sum":"33888"},"Query_time":{"avg":"5.367857","max":"13.307361","median":"3.805742","min":"2.032652","pct":"0.024528","pct_95":"11.946093","stddev":"3.566371","sum":"139.564286"},"Rows_examined":{"avg":"0","max":"0","median":"0","min":"0","pct":"0","pct_95":"0","stddev":"0","sum":"0"},"Rows_sent":{"avg":"0","max":"0","median":"0","min":"0","pct":"0","pct_95":"0","stddev":"0","sum":"0"},"db":{"value":"wsnh_prod"},"host":{"value":"192.168.5.243"},"user":{"value":"wsnh"}},"query_count":26,"tables":[{"create":"SHOW CREATE TABLE `wsnh_prod`.`t_pig_tally`\\G","status":"SHOW TABLE STATUS FROM `wsnh_prod` LIKE 't_pig_tally'\\G"}],"ts_max":"2025-01-03T15:38:42","ts_min":"2025-01-02T18:59:52"},{"attribute":"fingerprint","checksum":"E821731C784FC7C46A7D191578778E4A","distillate":"SELECT UNION t_pick_recognize t_pig_pick t_retailer_info t_market_place t_bill_print t_pick_recognize t_pig_pick t_retailer_info t_market_place t_bill_print t_pick_recognize t_pig_pick t_retailer_info t_market_place t_bill_print","example":{"Query_time":"14.078201","query":"select count(0) from ( \nSELECT GROUP_CONCAT(gb.recognize_ids SEPARATOR '+') AS recognize_ids,\n            GROUP_CONCAT(gb.trade_ids SEPARATOR '+') AS trade_ids,\n            GROUP_CONCAT(gb.stall_id SEPARATOR ',') AS stall_ids,\n            GROUP_CONCAT(gb.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(gb.stall_name SEPARATOR ',') AS stall_name,\n            gb.bill_date,\n            GROUP_CONCAT(gb.pick_ids SEPARATOR ',') AS pick_ids,\n            gb.retailer_id,\n            GROUP_CONCAT(gb.tattoo_code SEPARATOR ',') AS tattoo_code,\n            SUM(gb.purchase_count) AS purchase_count,\n            SUM(gb.dead_pig_count) AS dead_pig_count,\n            GROUP_CONCAT(gb.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(gb.retailer_location) AS retailer_location,\n            GROUP_CONCAT(gb.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(gb.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(gb.print_status SEPARATOR ',') AS print_status,\n            SUM(gb.print_count) AS print_count,\n            MAX(gb.print_time) AS print_time,\n            MAX(gb.retailer_mark) AS retailer_mark\n        FROM (\n            (\n                 \n        SELECT CONCAT(rg.recognize_ids, '|', IFNULL(mn.recognize_ids, '')) AS recognize_ids,\n            CONCAT(rg.trade_ids, '|', IFNULL(mn.trade_ids, '')) AS trade_ids,\n            rg.stall_id,\n            rg.stall_code,\n            rg.stall_name,\n            rg.bill_date,\n            rg.status,\n            rg.pick_ids,\n            rg.retailer_id,\n            rg.tattoo_code,\n            IF(rg.lay_count + rg.hang_count - IF(mn.stall_id IS NULL, 0, mn.lay_count + mn.hang_count) >= 0,\n                rg.lay_count + rg.hang_count - IF(mn.stall_id IS NULL, 0, mn.lay_count + mn.hang_count), 0) AS purchase_count,\n            rg.lay_count,\n            rg.hang_count,\n            rg.dead_pig_count,\n            \n            rg.retailer_name,\n            rg.retailer_location,\n            rg.contact_phone,\n            rg.market_name,\n            rg.print_status,\n            IF(rg.print_count - IF(mn.stall_id IS NULL, 0, mn.print_count) >= 0,\n                rg.print_count - IF(mn.stall_id IS NULL, 0, mn.print_count), 0) AS print_count,\n            rg.print_time,\n            rg.retailer_mark\n        FROM (\n             \n        SELECT GROUP_CONCAT(pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date AS bill_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            GROUP_CONCAT(pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL((\n                    \n                    0\n            ), 0) AS dead_pig_count,\n            GROUP_CONCAT(ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            GROUP_CONCAT(ri.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(mp.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(bp.print_status SEPARATOR ',') AS print_status,\n            SUM(IF(bp.print_status = '1', IFNULL(pp.lay_count, 0) + IFNULL(pp.hang_count, 0), 0)) AS print_count,\n            MAX(bp.print_time) AS print_time,\n            MAX(ri.retailer_mark) AS retailer_mark\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n            LEFT JOIN t_bill_print bp ON pp.pick_id = bp.pick_id AND bp.is_delete = 0\n         WHERE  pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            AND pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.status = 'submitted' AND pr.is_delete = 0\n        AND pp.retailer_id > 0 AND pp.is_delete = 0 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id\n     \n        ) rg LEFT JOIN (\n             \n        SELECT GROUP_CONCAT(pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date AS bill_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            GROUP_CONCAT(pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL((\n                    \n                    0\n            ), 0) AS dead_pig_count,\n            GROUP_CONCAT(ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            GROUP_CONCAT(ri.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(mp.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(bp.print_status SEPARATOR ',') AS print_status,\n            SUM(IF(bp.print_status = '1', IFNULL(pp.lay_count, 0) + IFNULL(pp.hang_count, 0), 0)) AS print_count,\n            MAX(bp.print_time) AS print_time,\n            MAX(ri.retailer_mark) AS retailer_mark\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n            LEFT JOIN t_bill_print bp ON pp.pick_id = bp.pick_id AND bp.is_delete = 0\n         WHERE  pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            AND pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.status = 'morningpick' AND pr.is_delete = 0\n        AND pp.retailer_id > 0 AND pp.is_delete = 0 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id\n     \n        ) mn ON rg.bill_date = mn.bill_date AND rg.stall_id = mn.stall_id AND rg.retailer_id = mn.retailer_id\n        HAVING purchase_count != 0 OR print_count != 0\n     \n            ) UNION (\n                 \n        SELECT CONCAT('|', mn2.recognize_ids) AS recognize_ids,\n            CONCAT('|', mn2.trade_ids) AS trade_ids,\n            mn2.stall_id,\n            mn2.stall_code,\n            mn2.stall_name,\n            mn2.bill_date,\n            mn2.status,\n            mn2.pick_ids,\n            mn2.retailer_id,\n            mn2.tattoo_code,\n            mn2.lay_count + mn2.hang_count AS purchase_count,\n            mn2.lay_count,\n            mn2.hang_count,\n            mn2.dead_pig_count,\n            \n            mn2.retailer_name,\n            mn2.retailer_location,\n            mn2.contact_phone,\n            mn2.market_name,\n            mn2.print_status,\n            mn2.print_count,\n            mn2.print_time,\n            mn2.retailer_mark\n        FROM (\n             \n        SELECT GROUP_CONCAT(pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date AS bill_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            GROUP_CONCAT(pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL((\n                    \n                    0\n            ), 0) AS dead_pig_count,\n            GROUP_CONCAT(ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            GROUP_CONCAT(ri.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(mp.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(bp.print_status SEPARATOR ',') AS print_status,\n            SUM(IF(bp.print_status = '1', IFNULL(pp.lay_count, 0) + IFNULL(pp.hang_count, 0), 0)) AS print_count,\n            MAX(bp.print_time) AS print_time,\n            MAX(ri.retailer_mark) AS retailer_mark\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n            LEFT JOIN t_bill_print bp ON pp.pick_id = bp.pick_id AND bp.is_delete = 0\n         WHERE  pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            AND pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.status = 'morningpick' AND pr.is_delete = 0\n        AND pp.retailer_id > 0 AND pp.is_delete = 0 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id\n     \n        ) mn2\n     \n            )\n        ) gb\n        GROUP BY gb.bill_date, gb.retailer_id\n     \n        ORDER BY bill_date DESC, tattoo_code ASC\n ) tmp_count","ts":"2025-01-03T04:47:14"},"fingerprint":"select count(?) from ( select group_concat(gb.recognize_ids separator ?) as recognize_ids, group_concat(gb.trade_ids separator ?) as trade_ids, group_concat(gb.stall_id separator ?) as stall_ids, group_concat(gb.stall_code separator ?) as stall_code, group_concat(gb.stall_name separator ?) as stall_name, gb.bill_date, group_concat(gb.pick_ids separator ?) as pick_ids, gb.retailer_id, group_concat(gb.tattoo_code separator ?) as tattoo_code, sum(gb.purchase_count) as purchase_count, sum(gb.dead_pig_count) as dead_pig_count, group_concat(gb.retailer_name separator ?) as retailer_name, max(gb.retailer_location) as retailer_location, group_concat(gb.contact_phone separator ?) as contact_phone, group_concat(gb.market_name separator ?) as market_name, group_concat(gb.print_status separator ?) as print_status, sum(gb.print_count) as print_count, max(gb.print_time) as print_time, max(gb.retailer_mark) as retailer_mark from ( ( select concat(rg.recognize_ids, ?, ifnull(mn.recognize_ids, ?)) as recognize_ids, concat(rg.trade_ids, ?, ifnull(mn.trade_ids, ?)) as trade_ids, rg.stall_id, rg.stall_code, rg.stall_name, rg.bill_date, rg.status, rg.pick_ids, rg.retailer_id, rg.tattoo_code, if(rg.lay_count ? rg.hang_count ? if(mn.stall_id is ?, ?, mn.lay_count ? mn.hang_count) >= ?, rg.lay_count ? rg.hang_count ? if(mn.stall_id is ?, ?, mn.lay_count ? mn.hang_count), ?) as purchase_count, rg.lay_count, rg.hang_count, rg.dead_pig_count, rg.retailer_name, rg.retailer_location, rg.contact_phone, rg.market_name, rg.print_status, if(rg.print_count ? if(mn.stall_id is ?, ?, mn.print_count) >= ?, rg.print_count ? if(mn.stall_id is ?, ?, mn.print_count), ?) as print_count, rg.print_time, rg.retailer_mark from ( select group_concat(pr.recognize_id separator ?) as recognize_ids, group_concat(pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(pr.stall_code separator ?) as stall_code, group_concat(pr.stall_name separator ?) as stall_name, pr.pick_date as bill_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, group_concat(pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(( ? ), ?) as dead_pig_count, group_concat(ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, group_concat(ri.contact_phone separator ?) as contact_phone, group_concat(mp.market_name separator ?) as market_name, group_concat(bp.print_status separator ?) as print_status, sum(if(bp.print_status = ?, ifnull(pp.lay_count, ?) ? ifnull(pp.hang_count, ?), ?)) as print_count, max(bp.print_time) as print_time, max(ri.retailer_mark) as retailer_mark from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_market_place mp on ri.market_id = mp.market_id left join t_bill_print bp on pp.pick_id = bp.pick_id and bp.is_delete = ? where pr.pick_date >= ? and pr.pick_date <= ? and pr.status = ? and pr.is_delete = ? and pp.retailer_id > ? and pp.is_delete = ? group by pr.pick_date, pr.stall_id, pp.retailer_id ) rg left join ( select group_concat(pr.recognize_id separator ?) as recognize_ids, group_concat(pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(pr.stall_code separator ?) as stall_code, group_concat(pr.stall_name separator ?) as stall_name, pr.pick_date as bill_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, group_concat(pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(( ? ), ?) as dead_pig_count, group_concat(ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, group_concat(ri.contact_phone separator ?) as contact_phone, group_concat(mp.market_name separator ?) as market_name, group_concat(bp.print_status separator ?) as print_status, sum(if(bp.print_status = ?, ifnull(pp.lay_count, ?) ? ifnull(pp.hang_count, ?), ?)) as print_count, max(bp.print_time) as print_time, max(ri.retailer_mark) as retailer_mark from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_market_place mp on ri.market_id = mp.market_id left join t_bill_print bp on pp.pick_id = bp.pick_id and bp.is_delete = ? where pr.pick_date >= ? and pr.pick_date <= ? and pr.status = ? and pr.is_delete = ? and pp.retailer_id > ? and pp.is_delete = ? group by pr.pick_date, pr.stall_id, pp.retailer_id ) mn on rg.bill_date = mn.bill_date and rg.stall_id = mn.stall_id and rg.retailer_id = mn.retailer_id having purchase_count != ? or print_count != ? ) union ( select concat(?, mn?recognize_ids) as recognize_ids, concat(?, mn?trade_ids) as trade_ids, mn?stall_id, mn?stall_code, mn?stall_name,","histograms":{"Query_time":[0,0,0,0,0,0,5,9]},"metrics":{"Lock_time":{"avg":"0.000028","max":"0.000099","median":"0.000019","min":"0.000011","pct":"0.013208","pct_95":"0.000077","stddev":"0.000025","sum":"0.000396"},"Query_length":{"avg":"9772","max":"9772","median":"9772","min":"9772","pct":"0","pct_95":"9772","stddev":"0","sum":"136808"},"Query_time":{"avg":"9.902383","max":"14.078201","median":"9.828080","min":"6.264070","pct":"0.013208","pct_95":"13.170567","stddev":"2.521184","sum":"138.633357"},"Rows_examined":{"avg":"274","max":"637","median":"202","min":"9","pct":"0","pct_95":"592","stddev":"229","sum":"3843"},"Rows_sent":{"avg":"1","max":"1","median":"1","min":"1","pct":"0","pct_95":"1","stddev":"0","sum":"14"},"db":{"value":"pz_wsnh_prod"},"host":{"value":"192.168.5.243"},"user":{"value":"pz_wsnh"}},"query_count":14,"tables":[{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pick_recognize`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pick_recognize'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pig_pick`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pig_pick'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_market_place`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_market_place'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_bill_print`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_bill_print'\\G"}],"ts_max":"2025-01-03T06:07:39","ts_min":"2025-01-03T00:20:47"},{"attribute":"fingerprint","checksum":"325AF5126400774B4438E8363647DE10","distillate":"SELECT UNION t_pick_recognize t_pig_pick t_retailer_info t_market_place t_bill_print t_pick_recognize t_pig_pick t_retailer_info t_market_place t_bill_print t_pick_recognize t_pig_pick t_retailer_info t_market_place t_bill_print","example":{"Query_time":"15.472361","query":"SELECT GROUP_CONCAT(gb.recognize_ids SEPARATOR '+') AS recognize_ids,\n            GROUP_CONCAT(gb.trade_ids SEPARATOR '+') AS trade_ids,\n            GROUP_CONCAT(gb.stall_id SEPARATOR ',') AS stall_ids,\n            GROUP_CONCAT(gb.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(gb.stall_name SEPARATOR ',') AS stall_name,\n            gb.bill_date,\n            GROUP_CONCAT(gb.pick_ids SEPARATOR ',') AS pick_ids,\n            gb.retailer_id,\n            GROUP_CONCAT(gb.tattoo_code SEPARATOR ',') AS tattoo_code,\n            SUM(gb.purchase_count) AS purchase_count,\n            SUM(gb.dead_pig_count) AS dead_pig_count,\n            GROUP_CONCAT(gb.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(gb.retailer_location) AS retailer_location,\n            GROUP_CONCAT(gb.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(gb.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(gb.print_status SEPARATOR ',') AS print_status,\n            SUM(gb.print_count) AS print_count,\n            MAX(gb.print_time) AS print_time,\n            MAX(gb.retailer_mark) AS retailer_mark\n        FROM (\n            (\n                 \n        SELECT CONCAT(rg.recognize_ids, '|', IFNULL(mn.recognize_ids, '')) AS recognize_ids,\n            CONCAT(rg.trade_ids, '|', IFNULL(mn.trade_ids, '')) AS trade_ids,\n            rg.stall_id,\n            rg.stall_code,\n            rg.stall_name,\n            rg.bill_date,\n            rg.status,\n            rg.pick_ids,\n            rg.retailer_id,\n            rg.tattoo_code,\n            IF(rg.lay_count + rg.hang_count - IF(mn.stall_id IS NULL, 0, mn.lay_count + mn.hang_count) >= 0,\n                rg.lay_count + rg.hang_count - IF(mn.stall_id IS NULL, 0, mn.lay_count + mn.hang_count), 0) AS purchase_count,\n            rg.lay_count,\n            rg.hang_count,\n            rg.dead_pig_count,\n            \n            rg.retailer_name,\n            rg.retailer_location,\n            rg.contact_phone,\n            rg.market_name,\n            rg.print_status,\n            IF(rg.print_count - IF(mn.stall_id IS NULL, 0, mn.print_count) >= 0,\n                rg.print_count - IF(mn.stall_id IS NULL, 0, mn.print_count), 0) AS print_count,\n            rg.print_time,\n            rg.retailer_mark\n        FROM (\n             \n        SELECT GROUP_CONCAT(pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date AS bill_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            GROUP_CONCAT(pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL((\n                    \n                    0\n            ), 0) AS dead_pig_count,\n            GROUP_CONCAT(ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            GROUP_CONCAT(ri.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(mp.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(bp.print_status SEPARATOR ',') AS print_status,\n            SUM(IF(bp.print_status = '1', IFNULL(pp.lay_count, 0) + IFNULL(pp.hang_count, 0), 0)) AS print_count,\n            MAX(bp.print_time) AS print_time,\n            MAX(ri.retailer_mark) AS retailer_mark\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n            LEFT JOIN t_bill_print bp ON pp.pick_id = bp.pick_id AND bp.is_delete = 0\n         WHERE  pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            AND pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.status = 'submitted' AND pr.is_delete = 0\n        AND pp.retailer_id > 0 AND pp.is_delete = 0 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id\n     \n        ) rg LEFT JOIN (\n             \n        SELECT GROUP_CONCAT(pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date AS bill_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            GROUP_CONCAT(pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL((\n                    \n                    0\n            ), 0) AS dead_pig_count,\n            GROUP_CONCAT(ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            GROUP_CONCAT(ri.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(mp.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(bp.print_status SEPARATOR ',') AS print_status,\n            SUM(IF(bp.print_status = '1', IFNULL(pp.lay_count, 0) + IFNULL(pp.hang_count, 0), 0)) AS print_count,\n            MAX(bp.print_time) AS print_time,\n            MAX(ri.retailer_mark) AS retailer_mark\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n            LEFT JOIN t_bill_print bp ON pp.pick_id = bp.pick_id AND bp.is_delete = 0\n         WHERE  pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            AND pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.status = 'morningpick' AND pr.is_delete = 0\n        AND pp.retailer_id > 0 AND pp.is_delete = 0 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id\n     \n        ) mn ON rg.bill_date = mn.bill_date AND rg.stall_id = mn.stall_id AND rg.retailer_id = mn.retailer_id\n        HAVING purchase_count != 0 OR print_count != 0\n     \n            ) UNION (\n                 \n        SELECT CONCAT('|', mn2.recognize_ids) AS recognize_ids,\n            CONCAT('|', mn2.trade_ids) AS trade_ids,\n            mn2.stall_id,\n            mn2.stall_code,\n            mn2.stall_name,\n            mn2.bill_date,\n            mn2.status,\n            mn2.pick_ids,\n            mn2.retailer_id,\n            mn2.tattoo_code,\n            mn2.lay_count + mn2.hang_count AS purchase_count,\n            mn2.lay_count,\n            mn2.hang_count,\n            mn2.dead_pig_count,\n            \n            mn2.retailer_name,\n            mn2.retailer_location,\n            mn2.contact_phone,\n            mn2.market_name,\n            mn2.print_status,\n            mn2.print_count,\n            mn2.print_time,\n            mn2.retailer_mark\n        FROM (\n             \n        SELECT GROUP_CONCAT(pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date AS bill_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            GROUP_CONCAT(pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL((\n                    \n                    0\n            ), 0) AS dead_pig_count,\n            GROUP_CONCAT(ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            GROUP_CONCAT(ri.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(mp.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(bp.print_status SEPARATOR ',') AS print_status,\n            SUM(IF(bp.print_status = '1', IFNULL(pp.lay_count, 0) + IFNULL(pp.hang_count, 0), 0)) AS print_count,\n            MAX(bp.print_time) AS print_time,\n            MAX(ri.retailer_mark) AS retailer_mark\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n            LEFT JOIN t_bill_print bp ON pp.pick_id = bp.pick_id AND bp.is_delete = 0\n         WHERE  pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            AND pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.status = 'morningpick' AND pr.is_delete = 0\n        AND pp.retailer_id > 0 AND pp.is_delete = 0 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id\n     \n        ) mn2\n     \n            )\n        ) gb\n        GROUP BY gb.bill_date, gb.retailer_id\n     \n        ORDER BY bill_date DESC, tattoo_code ASC\n LIMIT 100","ts":"2025-01-03T04:47:30"},"fingerprint":"select group_concat(gb.recognize_ids separator ?) as recognize_ids, group_concat(gb.trade_ids separator ?) as trade_ids, group_concat(gb.stall_id separator ?) as stall_ids, group_concat(gb.stall_code separator ?) as stall_code, group_concat(gb.stall_name separator ?) as stall_name, gb.bill_date, group_concat(gb.pick_ids separator ?) as pick_ids, gb.retailer_id, group_concat(gb.tattoo_code separator ?) as tattoo_code, sum(gb.purchase_count) as purchase_count, sum(gb.dead_pig_count) as dead_pig_count, group_concat(gb.retailer_name separator ?) as retailer_name, max(gb.retailer_location) as retailer_location, group_concat(gb.contact_phone separator ?) as contact_phone, group_concat(gb.market_name separator ?) as market_name, group_concat(gb.print_status separator ?) as print_status, sum(gb.print_count) as print_count, max(gb.print_time) as print_time, max(gb.retailer_mark) as retailer_mark from ( ( select concat(rg.recognize_ids, ?, ifnull(mn.recognize_ids, ?)) as recognize_ids, concat(rg.trade_ids, ?, ifnull(mn.trade_ids, ?)) as trade_ids, rg.stall_id, rg.stall_code, rg.stall_name, rg.bill_date, rg.status, rg.pick_ids, rg.retailer_id, rg.tattoo_code, if(rg.lay_count ? rg.hang_count ? if(mn.stall_id is ?, ?, mn.lay_count ? mn.hang_count) >= ?, rg.lay_count ? rg.hang_count ? if(mn.stall_id is ?, ?, mn.lay_count ? mn.hang_count), ?) as purchase_count, rg.lay_count, rg.hang_count, rg.dead_pig_count, rg.retailer_name, rg.retailer_location, rg.contact_phone, rg.market_name, rg.print_status, if(rg.print_count ? if(mn.stall_id is ?, ?, mn.print_count) >= ?, rg.print_count ? if(mn.stall_id is ?, ?, mn.print_count), ?) as print_count, rg.print_time, rg.retailer_mark from ( select group_concat(pr.recognize_id separator ?) as recognize_ids, group_concat(pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(pr.stall_code separator ?) as stall_code, group_concat(pr.stall_name separator ?) as stall_name, pr.pick_date as bill_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, group_concat(pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(( ? ), ?) as dead_pig_count, group_concat(ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, group_concat(ri.contact_phone separator ?) as contact_phone, group_concat(mp.market_name separator ?) as market_name, group_concat(bp.print_status separator ?) as print_status, sum(if(bp.print_status = ?, ifnull(pp.lay_count, ?) ? ifnull(pp.hang_count, ?), ?)) as print_count, max(bp.print_time) as print_time, max(ri.retailer_mark) as retailer_mark from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_market_place mp on ri.market_id = mp.market_id left join t_bill_print bp on pp.pick_id = bp.pick_id and bp.is_delete = ? where pr.pick_date >= ? and pr.pick_date <= ? and pr.status = ? and pr.is_delete = ? and pp.retailer_id > ? and pp.is_delete = ? group by pr.pick_date, pr.stall_id, pp.retailer_id ) rg left join ( select group_concat(pr.recognize_id separator ?) as recognize_ids, group_concat(pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(pr.stall_code separator ?) as stall_code, group_concat(pr.stall_name separator ?) as stall_name, pr.pick_date as bill_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, group_concat(pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(( ? ), ?) as dead_pig_count, group_concat(ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, group_concat(ri.contact_phone separator ?) as contact_phone, group_concat(mp.market_name separator ?) as market_name, group_concat(bp.print_status separator ?) as print_status, sum(if(bp.print_status = ?, ifnull(pp.lay_count, ?) ? ifnull(pp.hang_count, ?), ?)) as print_count, max(bp.print_time) as print_time, max(ri.retailer_mark) as retailer_mark from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_market_place mp on ri.market_id = mp.market_id left join t_bill_print bp on pp.pick_id = bp.pick_id and bp.is_delete = ? where pr.pick_date >= ? and pr.pick_date <= ? and pr.status = ? and pr.is_delete = ? and pp.retailer_id > ? and pp.is_delete = ? group by pr.pick_date, pr.stall_id, pp.retailer_id ) mn on rg.bill_date = mn.bill_date and rg.stall_id = mn.stall_id and rg.retailer_id = mn.retailer_id having purchase_count != ? or print_count != ? ) union ( select concat(?, mn?recognize_ids) as recognize_ids, concat(?, mn?trade_ids) as trade_ids, mn?stall_id, mn?stall_code, mn?stall_name, mn?ill_date, mn?status","histograms":{"Query_time":[0,0,0,0,0,0,8,6]},"metrics":{"Lock_time":{"avg":"0.000009","max":"0.000017","median":"0.000009","min":"0.000006","pct":"0.013208","pct_95":"0.000014","stddev":"0.000003","sum":"0.000130"},"Query_length":{"avg":"9746","max":"9746","median":"9746","min":"9746","pct":"0","pct_95":"9746","stddev":"0","sum":"136444"},"Query_time":{"avg":"9.792341","max":"15.472361","median":"9.360076","min":"5.364740","pct":"0.013208","pct_95":"13.829096","stddev":"3.277720","sum":"137.092773"},"Rows_examined":{"avg":"730","max":"1664","median":"592","min":"27","pct":"0","pct_95":"1496","stddev":"584","sum":"10232"},"Rows_sent":{"avg":"71","max":"100","median":"97","min":"9","pct":"0","pct_95":"97","stddev":"37","sum":"1002"},"db":{"value":"pz_wsnh_prod"},"host":{"value":"192.168.5.243"},"user":{"value":"pz_wsnh"}},"query_count":14,"tables":[{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pick_recognize`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pick_recognize'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pig_pick`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pig_pick'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_market_place`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_market_place'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_bill_print`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_bill_print'\\G"}],"ts_max":"2025-01-03T06:07:47","ts_min":"2025-01-03T00:20:52"},{"attribute":"fingerprint","checksum":"906ED7DA5ECA0C7A3A53650551D4F1BD","distillate":"SELECT UNION t_pick_recognize t_pig_pick t_retailer_info t_market_place t_bill_print t_pick_recognize t_pig_pick t_retailer_info t_market_place t_bill_print t_pick_recognize t_pig_pick t_retailer_info t_market_place t_bill_print","example":{"Query_time":"13.360242","query":"SELECT GROUP_CONCAT(pick_ids SEPARATOR ',') AS pick_ids,\n            SUM(purchase_count) AS purchase_count,\n            SUM(dead_pig_count) AS dead_pig_count,\n            SUM(IF(print_count > purchase_count, purchase_count, print_count)) AS print_count,\n            MAX(print_time) AS print_time\n        FROM ( \n        SELECT GROUP_CONCAT(gb.recognize_ids SEPARATOR '+') AS recognize_ids,\n            GROUP_CONCAT(gb.trade_ids SEPARATOR '+') AS trade_ids,\n            GROUP_CONCAT(gb.stall_id SEPARATOR ',') AS stall_ids,\n            GROUP_CONCAT(gb.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(gb.stall_name SEPARATOR ',') AS stall_name,\n            gb.bill_date,\n            GROUP_CONCAT(gb.pick_ids SEPARATOR ',') AS pick_ids,\n            gb.retailer_id,\n            GROUP_CONCAT(gb.tattoo_code SEPARATOR ',') AS tattoo_code,\n            SUM(gb.purchase_count) AS purchase_count,\n            SUM(gb.dead_pig_count) AS dead_pig_count,\n            GROUP_CONCAT(gb.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(gb.retailer_location) AS retailer_location,\n            GROUP_CONCAT(gb.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(gb.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(gb.print_status SEPARATOR ',') AS print_status,\n            SUM(gb.print_count) AS print_count,\n            MAX(gb.print_time) AS print_time,\n            MAX(gb.retailer_mark) AS retailer_mark\n        FROM (\n            (\n                 \n        SELECT CONCAT(rg.recognize_ids, '|', IFNULL(mn.recognize_ids, '')) AS recognize_ids,\n            CONCAT(rg.trade_ids, '|', IFNULL(mn.trade_ids, '')) AS trade_ids,\n            rg.stall_id,\n            rg.stall_code,\n            rg.stall_name,\n            rg.bill_date,\n            rg.status,\n            rg.pick_ids,\n            rg.retailer_id,\n            rg.tattoo_code,\n            IF(rg.lay_count + rg.hang_count - IF(mn.stall_id IS NULL, 0, mn.lay_count + mn.hang_count) >= 0,\n                rg.lay_count + rg.hang_count - IF(mn.stall_id IS NULL, 0, mn.lay_count + mn.hang_count), 0) AS purchase_count,\n            rg.lay_count,\n            rg.hang_count,\n            rg.dead_pig_count,\n            \n            rg.retailer_name,\n            rg.retailer_location,\n            rg.contact_phone,\n            rg.market_name,\n            rg.print_status,\n            IF(rg.print_count - IF(mn.stall_id IS NULL, 0, mn.print_count) >= 0,\n                rg.print_count - IF(mn.stall_id IS NULL, 0, mn.print_count), 0) AS print_count,\n            rg.print_time,\n            rg.retailer_mark\n        FROM (\n             \n        SELECT GROUP_CONCAT(pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date AS bill_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            GROUP_CONCAT(pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL((\n                    \n                    0\n            ), 0) AS dead_pig_count,\n            GROUP_CONCAT(ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            GROUP_CONCAT(ri.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(mp.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(bp.print_status SEPARATOR ',') AS print_status,\n            SUM(IF(bp.print_status = '1', IFNULL(pp.lay_count, 0) + IFNULL(pp.hang_count, 0), 0)) AS print_count,\n            MAX(bp.print_time) AS print_time,\n            MAX(ri.retailer_mark) AS retailer_mark\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n            LEFT JOIN t_bill_print bp ON pp.pick_id = bp.pick_id AND bp.is_delete = 0\n         WHERE  pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            AND pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.status = 'submitted' AND pr.is_delete = 0\n        AND pp.retailer_id > 0 AND pp.is_delete = 0 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id\n     \n        ) rg LEFT JOIN (\n             \n        SELECT GROUP_CONCAT(pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date AS bill_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            GROUP_CONCAT(pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL((\n                    \n                    0\n            ), 0) AS dead_pig_count,\n            GROUP_CONCAT(ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            GROUP_CONCAT(ri.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(mp.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(bp.print_status SEPARATOR ',') AS print_status,\n            SUM(IF(bp.print_status = '1', IFNULL(pp.lay_count, 0) + IFNULL(pp.hang_count, 0), 0)) AS print_count,\n            MAX(bp.print_time) AS print_time,\n            MAX(ri.retailer_mark) AS retailer_mark\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n            LEFT JOIN t_bill_print bp ON pp.pick_id = bp.pick_id AND bp.is_delete = 0\n         WHERE  pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            AND pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.status = 'morningpick' AND pr.is_delete = 0\n        AND pp.retailer_id > 0 AND pp.is_delete = 0 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id\n     \n        ) mn ON rg.bill_date = mn.bill_date AND rg.stall_id = mn.stall_id AND rg.retailer_id = mn.retailer_id\n        HAVING purchase_count != 0 OR print_count != 0\n     \n            ) UNION (\n                 \n        SELECT CONCAT('|', mn2.recognize_ids) AS recognize_ids,\n            CONCAT('|', mn2.trade_ids) AS trade_ids,\n            mn2.stall_id,\n            mn2.stall_code,\n            mn2.stall_name,\n            mn2.bill_date,\n            mn2.status,\n            mn2.pick_ids,\n            mn2.retailer_id,\n            mn2.tattoo_code,\n            mn2.lay_count + mn2.hang_count AS purchase_count,\n            mn2.lay_count,\n            mn2.hang_count,\n            mn2.dead_pig_count,\n            \n            mn2.retailer_name,\n            mn2.retailer_location,\n            mn2.contact_phone,\n            mn2.market_name,\n            mn2.print_status,\n            mn2.print_count,\n            mn2.print_time,\n            mn2.retailer_mark\n        FROM (\n             \n        SELECT GROUP_CONCAT(pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date AS bill_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            GROUP_CONCAT(pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL((\n                    \n                    0\n            ), 0) AS dead_pig_count,\n            GROUP_CONCAT(ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            GROUP_CONCAT(ri.contact_phone SEPARATOR ',') AS contact_phone,\n            GROUP_CONCAT(mp.market_name SEPARATOR ',') AS market_name,\n            GROUP_CONCAT(bp.print_status SEPARATOR ',') AS print_status,\n            SUM(IF(bp.print_status = '1', IFNULL(pp.lay_count, 0) + IFNULL(pp.hang_count, 0), 0)) AS print_count,\n            MAX(bp.print_time) AS print_time,\n            MAX(ri.retailer_mark) AS retailer_mark\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n            LEFT JOIN t_bill_print bp ON pp.pick_id = bp.pick_id AND bp.is_delete = 0\n         WHERE  pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            AND pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.status = 'morningpick' AND pr.is_delete = 0\n        AND pp.retailer_id > 0 AND pp.is_delete = 0 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id\n     \n        ) mn2\n     \n            )\n        ) gb\n        GROUP BY gb.bill_date, gb.retailer_id","ts":"2025-01-03T03:25:00"},"fingerprint":"select group_concat(pick_ids separator ?) as pick_ids, sum(purchase_count) as purchase_count, sum(dead_pig_count) as dead_pig_count, sum(if(print_count > purchase_count, purchase_count, print_count)) as print_count, max(print_time) as print_time from ( select group_concat(gb.recognize_ids separator ?) as recognize_ids, group_concat(gb.trade_ids separator ?) as trade_ids, group_concat(gb.stall_id separator ?) as stall_ids, group_concat(gb.stall_code separator ?) as stall_code, group_concat(gb.stall_name separator ?) as stall_name, gb.bill_date, group_concat(gb.pick_ids separator ?) as pick_ids, gb.retailer_id, group_concat(gb.tattoo_code separator ?) as tattoo_code, sum(gb.purchase_count) as purchase_count, sum(gb.dead_pig_count) as dead_pig_count, group_concat(gb.retailer_name separator ?) as retailer_name, max(gb.retailer_location) as retailer_location, group_concat(gb.contact_phone separator ?) as contact_phone, group_concat(gb.market_name separator ?) as market_name, group_concat(gb.print_status separator ?) as print_status, sum(gb.print_count) as print_count, max(gb.print_time) as print_time, max(gb.retailer_mark) as retailer_mark from ( ( select concat(rg.recognize_ids, ?, ifnull(mn.recognize_ids, ?)) as recognize_ids, concat(rg.trade_ids, ?, ifnull(mn.trade_ids, ?)) as trade_ids, rg.stall_id, rg.stall_code, rg.stall_name, rg.bill_date, rg.status, rg.pick_ids, rg.retailer_id, rg.tattoo_code, if(rg.lay_count ? rg.hang_count ? if(mn.stall_id is ?, ?, mn.lay_count ? mn.hang_count) >= ?, rg.lay_count ? rg.hang_count ? if(mn.stall_id is ?, ?, mn.lay_count ? mn.hang_count), ?) as purchase_count, rg.lay_count, rg.hang_count, rg.dead_pig_count, rg.retailer_name, rg.retailer_location, rg.contact_phone, rg.market_name, rg.print_status, if(rg.print_count ? if(mn.stall_id is ?, ?, mn.print_count) >= ?, rg.print_count ? if(mn.stall_id is ?, ?, mn.print_count), ?) as print_count, rg.print_time, rg.retailer_mark from ( select group_concat(pr.recognize_id separator ?) as recognize_ids, group_concat(pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(pr.stall_code separator ?) as stall_code, group_concat(pr.stall_name separator ?) as stall_name, pr.pick_date as bill_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, group_concat(pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(( ? ), ?) as dead_pig_count, group_concat(ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, group_concat(ri.contact_phone separator ?) as contact_phone, group_concat(mp.market_name separator ?) as market_name, group_concat(bp.print_status separator ?) as print_status, sum(if(bp.print_status = ?, ifnull(pp.lay_count, ?) ? ifnull(pp.hang_count, ?), ?)) as print_count, max(bp.print_time) as print_time, max(ri.retailer_mark) as retailer_mark from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_market_place mp on ri.market_id = mp.market_id left join t_bill_print bp on pp.pick_id = bp.pick_id and bp.is_delete = ? where pr.pick_date >= ? and pr.pick_date <= ? and pr.status = ? and pr.is_delete = ? and pp.retailer_id > ? and pp.is_delete = ? group by pr.pick_date, pr.stall_id, pp.retailer_id ) rg left join ( select group_concat(pr.recognize_id separator ?) as recognize_ids, group_concat(pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(pr.stall_code separator ?) as stall_code, group_concat(pr.stall_name separator ?) as stall_name, pr.pick_date as bill_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, group_concat(pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(( ? ), ?) as dead_pig_count, group_concat(ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, group_concat(ri.contact_phone separator ?) as contact_phone, group_concat(mp.market_name separator ?) as market_name, group_concat(bp.print_status separator ?) as print_status, sum(if(bp.print_status = ?, ifnull(pp.lay_count, ?) ? ifnull(pp.hang_count, ?), ?)) as print_count, max(bp.print_time) as print_time, max(ri.retailer_mark) as retailer_mark from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_market_place mp on ri.market_id = mp.market_id left join t_bill_print bp on pp.pick_id = bp.pick_id and bp.is_delete = ? where pr.pick_date >= ? and pr.pick_date <= ? and pr.status = ? and pr.is_delete = ? and pp.retailer_id > ? and pp.is_delete = ? group by pr.pick_date, pr.stall_id, pp.retailer_id ) mn on rg.bill_date = mn.bill_date and rg.stall_id = mn.stall","histograms":{"Query_time":[0,0,0,0,0,0,6,8]},"metrics":{"Lock_time":{"avg":"0.000018","max":"0.000036","median":"0.000015","min":"0.000011","pct":"0.013208","pct_95":"0.000034","stddev":"0.000009","sum":"0.000257"},"Query_length":{"avg":"10010","max":"10010","median":"10010","min":"10010","pct":"0","pct_95":"10010","stddev":"0","sum":"140140"},"Query_time":{"avg":"9.515824","max":"13.360242","median":"9.828080","min":"5.181811","pct":"0.013208","pct_95":"13.170567","stddev":"2.516279","sum":"133.221537"},"Rows_examined":{"avg":"274","max":"637","median":"202","min":"9","pct":"0","pct_95":"592","stddev":"229","sum":"3843"},"Rows_sent":{"avg":"1","max":"1","median":"1","min":"1","pct":"0","pct_95":"1","stddev":"0","sum":"14"},"db":{"value":"pz_wsnh_prod"},"host":{"value":"192.168.5.243"},"user":{"value":"pz_wsnh"}},"query_count":14,"tables":[{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pick_recognize`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pick_recognize'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pig_pick`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pig_pick'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_market_place`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_market_place'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_bill_print`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_bill_print'\\G"}],"ts_max":"2025-01-03T06:07:39","ts_min":"2025-01-03T00:20:47"},{"attribute":"fingerprint","checksum":"0273C486A44063247879EF4C60041704","distillate":"SELECT UNION t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place","example":{"Query_time":"11.925309","query":"SELECT SUM(plan_count) AS plan_count,\n            SUM(lay_count) AS lay_count,\n            SUM(hang_count) AS hang_count,\n            SUM(morning_count) AS morning_count,\n            SUM(head_count) AS head_count,\n            SUM(whole_count) AS whole_count,\n            SUM(service_fee) AS service_fee,\n            SUM(pig_fee) AS pig_fee,\n            SUM(service_fee + pig_fee) AS total_fee,\n            Count(DISTINCT pick_date) AS total_days\n        FROM ( \n         \n\n        SELECT CONCAT(rg.recognize_ids, '|', IFNULL(mn.recognize_ids, '')) AS recognize_ids,\n            CONCAT(rg.trade_ids, '|', IFNULL(mn.trade_ids, '')) AS trade_ids,\n            rg.stall_id,\n            rg.stall_code,\n            rg.stall_name,\n            rg.pick_date,\n            CONCAT(rg.status, '|', IFNULL(mn.status, '')) AS status,\n            CONCAT(rg.pick_ids, '|', IFNULL(mn.pick_ids, '')) AS pick_ids,\n            rg.retailer_id,\n            rg.tattoo_code,\n            IF(mn.stall_id IS NULL OR rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count)\n                + IF(mn.stall_id IS NULL OR rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count)\n            AS plan_count,\n            IF(mn.stall_id IS NULL OR rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) AS lay_count,\n            IF(mn.stall_id IS NULL OR rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) AS hang_count,\n            IF(mn.stall_id IS NULL, rg.morning_count, mn.morning_count) AS morning_count,\n            rg.head_count,\n            rg.whole_count,\n            rg.service_fee,\n            rg.pick_time,\n            rg.claim_slaughter_time,\n            rg.owner_ids,\n            rg.owner_code,\n            rg.owner_name,\n            rg.owner_phone,\n            rg.company_name,\n            rg.retailer_name,\n            rg.retailer_location,\n            rg.location,\n            rg.contact_phone,\n            rg.market_id,\n            rg.pig_fee,\n            rg.service_fee + rg.pig_fee AS total_fee,\n            rg.order_no,\n            rg.pay_way,\n            rg.integral,\n            rg.distributor_id,\n            rg.distributor_name,\n            rg.distributor_phone,\n            mp.market_code,\n            mp.market_name,\n            rg.default_plan_time\n        FROM ( \n        SELECT GROUP_CONCAT(DISTINCT pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(DISTINCT pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(DISTINCT pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(DISTINCT pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            pp.order_no,\n            pp.pay_way,\n            GROUP_CONCAT(DISTINCT pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.plan_count), 0) AS plan_count,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL(SUM(pp.morning_count), 0) AS morning_count,\n            IFNULL(SUM(pp.head_count), 0) AS head_count,\n            IFNULL(SUM(pp.whole_count), 0) AS whole_count,\n            IFNULL(SUM(pp.service_fee), 0) AS service_fee,\n            MAX(pp.create_time) AS pick_time,\n            MAX(pp.claim_slaughter_time) AS claim_slaughter_time,\n            GROUP_CONCAT(DISTINCT st.owner_id SEPARATOR ',') AS owner_ids,\n            GROUP_CONCAT(DISTINCT st.owner_code SEPARATOR ',') AS owner_code,\n            GROUP_CONCAT(DISTINCT st.owner_name SEPARATOR ',') AS owner_name,\n            GROUP_CONCAT(DISTINCT st.owner_phone SEPARATOR ',') AS owner_phone,\n            GROUP_CONCAT(DISTINCT st.company_name SEPARATOR ',') AS company_name,\n            GROUP_CONCAT(DISTINCT ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            MAX(ri.location) AS location,\n            GROUP_CONCAT(DISTINCT ri.contact_phone SEPARATOR ',') AS contact_phone,\n            ri.market_id,\n            IFNULL(SUM(pp.pig_fee), 0) AS pig_fee,\n            rit.integral,\n            di.distributor_id,\n            di.distributor_name,\n            di.distributor_phone,\n            MAX(ri.default_plan_time) AS default_plan_time\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_slaughter_trade st ON pr.trade_id = st.trade_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_retailer_integral rit ON pp.retailer_id = rit.retailer_id\n            LEFT JOIN t_distributor_info di ON ri.distributor_id = di.distributor_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n         WHERE pr.status = 'submitted'\n            \n        \n        \n        \n            and pr.pick_date >= '2025-01-03 00:00:00'\n        \n        \n            and pr.pick_date <= '2025-01-03 00:00:00'\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.is_delete = 0\n        AND pp.is_delete = 0\n    \n            AND isnull(pp.relate_pick_id) = 1 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone\n     ) rg\n            LEFT JOIN ( \n        SELECT GROUP_CONCAT(DISTINCT pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(DISTINCT pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(DISTINCT pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(DISTINCT pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            pp.order_no,\n            pp.pay_way,\n            GROUP_CONCAT(DISTINCT pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.plan_count), 0) AS plan_count,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL(SUM(pp.morning_count), 0) AS morning_count,\n            IFNULL(SUM(pp.head_count), 0) AS head_count,\n            IFNULL(SUM(pp.whole_count), 0) AS whole_count,\n            IFNULL(SUM(pp.service_fee), 0) AS service_fee,\n            MAX(pp.create_time) AS pick_time,\n            MAX(pp.claim_slaughter_time) AS claim_slaughter_time,\n            GROUP_CONCAT(DISTINCT st.owner_id SEPARATOR ',') AS owner_ids,\n            GROUP_CONCAT(DISTINCT st.owner_code SEPARATOR ',') AS owner_code,\n            GROUP_CONCAT(DISTINCT st.owner_name SEPARATOR ',') AS owner_name,\n            GROUP_CONCAT(DISTINCT st.owner_phone SEPARATOR ',') AS owner_phone,\n            GROUP_CONCAT(DISTINCT st.company_name SEPARATOR ',') AS company_name,\n            GROUP_CONCAT(DISTINCT ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            MAX(ri.location) AS location,\n            GROUP_CONCAT(DISTINCT ri.contact_phone SEPARATOR ',') AS contact_phone,\n            ri.market_id,\n            IFNULL(SUM(pp.pig_fee), 0) AS pig_fee,\n            rit.integral,\n            di.distributor_id,\n            di.distributor_name,\n            di.distributor_phone,\n            MAX(ri.default_plan_time) AS default_plan_time\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_slaughter_trade st ON pr.trade_id = st.trade_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_retailer_integral rit ON pp.retailer_id = rit.retailer_id\n            LEFT JOIN t_distributor_info di ON ri.distributor_id = di.distributor_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n         WHERE pr.status = 'morningpick'\n            \n        \n        \n        \n            and pr.pick_date >= '2025-01-03 00:00:00'\n        \n        \n            and pr.pick_date <= '2025-01-03 00:00:00'\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.is_delete = 0\n        AND pp.is_delete = 0\n    \n            AND isnull(pp.relate_pick_id) = 1 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone\n     ) mn\n                ON rg.stall_id = mn.stall_id AND rg.pick_date = mn.pick_date AND rg.retailer_id = mn.retailer_id\n            LEFT JOIN t_market_place mp ON rg.market_id = mp.market_id\n        UNION (\n            SELECT CONCAT(IFNULL(rg2.recognize_ids, ''), '|', mn2.recognize_ids) AS recognize_ids,\n                CONCAT(IFNULL(rg2.trade_ids, ''), '|', mn2.trade_ids) AS trade_ids,\n                mn2.stall_id,\n                mn2.stall_code,\n                mn2.stall_name,\n                mn2.pick_date,\n                CONCAT(IFNULL(rg2.status, ''), '|', mn2.status) AS status,\n                CONCAT(IFNULL(rg2.pick_ids, ''), '|', mn2.pick_ids) AS pick_ids,\n                mn2.retailer_id,\n                mn2.tattoo_code,\n                mn2.plan_count,\n                mn2.lay_count,\n                mn2.hang_count,\n                mn2.morning_count,\n                mn2.head_count,\n                mn2.whole_count,\n                mn2.service_fee,\n                mn2.pick_time,\n                mn2.claim_slaughter_time,\n                mn2.owner_ids,\n                mn2.owner_code,\n                mn2.owner_name,\n                mn2.owner_phone,\n                mn2.company_name,\n                mn2.retailer_name,\n                mn2.retailer_location,\n    ","ts":"2025-01-03T13:57:24"},"fingerprint":"select sum(plan_count) as plan_count, sum(lay_count) as lay_count, sum(hang_count) as hang_count, sum(morning_count) as morning_count, sum(head_count) as head_count, sum(whole_count) as whole_count, sum(service_fee) as service_fee, sum(pig_fee) as pig_fee, sum(service_fee ? pig_fee) as total_fee, count(distinct pick_date) as total_days from ( select concat(rg.recognize_ids, ?, ifnull(mn.recognize_ids, ?)) as recognize_ids, concat(rg.trade_ids, ?, ifnull(mn.trade_ids, ?)) as trade_ids, rg.stall_id, rg.stall_code, rg.stall_name, rg.pick_date, concat(rg.status, ?, ifnull(mn.status, ?)) as status, concat(rg.pick_ids, ?, ifnull(mn.pick_ids, ?)) as pick_ids, rg.retailer_id, rg.tattoo_code, if(mn.stall_id is ? or rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) ? if(mn.stall_id is ? or rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) as plan_count, if(mn.stall_id is ? or rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) as lay_count, if(mn.stall_id is ? or rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) as hang_count, if(mn.stall_id is ?, rg.morning_count, mn.morning_count) as morning_count, rg.head_count, rg.whole_count, rg.service_fee, rg.pick_time, rg.claim_slaughter_time, rg.owner_ids, rg.owner_code, rg.owner_name, rg.owner_phone, rg.company_name, rg.retailer_name, rg.retailer_location, rg.location, rg.contact_phone, rg.market_id, rg.pig_fee, rg.service_fee ? rg.pig_fee as total_fee, rg.order_no, rg.pay_way, rg.integral, rg.distributor_id, rg.distributor_name, rg.distributor_phone, mp.market_code, mp.market_name, rg.default_plan_time from ( select group_concat(distinct pr.recognize_id separator ?) as recognize_ids, group_concat(distinct pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(distinct pr.stall_code separator ?) as stall_code, group_concat(distinct pr.stall_name separator ?) as stall_name, pr.pick_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, group_concat(distinct pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.plan_count), ?) as plan_count, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(sum(pp.morning_count), ?) as morning_count, ifnull(sum(pp.head_count), ?) as head_count, ifnull(sum(pp.whole_count), ?) as whole_count, ifnull(sum(pp.service_fee), ?) as service_fee, max(pp.create_time) as pick_time, max(pp.claim_slaughter_time) as claim_slaughter_time, group_concat(distinct st.owner_id separator ?) as owner_ids, group_concat(distinct st.owner_code separator ?) as owner_code, group_concat(distinct st.owner_name separator ?) as owner_name, group_concat(distinct st.owner_phone separator ?) as owner_phone, group_concat(distinct st.company_name separator ?) as company_name, group_concat(distinct ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, max(ri.location) as location, group_concat(distinct ri.contact_phone separator ?) as contact_phone, ri.market_id, ifnull(sum(pp.pig_fee), ?) as pig_fee, rit.integral, di.distributor_id, di.distributor_name, di.distributor_phone, max(ri.default_plan_time) as default_plan_time from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id left join t_slaughter_trade st on pr.trade_id = st.trade_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_retailer_integral rit on pp.retailer_id = rit.retailer_id left join t_distributor_info di on ri.distributor_id = di.distributor_id left join t_market_place mp on ri.market_id = mp.market_id where pr.status = ? and pr.pick_date >= ? and pr.pick_date <= ? and pr.is_delete = ? and pp.is_delete = ? and isnull(pp.relate_pick_id) = ? group by pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone ) rg left join ( select group_concat(distinct pr.recognize_id separator ?) as recognize_ids, group_concat(distinct pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(distinct pr.stall_code separator ?) as stall_code, group_concat(distinct pr.stall_name separator ?) as stall_name, pr.pick_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, group_concat(distinct pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.plan_count), ?) as plan_count, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(sum(pp.morning_count), ?) as morning_count, ifnull(sum(pp.head_count), ?) as head_count, ifnull(sum(pp.whole_count), ?) as whole_count, ifnull(sum(pp.service_fee), ?) as service_fee, max(pp.create_time) as pick_time, max(pp.claim_slaughter_time) as claim_slaughter_time, group_concat(distinct st.owner_id separator ?) as owner_ids, group_concat(distinct st.owner_code separator ?) as ","histograms":{"Query_time":[0,0,0,0,0,0,16,2]},"metrics":{"Lock_time":{"avg":"0.000035","max":"0.000056","median":"0.000034","min":"0.000026","pct":"0.016981","pct_95":"0.000045","stddev":"0.000007","sum":"0.000627"},"Query_length":{"avg":"25256","max":"25276","median":"24141","min":"25252","pct":"0","pct_95":"24141","stddev":"0","sum":"454608"},"Query_time":{"avg":"6.096682","max":"11.925309","median":"5.472643","min":"3.879394","pct":"0.016981","pct_95":"9.828080","stddev":"1.789648","sum":"109.740268"},"Rows_examined":{"avg":"681","max":"1449","median":"685","min":"0","pct":"0","pct_95":"719","stddev":"283","sum":"12275"},"Rows_sent":{"avg":"1","max":"1","median":"1","min":"1","pct":"0","pct_95":"1","stddev":"0","sum":"18"},"db":{"value":"pz_wsnh_prod"},"host":{"value":"192.168.5.243"},"user":{"value":"pz_wsnh"}},"query_count":18,"tables":[{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pick_recognize`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pick_recognize'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pig_pick`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pig_pick'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_slaughter_trade`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_slaughter_trade'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_integral`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_integral'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_distributor_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_distributor_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_market_place`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_market_place'\\G"}],"ts_max":"2025-01-03T13:57:54","ts_min":"2025-01-02T17:00:11"},{"attribute":"fingerprint","checksum":"DC2499B7A6732510F0ECBD8964DF133F","distillate":"SELECT t_pig_unqualified t_slaughter_trade t_transport_itinerary t_signin_check t_pig_stall t_quarantine_certificate t_pig_entrance_check t_hog_disease_detail t_hog_disease t_hog_disease_detail t_hog_disease","example":{"Query_time":"15.973137","query":"SELECT COUNT(*) FROM (\n             \n        SELECT st.trade_id,\n            st.owner_id,\n            st.owner_code,\n            st.owner_name,\n            st.owner_phone,\n            st.company_name,\n            st.stall_id,\n            ps.stall_code,\n            ps.stall_name,\n            ti.itinerary_id,\n            ti.driver_name,\n            ti.driver_phone,\n            ti.certificate_type,\n            ti.origin_certificate_code,\n            ti.plate_number,\n            ti.start_province,\n            ti.start_city,\n            ti.start_district,\n            ti.start_address,\n            ti.start_time,\n            ti.arrive_time,\n            ti.trace_type,\n            ti.custom_trace_info,\n            ti.itinerary_trace,\n            ti.layer_row_col_counts,\n            ti.total_count,\n            ti.owner_signature,\n            ti.pig_type,\n            ti.entrance_number,\n            ti.create_time AS signin_time,\n            ti.contact_phone,\n            \n            qc.quantity_number,\n            qc.ear_tag_ids,\n            \n            ec.entrance_id,\n            ec.actual_count,\n            IFNULL((SELECT SUM(dead_pig_count) FROM t_pig_unqualified\n                    WHERE itinerary_id = ti.itinerary_id AND unqualified_type = 'entranceDead' AND is_delete = 0\n                ), 0) AS dead_count,\n            sc.check_id,\n            sc.certificate_verify,\n            sc.trace_verify,\n            sc.record_verify,\n            sc.no_illicit_drugs,\n            sc.verify_attachment,\n            sc.verify_remark,\n            sc.verify_time,\n            sc.leanmeat_powder_result,\n            sc.leanmeat_powder_sample,\n            sc.hog_disease_result,\n            sc.hog_disease_sample,\n            sc.hog_sample_code,\n            sc.hog_detect_result,\n            sc.quick_detect_card_sample,\n            sc.veterinarian_signature,\n            sc.veterinarian_signtime,\n            sc.veterinarian_user,\n            sc.other_detect_item,\n            sc.other_detect_result,\n            sc.other_detect_sample,\n            sc.detect_attachment,\n            sc.detect_remark,\n            sc.detect_time,\n            sc.experimenter_signature,\n            sc.papers_tag_conform,\n            sc.ear_tag_complete,\n            sc.animal_count_check,\n            sc.clinical_health,\n            sc.check_attachment,\n            sc.check_remark,\n            sc.check_result,\n            sc.vehicle_check_time,\n            sc.approve_time,\n            sc.inspector_signature,\n            sc.inspector_signtime,\n            sc.inspector_user,\n            sc.quarantine_signature,\n            sc.quarantine_signtime,\n            sc.quarantine_user,\n            sc.check_status,\n            sc.create_time,\n            sc.create_user,\n            sc.update_time,\n            sc.update_user,\n            hd.detect_report AS hog_disease_detect_report,\n            hd.create_time AS detect_upload_time,\n            hdd.sample_code AS hog_disease_sample_code,\n            hdd.detect_result AS hog_disease_detect_result\n        FROM t_slaughter_trade st\n            JOIN t_transport_itinerary ti ON st.trade_id = ti.trade_id\n            JOIN t_signin_check sc ON ti.itinerary_id = sc.itinerary_id\n            LEFT JOIN t_pig_stall ps ON st.stall_id = ps.stall_id\n            LEFT JOIN (\n                SELECT\n                tqc.itinerary_id,\n                SUM(tqc.quantity_number) AS quantity_number,\n                GROUP_CONCAT(tqc.ear_tag_ids ORDER BY tqc.create_time ASC SEPARATOR ',') AS ear_tag_ids\n                FROM t_quarantine_certificate AS tqc\n                WHERE tqc.is_delete = 0\n                GROUP BY tqc.itinerary_id\n            ) AS qc ON qc.itinerary_id = ti.itinerary_id\n            LEFT JOIN t_pig_entrance_check ec ON ti.itinerary_id = ec.itinerary_id AND ec.is_delete = 0\n            LEFT JOIN t_hog_disease_detail hdd ON hdd.detail_id = (\n                SELECT shdd.detail_id\n                FROM t_hog_disease shd\n                    JOIN t_hog_disease_detail shdd ON shd.detect_id = shdd.detect_id\n                WHERE shdd.itinerary_id = ti.itinerary_id AND shd.is_delete = 0 AND shdd.is_delete = 0\n                ORDER BY IFNULL(shdd.update_time, shdd.create_time) DESC\n                LIMIT 1\n            ) AND hdd.is_delete = 0\n            LEFT JOIN t_hog_disease hd ON hd.detect_id = hdd.detect_id AND hd.is_delete = 0\n         WHERE  ti.create_time >= '2025-01-02 16:00:00'\n            \n            \n                AND ti.create_time <= '2025-01-03 15:59:59.999'\n            \n            \n            \n            \n            \n            \n            \n            \n            \n            \n            \n                AND sc.check_status IN\n                ('vehicle_factory')\n            \n            \n            \n            \n            \n            \n            \n            AND st.is_delete = 0\n            AND ti.is_delete = 0\n            AND sc.is_delete = 0 \n     \n        ) x","ts":"2025-01-03T00:05:20"},"fingerprint":"select count(*) from ( select st.trade_id, st.owner_id, st.owner_code, st.owner_name, st.owner_phone, st.company_name, st.stall_id, ps.stall_code, ps.stall_name, ti.itinerary_id, ti.driver_name, ti.driver_phone, ti.certificate_type, ti.origin_certificate_code, ti.plate_number, ti.start_province, ti.start_city, ti.start_district, ti.start_address, ti.start_time, ti.arrive_time, ti.trace_type, ti.custom_trace_info, ti.itinerary_trace, ti.layer_row_col_counts, ti.total_count, ti.owner_signature, ti.pig_type, ti.entrance_number, ti.create_time as signin_time, ti.contact_phone, qc.quantity_number, qc.ear_tag_ids, ec.entrance_id, ec.actual_count, ifnull((select sum(dead_pig_count) from t_pig_unqualified where itinerary_id = ti.itinerary_id and unqualified_type = ? and is_delete = ? ), ?) as dead_count, sc.check_id, sc.certificate_verify, sc.trace_verify, sc.record_verify, sc.no_illicit_drugs, sc.verify_attachment, sc.verify_remark, sc.verify_time, sc.leanmeat_powder_result, sc.leanmeat_powder_sample, sc.hog_disease_result, sc.hog_disease_sample, sc.hog_sample_code, sc.hog_detect_result, sc.quick_detect_card_sample, sc.veterinarian_signature, sc.veterinarian_signtime, sc.veterinarian_user, sc.other_detect_item, sc.other_detect_result, sc.other_detect_sample, sc.detect_attachment, sc.detect_remark, sc.detect_time, sc.experimenter_signature, sc.papers_tag_conform, sc.ear_tag_complete, sc.animal_count_check, sc.clinical_health, sc.check_attachment, sc.check_remark, sc.check_result, sc.vehicle_check_time, sc.approve_time, sc.inspector_signature, sc.inspector_signtime, sc.inspector_user, sc.quarantine_signature, sc.quarantine_signtime, sc.quarantine_user, sc.check_status, sc.create_time, sc.create_user, sc.update_time, sc.update_user, hd.detect_report as hog_disease_detect_report, hd.create_time as detect_upload_time, hdd.sample_code as hog_disease_sample_code, hdd.detect_result as hog_disease_detect_result from t_slaughter_trade st join t_transport_itinerary ti on st.trade_id = ti.trade_id join t_signin_check sc on ti.itinerary_id = sc.itinerary_id left join t_pig_stall ps on st.stall_id = ps.stall_id left join ( select tqc.itinerary_id, sum(tqc.quantity_number) as quantity_number, group_concat(tqc.ear_tag_ids order by tqc.create_time separator ?) as ear_tag_ids from t_quarantine_certificate as tqc where tqc.is_delete = ? group by tqc.itinerary_id ) as qc on qc.itinerary_id = ti.itinerary_id left join t_pig_entrance_check ec on ti.itinerary_id = ec.itinerary_id and ec.is_delete = ? left join t_hog_disease_detail hdd on hdd.detail_id = ( select shdd.detail_id from t_hog_disease shd join t_hog_disease_detail shdd on shd.detect_id = shdd.detect_id where shdd.itinerary_id = ti.itinerary_id and shd.is_delete = ? and shdd.is_delete = ? order by ifnull(shdd.update_time, shdd.create_time) desc limit ? ) and hdd.is_delete = ? left join t_hog_disease hd on hd.detect_id = hdd.detect_id and hd.is_delete = ? where ti.create_time >= ? and ti.create_time <= ? and sc.check_status in(?+) and st.is_delete = ? and ti.is_delete = ? and sc.is_delete = ? ) x","histograms":{"Query_time":[0,0,0,0,0,0,16,2]},"metrics":{"Lock_time":{"avg":"0.000012","max":"0.000019","median":"0.000011","min":"0.000008","pct":"0.016981","pct_95":"0.000019","stddev":"0.000003","sum":"0.000217"},"Query_length":{"avg":"4949","max":"4950","median":"4825","min":"4949","pct":"0","pct_95":"4825","stddev":"0","sum":"89088"},"Query_time":{"avg":"5.490446","max":"15.973137","median":"4.502357","min":"2.175099","pct":"0.016981","pct_95":"10.319484","stddev":"3.438070","sum":"98.828026"},"Rows_examined":{"avg":"22","max":"54","median":"4","min":"0","pct":"0","pct_95":"51","stddev":"23","sum":"404"},"Rows_sent":{"avg":"1","max":"1","median":"1","min":"1","pct":"0","pct_95":"1","stddev":"0","sum":"18"},"db":{"value":"wsnh_prod"},"host":{"value":"192.168.5.243"},"user":{"value":"wsnh"}},"query_count":18,"tables":[{"create":"SHOW CREATE TABLE `wsnh_prod`.`t_pig_unqualified`\\G","status":"SHOW TABLE STATUS FROM `wsnh_prod` LIKE 't_pig_unqualified'\\G"},{"create":"SHOW CREATE TABLE `wsnh_prod`.`t_slaughter_trade`\\G","status":"SHOW TABLE STATUS FROM `wsnh_prod` LIKE 't_slaughter_trade'\\G"},{"create":"SHOW CREATE TABLE `wsnh_prod`.`t_transport_itinerary`\\G","status":"SHOW TABLE STATUS FROM `wsnh_prod` LIKE 't_transport_itinerary'\\G"},{"create":"SHOW CREATE TABLE `wsnh_prod`.`t_signin_check`\\G","status":"SHOW TABLE STATUS FROM `wsnh_prod` LIKE 't_signin_check'\\G"},{"create":"SHOW CREATE TABLE `wsnh_prod`.`t_pig_stall`\\G","status":"SHOW TABLE STATUS FROM `wsnh_prod` LIKE 't_pig_stall'\\G"},{"create":"SHOW CREATE TABLE `wsnh_prod`.`t_quarantine_certificate`\\G","status":"SHOW TABLE STATUS FROM `wsnh_prod` LIKE 't_quarantine_certificate'\\G"},{"create":"SHOW CREATE TABLE `wsnh_prod`.`t_pig_entrance_check`\\G","status":"SHOW TABLE STATUS FROM `wsnh_prod` LIKE 't_pig_entrance_check'\\G"},{"create":"SHOW CREATE TABLE `wsnh_prod`.`t_hog_disease_detail`\\G","status":"SHOW TABLE STATUS FROM `wsnh_prod` LIKE 't_hog_disease_detail'\\G"},{"create":"SHOW CREATE TABLE `wsnh_prod`.`t_hog_disease`\\G","status":"SHOW TABLE STATUS FROM `wsnh_prod` LIKE 't_hog_disease'\\G"}],"ts_max":"2025-01-03T13:08:47","ts_min":"2025-01-03T00:05:03"},{"attribute":"fingerprint","checksum":"4B064E59AB8AAC7FAF00FEA79AD3DB46","distillate":"SELECT UNION t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place","example":{"Query_time":"11.931942","query":"SELECT count(0) FROM (SELECT CONCAT(rg.recognize_ids, '|', IFNULL(mn.recognize_ids, '')) AS recognize_ids, CONCAT(rg.trade_ids, '|', IFNULL(mn.trade_ids, '')) AS trade_ids, rg.stall_id, rg.stall_code, rg.stall_name, rg.pick_date, CONCAT(rg.status, '|', IFNULL(mn.status, '')) AS status, CONCAT(rg.pick_ids, '|', IFNULL(mn.pick_ids, '')) AS pick_ids, rg.retailer_id, rg.tattoo_code, IF(mn.stall_id IS NULL OR rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) + IF(mn.stall_id IS NULL OR rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) AS plan_count, IF(mn.stall_id IS NULL OR rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) AS lay_count, IF(mn.stall_id IS NULL OR rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) AS hang_count, IF(mn.stall_id IS NULL, rg.morning_count, mn.morning_count) AS morning_count, rg.head_count, rg.whole_count, rg.service_fee, rg.pick_time, rg.claim_slaughter_time, rg.owner_ids, rg.owner_code, rg.owner_name, rg.owner_phone, rg.company_name, rg.retailer_name, rg.retailer_location, rg.location, rg.contact_phone, rg.market_id, rg.pig_fee, rg.service_fee + rg.pig_fee AS total_fee, rg.order_no, rg.pay_way, rg.integral, rg.distributor_id, rg.distributor_name, rg.distributor_phone, mp.market_code, mp.market_name, rg.default_plan_time FROM (SELECT GROUP_CONCAT(DISTINCT pr.recognize_id SEPARATOR ',') AS recognize_ids, GROUP_CONCAT(DISTINCT pr.trade_id SEPARATOR ',') AS trade_ids, pr.stall_id, GROUP_CONCAT(DISTINCT pr.stall_code SEPARATOR ',') AS stall_code, GROUP_CONCAT(DISTINCT pr.stall_name SEPARATOR ',') AS stall_name, pr.pick_date, GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status, GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, GROUP_CONCAT(DISTINCT pp.tattoo_code SEPARATOR ',') AS tattoo_code, IFNULL(SUM(pp.plan_count), 0) AS plan_count, IFNULL(SUM(pp.lay_count), 0) AS lay_count, IFNULL(SUM(pp.hang_count), 0) AS hang_count, IFNULL(SUM(pp.morning_count), 0) AS morning_count, IFNULL(SUM(pp.head_count), 0) AS head_count, IFNULL(SUM(pp.whole_count), 0) AS whole_count, IFNULL(SUM(pp.service_fee), 0) AS service_fee, MAX(pp.create_time) AS pick_time, MAX(pp.claim_slaughter_time) AS claim_slaughter_time, GROUP_CONCAT(DISTINCT st.owner_id SEPARATOR ',') AS owner_ids, GROUP_CONCAT(DISTINCT st.owner_code SEPARATOR ',') AS owner_code, GROUP_CONCAT(DISTINCT st.owner_name SEPARATOR ',') AS owner_name, GROUP_CONCAT(DISTINCT st.owner_phone SEPARATOR ',') AS owner_phone, GROUP_CONCAT(DISTINCT st.company_name SEPARATOR ',') AS company_name, GROUP_CONCAT(DISTINCT ri.retailer_name SEPARATOR ',') AS retailer_name, MAX(ri.retailer_location) AS retailer_location, MAX(ri.location) AS location, GROUP_CONCAT(DISTINCT ri.contact_phone SEPARATOR ',') AS contact_phone, ri.market_id, IFNULL(SUM(pp.pig_fee), 0) AS pig_fee, rit.integral, di.distributor_id, di.distributor_name, di.distributor_phone, MAX(ri.default_plan_time) AS default_plan_time FROM t_pick_recognize pr JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id LEFT JOIN t_slaughter_trade st ON pr.trade_id = st.trade_id LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id LEFT JOIN t_retailer_integral rit ON pp.retailer_id = rit.retailer_id LEFT JOIN t_distributor_info di ON ri.distributor_id = di.distributor_id LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id WHERE pr.status = 'submitted' AND pr.pick_date >= '2025-01-02 16:00:00' AND pr.pick_date <= '2025-01-03 15:59:59.999' AND pr.is_delete = 0 AND pp.is_delete = 0 AND isnull(pp.relate_pick_id) = 1 GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone) rg LEFT JOIN (SELECT GROUP_CONCAT(DISTINCT pr.recognize_id SEPARATOR ',') AS recognize_ids, GROUP_CONCAT(DISTINCT pr.trade_id SEPARATOR ',') AS trade_ids, pr.stall_id, GROUP_CONCAT(DISTINCT pr.stall_code SEPARATOR ',') AS stall_code, GROUP_CONCAT(DISTINCT pr.stall_name SEPARATOR ',') AS stall_name, pr.pick_date, GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status, GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, GROUP_CONCAT(DISTINCT pp.tattoo_code SEPARATOR ',') AS tattoo_code, IFNULL(SUM(pp.plan_count), 0) AS plan_count, IFNULL(SUM(pp.lay_count), 0) AS lay_count, IFNULL(SUM(pp.hang_count), 0) AS hang_count, IFNULL(SUM(pp.morning_count), 0) AS morning_count, IFNULL(SUM(pp.head_count), 0) AS head_count, IFNULL(SUM(pp.whole_count), 0) AS whole_count, IFNULL(SUM(pp.service_fee), 0) AS service_fee, MAX(pp.create_time) AS pick_time, MAX(pp.claim_slaughter_time) AS claim_slaughter_time, GROUP_CONCAT(DISTINCT st.owner_id SEPARATOR ',') AS owner_ids, GROUP_CONCAT(DISTINCT st.owner_code SEPARATOR ',') AS owner_code, GROUP_CONCAT(DISTINCT st.owner_name SEPARATOR ',') AS owner_name, GROUP_CONCAT(DISTINCT st.owner_phone SEPARATOR ',') AS owner_phone, GROUP_CONCAT(DISTINCT st.company_name SEPARATOR ',') AS company_name, GROUP_CONCAT(DISTINCT ri.retailer_name SEPARATOR ',') AS retailer_name, MAX(ri.retailer_location) AS retailer_location, MAX(ri.location) AS location, GROUP_CONCAT(DISTINCT ri.contact_phone SEPARATOR ',') AS contact_phone, ri.market_id, IFNULL(SUM(pp.pig_fee), 0) AS pig_fee, rit.integral, di.distributor_id, di.distributor_name, di.distributor_phone, MAX(ri.default_plan_time) AS default_plan_time FROM t_pick_recognize pr JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id LEFT JOIN t_slaughter_trade st ON pr.trade_id = st.trade_id LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id LEFT JOIN t_retailer_integral rit ON pp.retailer_id = rit.retailer_id LEFT JOIN t_distributor_info di ON ri.distributor_id = di.distributor_id LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id WHERE pr.status = 'morningpick' AND pr.pick_date >= '2025-01-02 16:00:00' AND pr.pick_date <= '2025-01-03 15:59:59.999' AND pr.is_delete = 0 AND pp.is_delete = 0 AND isnull(pp.relate_pick_id) = 1 GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone) mn ON rg.stall_id = mn.stall_id AND rg.pick_date = mn.pick_date AND rg.retailer_id = mn.retailer_id LEFT JOIN t_market_place mp ON rg.market_id = mp.market_id UNION (SELECT CONCAT(IFNULL(rg2.recognize_ids, ''), '|', mn2.recognize_ids) AS recognize_ids, CONCAT(IFNULL(rg2.trade_ids, ''), '|', mn2.trade_ids) AS trade_ids, mn2.stall_id, mn2.stall_code, mn2.stall_name, mn2.pick_date, CONCAT(IFNULL(rg2.status, ''), '|', mn2.status) AS status, CONCAT(IFNULL(rg2.pick_ids, ''), '|', mn2.pick_ids) AS pick_ids, mn2.retailer_id, mn2.tattoo_code, mn2.plan_count, mn2.lay_count, mn2.hang_count, mn2.morning_count, mn2.head_count, mn2.whole_count, mn2.service_fee, mn2.pick_time, mn2.claim_slaughter_time, mn2.owner_ids, mn2.owner_code, mn2.owner_name, mn2.owner_phone, mn2.company_name, mn2.retailer_name, mn2.retailer_location, mn2.location, mn2.contact_phone, mn2.market_id, mn2.pig_fee, mn2.service_fee + mn2.pig_fee AS total_fee, mn2.order_no, mn2.pay_way, mn2.integral, mn2.distributor_id, mn2.distributor_name, mn2.distributor_phone, mp.market_code, mp.market_name, mn2.default_plan_time FROM (SELECT GROUP_CONCAT(DISTINCT pr.recognize_id SEPARATOR ',') AS recognize_ids, GROUP_CONCAT(DISTINCT pr.trade_id SEPARATOR ',') AS trade_ids, pr.stall_id, GROUP_CONCAT(DISTINCT pr.stall_code SEPARATOR ',') AS stall_code, GROUP_CONCAT(DISTINCT pr.stall_name SEPARATOR ',') AS stall_name, pr.pick_date, GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status, GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, GROUP_CONCAT(DISTINCT pp.tattoo_code SEPARATOR ',') AS tattoo_code, IFNULL(SUM(pp.plan_count), 0) AS plan_count, IFNULL(SUM(pp.lay_count), 0) AS lay_count, IFNULL(SUM(pp.hang_count), 0) AS hang_count, IFNULL(SUM(pp.morning_count), 0) AS morning_count, IFNULL(SUM(pp.head_count), 0) AS head_count, IFNULL(SUM(pp.whole_count), 0) AS whole_count, IFNULL(SUM(pp.service_fee), 0) AS service_fee, MAX(pp.create_time) AS pick_time, MAX(pp.claim_slaughter_time) AS claim_slaughter_time, GROUP_CONCAT(DISTINCT st.owner_id SEPARATOR ',') AS owner_ids, GROUP_CONCAT(DISTINCT st.owner_code SEPARATOR ',') AS owner_code, GROUP_CONCAT(DISTINCT st.owner_name SEPARATOR ',') AS owner_name, GROUP_CONCAT(DISTINCT st.owner_phone SEPARATOR ',') AS owner_phone, GROUP_CONCAT(DISTINCT st.company_name SEPARATOR ',') AS company_name, GROUP_CONCAT(DISTINCT ri.retailer_name SEPARATOR ',') AS retailer_name, MAX(ri.retailer_location) AS retailer_location, MAX(ri.location) AS location, GROUP_CONCAT(DISTINCT ri.contact_phone SEPARATOR ',') AS contact_phone, ri.market_id, IFNULL(SUM(pp.pig_fee), 0) AS pig_fee, rit.integral, di.distributor_id, di.distributor_name, di.distributor_phone, MAX(ri.default_plan_time) AS default_plan_time FROM t_pick_recognize pr JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id LEFT JOIN t_slaughter_trade st ON pr.trade_id = st.trade_id LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id LEFT JOIN t_retailer_integral rit ON pp.retailer_id = rit.retailer_id LEFT JOIN t_distributor_info di ON ri.distributor_id = di.distributor_id LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id WHERE pr.status = 'submitted' AND pr.pick_date >= '2025-01-02 16:00:00' AND pr.pick_date <= '2025-01-03 15:59:59.999' AND pr.is_delete = 0 AND pp.is_delete = 0 AND isnull(pp.relate_pick_id) = 1 GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone) rg2 RIGHT JOIN (SELECT GROUP_CONCAT(DISTINCT pr.recognize_id SEPARATOR ',') AS recognize_ids, GROUP_CONCAT(DISTINCT pr.trade_id SEPARATOR ',') AS trade_ids, pr.stall_id, GROUP_CONCAT(DISTINCT pr.stall_code SEPARATOR ',') AS stall_code, GROUP_CONCAT(DISTINCT pr.stall_name SEPARATOR ',') AS stal","ts":"2025-01-03T13:57:24"},"fingerprint":"select count(?) from (select concat(rg.recognize_ids, ?, ifnull(mn.recognize_ids, ?)) as recognize_ids, concat(rg.trade_ids, ?, ifnull(mn.trade_ids, ?)) as trade_ids, rg.stall_id, rg.stall_code, rg.stall_name, rg.pick_date, concat(rg.status, ?, ifnull(mn.status, ?)) as status, concat(rg.pick_ids, ?, ifnull(mn.pick_ids, ?)) as pick_ids, rg.retailer_id, rg.tattoo_code, if(mn.stall_id is ? or rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) ? if(mn.stall_id is ? or rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) as plan_count, if(mn.stall_id is ? or rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) as lay_count, if(mn.stall_id is ? or rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) as hang_count, if(mn.stall_id is ?, rg.morning_count, mn.morning_count) as morning_count, rg.head_count, rg.whole_count, rg.service_fee, rg.pick_time, rg.claim_slaughter_time, rg.owner_ids, rg.owner_code, rg.owner_name, rg.owner_phone, rg.company_name, rg.retailer_name, rg.retailer_location, rg.location, rg.contact_phone, rg.market_id, rg.pig_fee, rg.service_fee ? rg.pig_fee as total_fee, rg.order_no, rg.pay_way, rg.integral, rg.distributor_id, rg.distributor_name, rg.distributor_phone, mp.market_code, mp.market_name, rg.default_plan_time from (select group_concat(distinct pr.recognize_id separator ?) as recognize_ids, group_concat(distinct pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(distinct pr.stall_code separator ?) as stall_code, group_concat(distinct pr.stall_name separator ?) as stall_name, pr.pick_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, group_concat(distinct pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.plan_count), ?) as plan_count, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(sum(pp.morning_count), ?) as morning_count, ifnull(sum(pp.head_count), ?) as head_count, ifnull(sum(pp.whole_count), ?) as whole_count, ifnull(sum(pp.service_fee), ?) as service_fee, max(pp.create_time) as pick_time, max(pp.claim_slaughter_time) as claim_slaughter_time, group_concat(distinct st.owner_id separator ?) as owner_ids, group_concat(distinct st.owner_code separator ?) as owner_code, group_concat(distinct st.owner_name separator ?) as owner_name, group_concat(distinct st.owner_phone separator ?) as owner_phone, group_concat(distinct st.company_name separator ?) as company_name, group_concat(distinct ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, max(ri.location) as location, group_concat(distinct ri.contact_phone separator ?) as contact_phone, ri.market_id, ifnull(sum(pp.pig_fee), ?) as pig_fee, rit.integral, di.distributor_id, di.distributor_name, di.distributor_phone, max(ri.default_plan_time) as default_plan_time from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id left join t_slaughter_trade st on pr.trade_id = st.trade_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_retailer_integral rit on pp.retailer_id = rit.retailer_id left join t_distributor_info di on ri.distributor_id = di.distributor_id left join t_market_place mp on ri.market_id = mp.market_id where pr.status = ? and pr.pick_date >= ? and pr.pick_date <= ? and pr.is_delete = ? and pp.is_delete = ? and isnull(pp.relate_pick_id) = ? group by pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone) rg left join (select group_concat(distinct pr.recognize_id separator ?) as recognize_ids, group_concat(distinct pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(distinct pr.stall_code separator ?) as stall_code, group_concat(distinct pr.stall_name separator ?) as stall_name, pr.pick_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, group_concat(distinct pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.plan_count), ?) as plan_count, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(sum(pp.morning_count), ?) as morning_count, ifnull(sum(pp.head_count), ?) as head_count, ifnull(sum(pp.whole_count), ?) as whole_count, ifnull(sum(pp.service_fee), ?) as service_fee, max(pp.create_time) as pick_time, max(pp.claim_slaughter_time) as claim_slaughter_time, group_concat(distinct st.owner_id separator ?) as owner_ids, group_concat(distinct st.owner_code separator ?) as owner_code, group_concat(distinct st.owner_name separator ?) as owner_name, group_concat(distinct st.owner_phone separator ?) as owner_phone, group_concat(distinct st.company_name separator ?) as company_name, group_concat(distinct ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location","histograms":{"Query_time":[0,0,0,0,0,0,13,1]},"metrics":{"Lock_time":{"avg":"0.000048","max":"0.000080","median":"0.000045","min":"0.000020","pct":"0.013208","pct_95":"0.000073","stddev":"0.000016","sum":"0.000667"},"Query_length":{"avg":"18360","max":"18360","median":"18360","min":"18360","pct":"0","pct_95":"18360","stddev":"0","sum":"257040"},"Query_time":{"avg":"5.884048","max":"11.931942","median":"5.472643","min":"3.865121","pct":"0.013208","pct_95":"6.984633","stddev":"1.716592","sum":"82.376667"},"Rows_examined":{"avg":"672","max":"1449","median":"685","min":"0","pct":"0","pct_95":"719","stddev":"321","sum":"9415"},"Rows_sent":{"avg":"1","max":"1","median":"1","min":"1","pct":"0","pct_95":"1","stddev":"0","sum":"14"},"db":{"value":"pz_wsnh_prod"},"host":{"value":"192.168.5.243"},"user":{"value":"pz_wsnh"}},"query_count":14,"tables":[{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pick_recognize`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pick_recognize'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pig_pick`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pig_pick'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_slaughter_trade`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_slaughter_trade'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_integral`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_integral'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_distributor_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_distributor_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_market_place`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_market_place'\\G"}],"ts_max":"2025-01-03T13:57:54","ts_min":"2025-01-02T17:08:40"},{"attribute":"fingerprint","checksum":"FFFCA4D67EA0A788813031B8BBC3B329","distillate":"COMMIT","example":{"Query_time":"8.837809","query":"commit","ts":"2025-01-03T01:30:31"},"fingerprint":"commit","histograms":{"Query_time":[0,0,0,0,0,0,25,0]},"metrics":{"Lock_time":{"avg":"0.000000","max":"0.000000","median":"0.000000","min":"0.000000","pct":"0.023585","pct_95":"0.000000","stddev":"0.000000","sum":"0.000000"},"Query_length":{"avg":"6","max":"6","median":"6","min":"6","pct":"0","pct_95":"6","stddev":"0","sum":"150"},"Query_time":{"avg":"3.237409","max":"8.837809","median":"2.764057","min":"2.003865","pct":"0.023585","pct_95":"4.727475","stddev":"1.485701","sum":"80.935218"},"Rows_examined":{"avg":"0","max":"0","median":"0","min":"0","pct":"0","pct_95":"0","stddev":"0","sum":"0"},"Rows_sent":{"avg":"0","max":"0","median":"0","min":"0","pct":"0","pct_95":"0","stddev":"0","sum":"0"},"db":{"value":"wsnh_prod"},"host":{"value":"192.168.5.243"},"user":{"value":"wsnh"}},"query_count":25,"ts_max":"2025-01-03T15:07:17","ts_min":"2025-01-03T00:03:51"},{"attribute":"fingerprint","checksum":"A1322B5AF54917A1C36290481B6C1A96","distillate":"SELECT UNION t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place t_pick_recognize t_pig_pick t_slaughter_trade t_retailer_info t_retailer_integral t_distributor_info t_market_place","example":{"Query_time":"5.806829","query":"SELECT temp.*\n        FROM ( \n         \n\n        SELECT CONCAT(rg.recognize_ids, '|', IFNULL(mn.recognize_ids, '')) AS recognize_ids,\n            CONCAT(rg.trade_ids, '|', IFNULL(mn.trade_ids, '')) AS trade_ids,\n            rg.stall_id,\n            rg.stall_code,\n            rg.stall_name,\n            rg.pick_date,\n            CONCAT(rg.status, '|', IFNULL(mn.status, '')) AS status,\n            CONCAT(rg.pick_ids, '|', IFNULL(mn.pick_ids, '')) AS pick_ids,\n            rg.retailer_id,\n            rg.tattoo_code,\n            IF(mn.stall_id IS NULL OR rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count)\n                + IF(mn.stall_id IS NULL OR rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count)\n            AS plan_count,\n            IF(mn.stall_id IS NULL OR rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) AS lay_count,\n            IF(mn.stall_id IS NULL OR rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) AS hang_count,\n            IF(mn.stall_id IS NULL, rg.morning_count, mn.morning_count) AS morning_count,\n            rg.head_count,\n            rg.whole_count,\n            rg.service_fee,\n            rg.pick_time,\n            rg.claim_slaughter_time,\n            rg.owner_ids,\n            rg.owner_code,\n            rg.owner_name,\n            rg.owner_phone,\n            rg.company_name,\n            rg.retailer_name,\n            rg.retailer_location,\n            rg.location,\n            rg.contact_phone,\n            rg.market_id,\n            rg.pig_fee,\n            rg.service_fee + rg.pig_fee AS total_fee,\n            rg.order_no,\n            rg.pay_way,\n            rg.integral,\n            rg.distributor_id,\n            rg.distributor_name,\n            rg.distributor_phone,\n            mp.market_code,\n            mp.market_name,\n            rg.default_plan_time\n        FROM ( \n        SELECT GROUP_CONCAT(DISTINCT pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(DISTINCT pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(DISTINCT pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(DISTINCT pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            pp.order_no,\n            pp.pay_way,\n            GROUP_CONCAT(DISTINCT pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.plan_count), 0) AS plan_count,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL(SUM(pp.morning_count), 0) AS morning_count,\n            IFNULL(SUM(pp.head_count), 0) AS head_count,\n            IFNULL(SUM(pp.whole_count), 0) AS whole_count,\n            IFNULL(SUM(pp.service_fee), 0) AS service_fee,\n            MAX(pp.create_time) AS pick_time,\n            MAX(pp.claim_slaughter_time) AS claim_slaughter_time,\n            GROUP_CONCAT(DISTINCT st.owner_id SEPARATOR ',') AS owner_ids,\n            GROUP_CONCAT(DISTINCT st.owner_code SEPARATOR ',') AS owner_code,\n            GROUP_CONCAT(DISTINCT st.owner_name SEPARATOR ',') AS owner_name,\n            GROUP_CONCAT(DISTINCT st.owner_phone SEPARATOR ',') AS owner_phone,\n            GROUP_CONCAT(DISTINCT st.company_name SEPARATOR ',') AS company_name,\n            GROUP_CONCAT(DISTINCT ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            MAX(ri.location) AS location,\n            GROUP_CONCAT(DISTINCT ri.contact_phone SEPARATOR ',') AS contact_phone,\n            ri.market_id,\n            IFNULL(SUM(pp.pig_fee), 0) AS pig_fee,\n            rit.integral,\n            di.distributor_id,\n            di.distributor_name,\n            di.distributor_phone,\n            MAX(ri.default_plan_time) AS default_plan_time\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_slaughter_trade st ON pr.trade_id = st.trade_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_retailer_integral rit ON pp.retailer_id = rit.retailer_id\n            LEFT JOIN t_distributor_info di ON ri.distributor_id = di.distributor_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n         WHERE pr.status = 'submitted'\n            \n        \n            and pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            and pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.is_delete = 0\n        AND pp.is_delete = 0\n    \n            AND isnull(pp.relate_pick_id) = 1 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone\n     ) rg\n            LEFT JOIN ( \n        SELECT GROUP_CONCAT(DISTINCT pr.recognize_id SEPARATOR ',') AS recognize_ids,\n            GROUP_CONCAT(DISTINCT pr.trade_id SEPARATOR ',') AS trade_ids,\n            pr.stall_id,\n            GROUP_CONCAT(DISTINCT pr.stall_code SEPARATOR ',') AS stall_code,\n            GROUP_CONCAT(DISTINCT pr.stall_name SEPARATOR ',') AS stall_name,\n            pr.pick_date,\n            GROUP_CONCAT(DISTINCT pr.status SEPARATOR ',') AS status,\n            GROUP_CONCAT(pp.pick_id SEPARATOR ',') AS pick_ids,\n            pp.retailer_id,\n            pp.order_no,\n            pp.pay_way,\n            GROUP_CONCAT(DISTINCT pp.tattoo_code SEPARATOR ',') AS tattoo_code,\n            IFNULL(SUM(pp.plan_count), 0) AS plan_count,\n            IFNULL(SUM(pp.lay_count), 0) AS lay_count,\n            IFNULL(SUM(pp.hang_count), 0) AS hang_count,\n            IFNULL(SUM(pp.morning_count), 0) AS morning_count,\n            IFNULL(SUM(pp.head_count), 0) AS head_count,\n            IFNULL(SUM(pp.whole_count), 0) AS whole_count,\n            IFNULL(SUM(pp.service_fee), 0) AS service_fee,\n            MAX(pp.create_time) AS pick_time,\n            MAX(pp.claim_slaughter_time) AS claim_slaughter_time,\n            GROUP_CONCAT(DISTINCT st.owner_id SEPARATOR ',') AS owner_ids,\n            GROUP_CONCAT(DISTINCT st.owner_code SEPARATOR ',') AS owner_code,\n            GROUP_CONCAT(DISTINCT st.owner_name SEPARATOR ',') AS owner_name,\n            GROUP_CONCAT(DISTINCT st.owner_phone SEPARATOR ',') AS owner_phone,\n            GROUP_CONCAT(DISTINCT st.company_name SEPARATOR ',') AS company_name,\n            GROUP_CONCAT(DISTINCT ri.retailer_name SEPARATOR ',') AS retailer_name,\n            MAX(ri.retailer_location) AS retailer_location,\n            MAX(ri.location) AS location,\n            GROUP_CONCAT(DISTINCT ri.contact_phone SEPARATOR ',') AS contact_phone,\n            ri.market_id,\n            IFNULL(SUM(pp.pig_fee), 0) AS pig_fee,\n            rit.integral,\n            di.distributor_id,\n            di.distributor_name,\n            di.distributor_phone,\n            MAX(ri.default_plan_time) AS default_plan_time\n        FROM t_pick_recognize pr\n            JOIN t_pig_pick pp ON pr.recognize_id = pp.recognize_id\n            LEFT JOIN t_slaughter_trade st ON pr.trade_id = st.trade_id\n            LEFT JOIN t_retailer_info ri ON pp.retailer_id = ri.retailer_id\n            LEFT JOIN t_retailer_integral rit ON pp.retailer_id = rit.retailer_id\n            LEFT JOIN t_distributor_info di ON ri.distributor_id = di.distributor_id\n            LEFT JOIN t_market_place mp ON ri.market_id = mp.market_id\n         WHERE pr.status = 'morningpick'\n            \n        \n            and pr.pick_date >= '2025-01-02 16:00:00'\n        \n        \n            and pr.pick_date <= '2025-01-03 15:59:59.999'\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        AND pr.is_delete = 0\n        AND pp.is_delete = 0\n    \n            AND isnull(pp.relate_pick_id) = 1 \n        GROUP BY pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone\n     ) mn\n                ON rg.stall_id = mn.stall_id AND rg.pick_date = mn.pick_date AND rg.retailer_id = mn.retailer_id\n            LEFT JOIN t_market_place mp ON rg.market_id = mp.market_id\n        UNION (\n            SELECT CONCAT(IFNULL(rg2.recognize_ids, ''), '|', mn2.recognize_ids) AS recognize_ids,\n                CONCAT(IFNULL(rg2.trade_ids, ''), '|', mn2.trade_ids) AS trade_ids,\n                mn2.stall_id,\n                mn2.stall_code,\n                mn2.stall_name,\n                mn2.pick_date,\n                CONCAT(IFNULL(rg2.status, ''), '|', mn2.status) AS status,\n                CONCAT(IFNULL(rg2.pick_ids, ''), '|', mn2.pick_ids) AS pick_ids,\n                mn2.retailer_id,\n                mn2.tattoo_code,\n                mn2.plan_count,\n                mn2.lay_count,\n                mn2.hang_count,\n                mn2.morning_count,\n                mn2.head_count,\n                mn2.whole_count,\n                mn2.service_fee,\n                mn2.pick_time,\n                mn2.claim_slaughter_time,\n                mn2.owner_ids,\n                mn2.owner_code,\n                mn2.owner_name,\n                mn2.owner_phone,\n                mn2.company_name,\n                mn2.retailer_name,\n                mn2.retailer_location,\n                mn2.location,\n                mn2.contact_phone,\n                mn2.market_id,\n                mn2.pig_fee,\n                mn2.service_fee + mn2.pig_fee AS total_fee,\n                mn2.order_no,\n                mn2.pay_way,\n                mn2.integral,\n                mn2.distributor_id,\n                mn2.distributor_name,\n                mn2.distributor_phone,\n                mp.market_code,\n         ","ts":"2025-01-03T06:58:53"},"fingerprint":"select temp.* from ( select concat(rg.recognize_ids, ?, ifnull(mn.recognize_ids, ?)) as recognize_ids, concat(rg.trade_ids, ?, ifnull(mn.trade_ids, ?)) as trade_ids, rg.stall_id, rg.stall_code, rg.stall_name, rg.pick_date, concat(rg.status, ?, ifnull(mn.status, ?)) as status, concat(rg.pick_ids, ?, ifnull(mn.pick_ids, ?)) as pick_ids, rg.retailer_id, rg.tattoo_code, if(mn.stall_id is ? or rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) ? if(mn.stall_id is ? or rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) as plan_count, if(mn.stall_id is ? or rg.lay_count >= mn.lay_count, rg.lay_count, mn.lay_count) as lay_count, if(mn.stall_id is ? or rg.hang_count >= mn.hang_count, rg.hang_count, mn.hang_count) as hang_count, if(mn.stall_id is ?, rg.morning_count, mn.morning_count) as morning_count, rg.head_count, rg.whole_count, rg.service_fee, rg.pick_time, rg.claim_slaughter_time, rg.owner_ids, rg.owner_code, rg.owner_name, rg.owner_phone, rg.company_name, rg.retailer_name, rg.retailer_location, rg.location, rg.contact_phone, rg.market_id, rg.pig_fee, rg.service_fee ? rg.pig_fee as total_fee, rg.order_no, rg.pay_way, rg.integral, rg.distributor_id, rg.distributor_name, rg.distributor_phone, mp.market_code, mp.market_name, rg.default_plan_time from ( select group_concat(distinct pr.recognize_id separator ?) as recognize_ids, group_concat(distinct pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(distinct pr.stall_code separator ?) as stall_code, group_concat(distinct pr.stall_name separator ?) as stall_name, pr.pick_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, group_concat(distinct pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.plan_count), ?) as plan_count, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(sum(pp.morning_count), ?) as morning_count, ifnull(sum(pp.head_count), ?) as head_count, ifnull(sum(pp.whole_count), ?) as whole_count, ifnull(sum(pp.service_fee), ?) as service_fee, max(pp.create_time) as pick_time, max(pp.claim_slaughter_time) as claim_slaughter_time, group_concat(distinct st.owner_id separator ?) as owner_ids, group_concat(distinct st.owner_code separator ?) as owner_code, group_concat(distinct st.owner_name separator ?) as owner_name, group_concat(distinct st.owner_phone separator ?) as owner_phone, group_concat(distinct st.company_name separator ?) as company_name, group_concat(distinct ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_location, max(ri.location) as location, group_concat(distinct ri.contact_phone separator ?) as contact_phone, ri.market_id, ifnull(sum(pp.pig_fee), ?) as pig_fee, rit.integral, di.distributor_id, di.distributor_name, di.distributor_phone, max(ri.default_plan_time) as default_plan_time from t_pick_recognize pr join t_pig_pick pp on pr.recognize_id = pp.recognize_id left join t_slaughter_trade st on pr.trade_id = st.trade_id left join t_retailer_info ri on pp.retailer_id = ri.retailer_id left join t_retailer_integral rit on pp.retailer_id = rit.retailer_id left join t_distributor_info di on ri.distributor_id = di.distributor_id left join t_market_place mp on ri.market_id = mp.market_id where pr.status = ? and pr.pick_date >= ? and pr.pick_date <= ? and pr.is_delete = ? and pp.is_delete = ? and isnull(pp.relate_pick_id) = ? group by pr.pick_date, pr.stall_id, pp.retailer_id, pp.order_no, pp.pay_way, rit.integral, ri.market_id, di.distributor_id, di.distributor_name, di.distributor_phone ) rg left join ( select group_concat(distinct pr.recognize_id separator ?) as recognize_ids, group_concat(distinct pr.trade_id separator ?) as trade_ids, pr.stall_id, group_concat(distinct pr.stall_code separator ?) as stall_code, group_concat(distinct pr.stall_name separator ?) as stall_name, pr.pick_date, group_concat(distinct pr.status separator ?) as status, group_concat(pp.pick_id separator ?) as pick_ids, pp.retailer_id, pp.order_no, pp.pay_way, group_concat(distinct pp.tattoo_code separator ?) as tattoo_code, ifnull(sum(pp.plan_count), ?) as plan_count, ifnull(sum(pp.lay_count), ?) as lay_count, ifnull(sum(pp.hang_count), ?) as hang_count, ifnull(sum(pp.morning_count), ?) as morning_count, ifnull(sum(pp.head_count), ?) as head_count, ifnull(sum(pp.whole_count), ?) as whole_count, ifnull(sum(pp.service_fee), ?) as service_fee, max(pp.create_time) as pick_time, max(pp.claim_slaughter_time) as claim_slaughter_time, group_concat(distinct st.owner_id separator ?) as owner_ids, group_concat(distinct st.owner_code separator ?) as owner_code, group_concat(distinct st.owner_name separator ?) as owner_name, group_concat(distinct st.owner_phone separator ?) as owner_phone, group_concat(distinct st.company_name separator ?) as company_name, group_concat(distinct ri.retailer_name separator ?) as retailer_name, max(ri.retailer_location) as retailer_locati","histograms":{"Query_time":[0,0,0,0,0,0,13,0]},"metrics":{"Lock_time":{"avg":"0.000027","max":"0.000042","median":"0.000025","min":"0.000018","pct":"0.012264","pct_95":"0.000035","stddev":"0.000007","sum":"0.000348"},"Query_length":{"avg":"24932","max":"24932","median":"24932","min":"24932","pct":"0","pct_95":"24932","stddev":"0","sum":"324116"},"Query_time":{"avg":"5.367763","max":"5.806829","median":"5.212041","min":"4.244358","pct":"0.012264","pct_95":"5.472643","stddev":"0.373609","sum":"69.780915"},"Rows_examined":{"avg":"772","max":"1499","median":"755","min":"54","pct":"0","pct_95":"755","stddev":"283","sum":"10042"},"Rows_sent":{"avg":"48","max":"50","median":"49","min":"27","pct":"0","pct_95":"49","stddev":"6","sum":"627"},"db":{"value":"pz_wsnh_prod"},"host":{"value":"192.168.5.243"},"user":{"value":"pz_wsnh"}},"query_count":13,"tables":[{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pick_recognize`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pick_recognize'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_pig_pick`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_pig_pick'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_slaughter_trade`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_slaughter_trade'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_retailer_integral`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_retailer_integral'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_distributor_info`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_distributor_info'\\G"},{"create":"SHOW CREATE TABLE `pz_wsnh_prod`.`t_market_place`\\G","status":"SHOW TABLE STATUS FROM `pz_wsnh_prod` LIKE 't_market_place'\\G"}],"ts_max":"2025-01-03T13:57:59","ts_min":"2025-01-02T17:08:49"}],"global":{"files":[{"name":"2025010302-slow.txt","size":14954082}],"metrics":{"Lock_time":{"avg":"0.000022","max":"0.000265","median":"0.000020","min":"0.000000","pct_95":"0.000045","stddev":"0.000019","sum":"0.023759"},"Query_length":{"avg":"13905","max":"46435","median":"12192","min":"6","pct_95":"33968","stddev":"8997","sum":"14740235"},"Query_time":{"avg":"10.368801","max":"357.098356","median":"4.502357","min":"2.003865","pct_95":"16.008907","stddev":"28.659033","sum":"10990.928922"},"Rows_examined":{"avg":"56856","max":"4619136","median":"80","min":"0","pct_95":"85837","stddev":"333825","sum":"60267990"},"Rows_sent":{"avg":"17582","max":"4619136","median":"0","min":"0","pct_95":"97","stddev":"192464","sum":"18637947"}},"query_count":1060,"unique_query_count":97}}
